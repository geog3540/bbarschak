"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8111],{37809:function(e,t,n){n.d(t,{b:function(){return u}});var s=n(41799),i=n(69396),l=n(99534),a=n(85893),r=n(94184),o=n.n(r),c=(n(67294),n(49516)),d=n(87671);const u=e=>{var{type:t="error",spacing:n="pv3 ph3",className:r="",title:u="",description:m="",children:h}=e,b=(0,l.Z)(e,["type","spacing","className","title","description","children"]);return(0,a.jsxs)("div",(0,i.Z)((0,s.Z)({className:o()(n,r,"br2"),style:{background:"".concat("warning"!==t?"success"===t?" #eef5f2":" #fdf1f1":" #fdf9ed")}},b),{children:["error"===t&&(0,a.jsxs)("div",{className:"flex f6 fw6 dark-red br2 items-center lh-title",children:[(0,a.jsx)(d.Z,{className:"w1 h1 mr2 white bg-red b--dark-red flex-no-shrink br-pill"}),u]}),"warning"===t&&(0,a.jsxs)("div",{className:"flex f6 fw6 gold items-center lh-title",children:[(0,a.jsx)(d.Z,{className:"w1 h1 mr2 white bg-yellow b--gold flex-no-shrink br-pill"}),u]}),"success"===t&&(0,a.jsxs)("div",{className:"flex f6 fw6 dark-green items-center lh-title",children:[(0,a.jsx)(c.Z,{className:"flex w1 h1 mr2 white bg-green b--dark-green flex-no-shrink br-pill"}),u]}),m&&(0,a.jsx)("div",{className:"pl2 mt1 ml3 f7 fw5 dark-gray lh-f7",children:m}),h]}))}},58171:function(e,t,n){n.d(t,{P:function(){return h},g:function(){return m}});var s=n(41799),i=n(69396),l=n(99534),a=n(85893),r=n(60357),o=n.n(r),c=n(94184),d=n.n(c);n(67294);const u=new String("select.jsx-8a6f66adb6c4dd0d{outline:0px;padding-right:24px;background-position:right 8px center;background-repeat:no-repeat}select.jsx-8a6f66adb6c4dd0d::-ms-expand{display:none}");u.__hash="8a6f66adb6c4dd0d";const m=e=>{var{className:t="",children:n,disabled:r}=e,c=(0,l.Z)(e,["className","children","disabled"]);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("select",(0,i.Z)((0,s.Z)({disabled:r},c),{className:"jsx-d0719c1526f662d3 "+"jsx-".concat(u.__hash)+" "+(d()("br2 form-default-clear bn animate-all fw6 ph2 pv1 f7 lh-f7",r?"bg-near-white mid-gray":"dark-gray pointer",t)||""),children:n})),(0,a.jsx)(o(),{id:u.__hash,children:u}),(0,a.jsx)(o(),{id:"d0719c1526f662d3",children:"select.jsx-d0719c1526f662d3{-webkit-box-shadow:var(--silver)0px 0px 0px 1px,inset -1px -1px var(--silver);-moz-box-shadow:var(--silver)0px 0px 0px 1px,inset -1px -1px var(--silver);box-shadow:var(--silver)0px 0px 0px 1px,inset -1px -1px var(--silver);background-image:url(\"data:image/svg+xml,%3Csvg width='8' height='16' viewBox='0 0 8 16' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M1 7L4 9.5L7 7' stroke='rgb(196, 196, 196)' fill='none' stroke-width='1.8' stroke-linecap='square'/%3E%3C/svg%3E%0A\")}"})]})},h=e=>{var{children:t,disabled:n=!1,bordered:r=!0,className:c=""}=e,m=(0,l.Z)(e,["children","disabled","bordered","className"]);const h=n?"moon-gray":"blue",b=n?"":"pointer animate-all hover-bg-black-05",g=r?n?"b--silver":"b--light-gray":"b--transparent";return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("select",(0,i.Z)((0,s.Z)({disabled:n},m),{className:"jsx-baf07ef590aebba2 "+"jsx-".concat(u.__hash)+" "+(d()(h,g,b,c,"f6 fw6 br2 ba pa2 bg-transparent form-default-clear")||""),children:t})),(0,a.jsx)(o(),{id:u.__hash,children:u}),(0,a.jsx)(o(),{id:"baf07ef590aebba2",children:"select.jsx-baf07ef590aebba2{background-image:url(\"data:image/svg+xml, %3Csvg xmlns='http://www.w3.org/2000/svg' width='8' height='8' viewBox='0 0 8 8' fill='none'%3E%3Cpath d='M5.91938 2H2.08062C1.24212 2 0.775946 2.96993 1.29976 3.6247L3.21913 6.02391C3.61946 6.52432 4.38054 6.52432 4.78087 6.02391L6.70024 3.62469C7.22405 2.96993 6.75788 2 5.91938 2Z' fill='%233b5fc0' /%3E%3C/svg%3E\")}select[disabled].jsx-baf07ef590aebba2{background-image:url(\"data:image/svg+xml, %3Csvg xmlns='http://www.w3.org/2000/svg' width='8' height='8' viewBox='0 0 8 8' fill='none'%3E%3Cpath d='M5.91938 2H2.08062C1.24212 2 0.775946 2.96993 1.29976 3.6247L3.21913 6.02391C3.61946 6.52432 4.38054 6.52432 4.78087 6.02391L6.70024 3.62469C7.22405 2.96993 6.75788 2 5.91938 2Z' fill='%23c4c4c4' /%3E%3C/svg%3E\")}"})]})}},71043:function(e,t,n){n.d(t,{Z:function(){return d}});var s=n(41799),i=n(99534),l=n(85893),a=n(94184),r=n.n(a),o=(n(67294),n(69396));var c=e=>(0,l.jsx)("svg",(0,o.Z)((0,s.Z)({width:"8",height:"16",viewBox:"0 0 8 16",fill:"none"},e),{children:(0,l.jsx)("path",{d:"M2.98713 12.6H5.00005V6H2.98713V12.6ZM4 5.16211C4.60352 5.16211 5.10156 4.6875 5.10156 4.08398C5.10156 3.48047 4.60352 3 4 3C3.39648 3 2.89844 3.48047 2.89844 4.08398C2.89844 4.6875 3.39648 5.16211 4 5.16211Z",fill:"currentColor"})}));var d=e=>{var{className:t}=e,n=(0,i.Z)(e,["className"]);return(0,l.jsx)(c,(0,s.Z)({className:r()("br-pill light-blue bg-observable-faint-blue",t),width:"18",height:"18"},n))}},76305:function(e,t,n){var s=n(41799),i=n(69396),l=n(85893);n(67294);t.Z=e=>(0,l.jsxs)("svg",(0,i.Z)((0,s.Z)({width:"17",height:"16",viewBox:"0 0 17 16",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinejoin:"round"},e),{children:[(0,l.jsx)("path",{d:"M3 10C2.46373 10 1 9.57867 1 8C1 6.42133 2 5.5 3.5 5.5C3.5 3 5.5 1 8 1C11 1 12.5 3.5 12.5 4C15.5 4 16.2061 10 13 10"}),(0,l.jsx)("path",{d:"M11 10L8 7L5 10"}),(0,l.jsx)("path",{d:"M7.99805 14.3882L7.99805 7.38818"})]}))},28925:function(e,t,n){n.d(t,{E:function(){return k}});var s=n(41799),i=n(69396),l=n(99534),a=n(85893),r=n(94184),o=n.n(r),c=n(67294),d=n(27011),u=n.n(d),m=n(37497),h=n(33090),b=n(776),g=n(76305),p=n(58127),f=n(2741),x=n(88725);const v=["image/gif","image/jpeg","image/jpg","image/png"];function j(e){return e.dataTransfer.items.length?!!w(e.dataTransfer.items):e.dataTransfer.types.includes("Files")}function w(e){for(const t of e)if(t.type&&t.type.startsWith("image/"))return t}const y=156.25,k=e=>{var{disabled:t,thumbnail:n,defaultThumbnail:r,onValueChange:d,className:k}=e,C=(0,l.Z)(e,["disabled","thumbnail","defaultThumbnail","onValueChange","className"]);const{isDraggingOver:N,dragAndDropEvents:_}=(0,p.Y)((e=>{t||F(e.dataTransfer.files)}),j),{0:Z,1:S}=(0,c.useState)(!1),{0:L,1:R}=(0,c.useState)(),{0:U,1:D}=(0,c.useState)();(0,c.useEffect)((()=>{n&&r!==n&&(R(n),S(!0),D(""))}),[n,r]);const{0:E,1:M}=(0,c.useState)(null),T=(0,c.useRef)(null),{0:A,1:I}=(0,c.useState)(1),{0:V,1:q}=(0,c.useState)(),P=(0,c.useRef)(null),z=(0,c.useRef)(null);function F(e){try{let n=w(e);var t;if(n instanceof DataTransferItem)n=null!==(t=n.getAsFile())&&void 0!==t?t:void 0;if(n){const e=URL.createObjectURL(n);D(e),S(!0),I(1),M("")}else e.length&&M("Sorry, that image format is not supported.")}catch(n){console.error(n)}}(0,c.useEffect)((()=>{z.current&&z.current.focus()}),[]),(0,c.useEffect)((()=>{Z||M(""),T.current&&T.current.setCustomValidity(!Z||!E&&L?"":"Please upload an image"),d(Z&&L?L:"")}),[d,Z,L,E]);const B=(0,c.useRef)();function O(){if(M(""),P.current){B.current&&B.current();const e=setTimeout((()=>{if(B.current=void 0,P.current&&P.current.getCroppingRect()){const e=P.current.getImage(),t=document.createElement("canvas");t.width=640,t.height=400;const n=t.getContext("2d");n.fillStyle="#fff",n.fillRect(0,0,640,400),n.drawImage(e,0,0,e.width,e.height,0,0,640,400);const s=t.toDataURL("image/jpeg",.7);R(s)}}),150);B.current=()=>clearTimeout(e)}}return(0,a.jsxs)("div",{className:o()("flex items-top flex-wrap flex-nowrap-l",k),onClick:()=>{z.current&&z.current.focus()},children:[(0,a.jsxs)("div",{className:"mr2",children:[(0,a.jsx)(h.E,{disabled:t,name:"thumbnail",label:"Automatic",checked:!Z,onChange:e=>S("on"!==e.target.value)}),(0,a.jsx)(h.E,{className:"f6 fw6 near-black mb3",disabled:t,name:"thumbnail",label:"Custom",description:"Use a .png or .jpg that is at least 640x400 pixels",checked:Z,onChange:e=>S("on"===e.target.value)}),(0,a.jsx)("input",(0,s.Z)({disabled:t,hidden:!0,ref:T,onInvalid:e=>e.preventDefault(),onInput:()=>{},value:Z&&L?L:""},C)),(0,a.jsx)("input",{className:"ma0 pa0 bw0 absolute",disabled:t,type:"text",style:{opacity:0,width:0,height:0},ref:z,onPaste:e=>F(e.clipboardData.files)}),(0,a.jsxs)("div",{className:"flex items-top mb2",children:[(0,a.jsx)("div",{className:"db-l dn ml2 mr3"}),(0,a.jsx)(m.aX,{disabled:t,text:"Upload file",icon:g.Z,onClick:()=>(0,f.Z)({accept:v.join()}).then((e=>{F(e)}))})]})]}),(0,a.jsxs)("div",{children:[!(Z&&U)&&(0,a.jsx)("div",(0,i.Z)((0,s.Z)({},_),{className:o()("flex flex-column ba",E&&!N?"b--dark-pink":N?"b--dashed b-dark-gray":"b--moon-gray"),style:{width:250,height:y,backgroundImage:Z&&L?"url(".concat((0,x.Nl)(L),")"):!Z&&r?"url(".concat((0,x.Nl)(r),")"):"var(--checkerboard)",backgroundSize:Z&&L||!Z&&r?"cover":"8%"}})),Z&&U&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",(0,i.Z)((0,s.Z)({},_),{className:o()("flex flex-column ba",E?"b--dark-pink":N?"b--dashed b--dark-gray":"b--white"),children:(0,a.jsx)(u(),{image:U,ref:P,width:198,height:123.75,scale:A,position:V,borderRadius:0,onPositionChange:e=>q(e),onImageReady:O,onImageChange:O,onLoadFailure:function(){M("Unable to read that image."),D("")}})})),(0,a.jsxs)("div",{className:"flex items-center mid-gray mt2",children:[(0,a.jsx)("label",{className:"mr2 f6",htmlFor:"scale-range",children:"Zoom"}),(0,a.jsx)(b.i,{className:"flex-grow-1",name:"scale-range",onChange:e=>I(e.target.valueAsNumber),value:A,step:"any",min:1,max:2})]})]}),E?(0,a.jsx)("div",{className:"dark-pink f7 fw4 mb2 mt1",children:E}):null]})]})}},78111:function(e,t,n){n.d(t,{$:function(){return Qe}});var s=n(41799),i=n(69396),l=n(39612),a=n(85893),r=n(56424),o=n(77063),c=n(43529),d=n(44516),u=n(47495),m=n(93452),h=n(6016),b=n(29162),g=n(65678),p=n(42510),f=n(10718),x=n(33042),v=n(4242);const j=(0,v.$j)(((e,t)=>{let{notebook:n}=e,{id:s}=t;return{data:(0,x.DY)(n.model,s).data}}),(e=>({dispatch:e})))((e=>{let{dispatch:t,onDismiss:n,id:s,data:i,operation:l}=e;const x=(0,f.pN)(i,t),v={filter:o.Z,columns:c.Z,sort:u.Z,slice:d.Z},j=l.charAt(0).toUpperCase()+l.slice(1);return(0,a.jsxs)(r.Vq,{onDismiss:n,"aria-label":"".concat(j," menu"),children:[(0,a.jsx)(m.xB,{title:j,icon:v[l],onDismiss:n}),(0,a.jsx)("div",{className:"pa3 bt b--silver",children:"filter"===l?(0,a.jsx)(b.c,{id:s,data:i,dispatch:t,schema:x}):"columns"===l?(0,a.jsx)(h.J,{data:i,dispatch:t,id:s,schema:x}):"sort"===l?(0,a.jsx)(p.dE,{id:s,data:i,dispatch:t,schema:x}):(0,a.jsx)(g.ck,{data:i,dispatch:t,id:s})})]})}));var w=n(99534),y=n(67294),k=n(8385),C=n(37497),N=n(16691),_=n(11233),Z=n(58171),S=n(24576),L=n(22027),R=n(54329),U=n(602),D=n(19671),E=n(70915),M=n(66421),T=n(3142),A=n(81816),I=n(36448),V=n(18494),q=(n(14416),n(54924));const P=(0,q.S3)();(0,q.gR)();function z(e,t,n){const s={user:e,public:t.filter((e=>"public"===e.type&&e.id!==n)),private:t.filter((e=>"private"===e.type&&e.id!==n))},i=function(e){const t=new Set(e.map((e=>e.id)));return(e,n)=>+t.has(n.id)-+t.has(e.id)||e.title.localeCompare(n.title)}(t);return s.public.sort(i),s.private.sort(i),s}const F=e=>{let{collection:t,checked:n,onChange:s}=e;return(0,a.jsxs)("label",{htmlFor:"collection-".concat(t.id),className:"flex f6 fw5 dark-gray hover-blue flex-auto pointer",children:[(0,a.jsx)(N.X,{id:"collection-".concat(t.id),checked:n,onChange:e=>s(t,e.target.checked),spacing:""}),(0,a.jsx)("span",{title:t.title,className:"truncate pointer",children:t.title})]})};const B=e=>{let{group:t,type:n,selected:s,onChange:i,filters:l,restricted:r=!1}=e;const o="public"===n?t.public:t.private,c=o.filter((e=>function(e,t){return t.every((t=>e.toLowerCase().includes(t)))}(e.title,l)));return(0,a.jsxs)("div",{className:"mt1",children:[(0,a.jsxs)("div",{className:"f7 fw5 gray",children:[(0,a.jsx)("span",{className:"ttc",children:n})," collections (",l.length?"".concat(c.length," / "):"",o.length,")"]}),r?(0,a.jsx)("div",{className:"f7 gray lh-f7",children:"Only team owners can add public or shared notebooks to public collections."}):c.length>0&&(0,a.jsx)("div",{className:"pt1 pb3",style:{display:"grid",gridTemplateColumns:"1fr 1fr",gridGap:"10px"},children:c.map((e=>(0,a.jsx)(F,{collection:e,checked:s.some((t=>t.id===e.id)),onChange:i},e.id)))})]},n)},O=e=>{let{onCollectionCreated:t,owner:n,currentUser:s}=e;const i="private",{0:l,1:r}=(0,y.useState)(i),{0:o,1:c}=(0,y.useState)("");return(0,a.jsxs)("form",{onSubmit:async function(e){e.preventDefault();const a=await(0,E.BL)(o,l,n);a&&(t(n,l,a),(0,D.MR)((0,D.y6)({type:"collection:manage:create",data:{trigger:"click",source:"notebookCollectionsModal"},eventVersion:1,collection:a,currentUser:s})),c(""),r(i))},className:"flex items-center",autoComplete:"off",children:[(0,a.jsx)(_.Z,{name:"title",placeholder:"New collection",type:"text",className:"overflow-hidden flex-grow-1",value:o,onChange:e=>c(e.target.value)}),(0,a.jsxs)(Z.P,{name:"type",onChange:e=>r(e.target.value),value:l,disabled:!o,className:"mh2",children:[(0,a.jsx)("option",{value:"private",children:"team"===n.type?"Team Private":"Private"}),(0,M.XM)(s,n)&&(0,a.jsx)("option",{value:"public",children:"Public"})]}),(0,a.jsx)(C.aX,{text:"Create",type:"submit",disabled:!o})]})},Y=e=>{const{collectionListing:t,onDismiss:n,dispatch:s}=e,i=e.currentUser,{owner:l}=t,o=G(t)?t.collections:t.parent_collections,{0:c,1:d}=(0,y.useState)(o),{0:u,1:h}=(0,y.useState)(null),{0:b,1:g}=(0,y.useState)(!1),{0:p,1:f}=(0,y.useState)([]),{0:x,1:v}=(0,y.useState)(t.description),j=t.description!==x,w=c.filter((e=>!o.some((t=>t.id===e.id)))),N=o.filter((e=>!c.some((t=>t.id===e.id)))),Z=0===w.length&&0===N.length&&!j,D=(0,M.Zs)(i,t),{data:E,mutate:A}=(0,U.h_)(D?"/collections/@".concat(l.login):null),V=!G(t)||(0,T.s9)(t)||(0,T.Gw)(t)?i.teams.find((e=>e.id!==l.id&&(0,M.pb)(e))):void 0,{data:q}=(0,U.h_)(V?"/collections/@".concat(V.login):null);function P(e,t){d(t?c.concat(e):c.filter((t=>t.id!==e.id)))}(0,y.useEffect)((()=>{d(o)}),[o]),(0,y.useEffect)((()=>{if((!D||E)&&(!V||q)){const e=[],n=W(t)?t.id:void 0;E&&e.push(z(l,E,n)),V&&q&&e.push(z(V,q,n)),h(e.filter((e=>e.public.length+e.private.length>0)).sort(function(e){return(t,n)=>{let{user:s}=t,{user:i}=n;return s.id===e.id?-1:i.id===e.id?1:s.login.localeCompare(i.login)}}(i)))}}),[E,q,V,D,i,l,t]);const F=c.length?c.map((e=>e.title)).join(", "):"None",Y=x&&x.length||0;return(0,a.jsxs)(r.Vq,{onDismiss:n,"aria-labelledby":"modal-title",children:[(0,a.jsx)(m.xB,{title:"Add to collection",icon:R.Z,onDismiss:n}),(0,a.jsxs)(m.fe,{children:[(0,a.jsxs)("div",{className:"truncate f6 fw5 gray",children:[(0,a.jsxs)("span",{children:["Selected (",c.length,"): "]}),(0,a.jsx)("b",{title:F,className:"fw6 dark-gray",children:F})]}),(0,a.jsx)(_.Z,{name:"filter",className:"db w-100 mt2 mb3",placeholder:"Filter collections",type:"text",onChange:e=>f(e.target.value.toLowerCase().split(/\s+/).filter((e=>e)))}),(0,a.jsx)("div",{className:"mv2 overflow-auto",style:{height:250},children:null===u?(0,a.jsxs)("div",{className:"flex f7 fw6 gray items-center justify-center lh-copy fade-in delay-short h-100",children:[(0,a.jsx)(L.Z,{}),(0,a.jsx)("span",{className:"ml2",children:"Loading"})]}):u.length>0?u.map((e=>(0,a.jsxs)("div",{className:"pb1 mb3",children:[(u.length>1||e.user.id!==i.id)&&(0,a.jsxs)("div",{className:"flex mb2 f6 fw5 near-black items-center",children:[(0,a.jsx)(k.q,{user:e.user,size:16,className:"mr2 br-100"}),(0,a.jsx)("span",{children:(0,I.RX)(e.user)})]}),e.private.length?(0,a.jsx)(B,{type:"private",group:e,filters:p,selected:c,onChange:P},"".concat(e.user.id,":private")):null,e.public.length?(0,a.jsx)(B,{type:"public",group:e,filters:p,selected:c,onChange:P,restricted:G(t)&&!(0,M.M6)(i,e.user,t)},"".concat(e.user.id,":public")):null]},e.user.id))):(0,a.jsx)("div",{className:"flex f7 fw5 gray items-center justify-center lh-copy fade-in h-100",children:"You don\u2019t have any collections."})})]}),(0,a.jsxs)(m.mz,{children:[(0,M.pq)(i,l)&&(0,a.jsx)(O,{owner:l,onCollectionCreated:function(e,t,n){n&&(P(n,!0),A())},currentUser:i}),G(t)&&(0,M.qG)(i,t)&&(0,a.jsxs)("div",{className:"mv3",children:[(0,a.jsx)("div",{className:"mv2 fw5 dark-gray",children:"Set notebook description (internal use only)"}),(0,a.jsx)(S.g,{name:"description",className:"db w-100",autoResize:!0,placeholder:"Enter notebook description. Currently only used for editorial purposes, e.g. our blog.",value:x||"",maxLength:300,onChange:e=>v(e.target.value)}),(0,a.jsx)("div",{className:"flex flex-column items-end mt2 gray f7 fw5",children:(0,a.jsx)("div",{children:"(".concat(Y,"/").concat(300,")")})})]}),(0,a.jsxs)(C.CQ,{className:"mt2",children:[(0,a.jsx)(C.kq,{text:"Cancel",onClick:n}),(0,a.jsx)(C.KM,{disabled:Z,loading:b,onClick:function(){g(!0),W(t)?s({type:"updateCollectionInCollections",addTo:w,removeFrom:N,collectionId:t.id,onDismiss:n}):(s({type:"collections",addTo:w,removeFrom:N,onDismiss:n}),x&&j&&s({type:"descriptionUpdate",description:x,onDismiss:n}))},text:"Confirm"})]})]})]})},X=P((e=>{let{currentUser:t}=e;return{currentUser:t}}),(e=>({dispatch:e})))((e=>{const{collectionListing:t,onDismiss:n}=e,i=(0,w.Z)(e,["collectionListing","onDismiss"]),{data:l,mutate:r}=(0,U.h_)(function(e){return"type"in e&&("notebook_reader"===e.type||"notebook_owner"===e.type)}(t)?"/document/".concat(t.id):null),{data:o,mutate:c}=(0,U.h_)(function(e){return"listing_type"in e&&"collection"===e.listing_type}(t)||function(e){return"ordered"in e&&!("listing_type"in e)}(t)?"/collection/@".concat(t.owner.login,"/").concat(t.slug,"?").concat((0,A.P)({page:1})):null),{0:d,1:u}=(0,y.useState)();(0,y.useEffect)((()=>{G(t)||W(t)?u(t):l?((0,M.iU)(e.currentUser,l),u((0,V.D)({initialNotebook:l,initialCurrentUser:e.currentUser,initialContext:l.owner}))):u(o||void 0)}),[t,u,l,o,e.currentUser]);const m=(0,y.useCallback)((()=>{r(),c(),n()}),[r,c,n]);return d?(0,a.jsx)(Y,(0,s.Z)({collectionListing:d,onDismiss:m},i)):null}));function G(e){return"collections"in e}function W(e){return"parent_collections"in e}var $=n(23952),H=n(76267);var K=n(75713),Q=n(28925),J=n(21013);const ee=(0,q.ZV)((e=>{let{notebook:t}=e;return{notebook:t}}),(e=>({dispatch:e})))((e=>{let{notebook:t,dispatch:n,onDismiss:s}=e;const{0:i,1:l}=(0,y.useState)(""),{thumbnail:o,defaultThumbnail:c}=t,d=(0,y.useRef)(null),{0:u,1:h}=(0,y.useState)(!0),b=u&&(i||o!==t.defaultThumbnail)&&i!==o;return(0,a.jsx)(r.Vq,{onDismiss:s,"aria-labelledby":"modal-title",children:(0,a.jsxs)(K.l,{ref:d,className:"relative f6 lh-copy",onSubmit:e=>{e.preventDefault(),n({type:"setNotebookThumbnail",customThumbnail:i}),s()},children:[(0,a.jsx)(m.xB,{title:"Set Thumbnail",icon:J.Z,onDismiss:s}),(0,a.jsx)(m.fe,{children:(0,a.jsx)("div",{className:"flex flex-column",children:(0,a.jsx)(Q.E,{thumbnail:o,defaultThumbnail:c,onValueChange:e=>{l(e),d.current&&h(d.current.checkValidity())}})})}),(0,a.jsx)(m.mz,{children:(0,a.jsxs)(C.CQ,{children:[(0,a.jsx)(C.kq,{text:"Cancel",onClick:s}),(0,a.jsx)(C.KM,{text:"Confirm",type:"submit",disabled:!b})]})})]})})}));var te=n(94184),ne=n.n(te),se=n(18794),ie=n(44754),le=n(27193),ae=n(75107);const re=/^[0-9a-z_-]+(?:\/[0-9]+)?$/;var oe;!function(e){e[e.Empty=0]="Empty",e[e.Conflict=1]="Conflict",e[e.Invalid=2]="Invalid",e[e.TooLong=3]="TooLong",e[e.Available=4]="Available"}(oe||(oe={}));const ce=(0,q.ZV)((e=>{let{notebook:t}=e;return{notebook:t}}),(e=>({dispatch:e})))((e=>{let{notebook:t,dispatch:n,onDismiss:s}=e;const{id:i,owner:l,slug:o}=t,c=(0,le.Ui)("model"in t?t.model:t),[d,u,h]=(0,ie.G)(o||(0,ae.O)(c),150),{0:b,1:g}=(0,y.useState)(oe.Available),{data:p}=(0,U.h_)((()=>h&&i&&(b===oe.Available||b===oe.Conflict)?"/document/".concat(i,"/slug-exists?slug=").concat(encodeURIComponent(h.replace(/\/$/,""))):null));function f(e){n({type:"setSlug",slug:e})}(0,y.useEffect)((()=>h?h.length>255?g(oe.TooLong):re.exec(h)?(null===p||void 0===p?void 0:p.exists)?g(oe.Conflict):void g(oe.Available):g(oe.Invalid):g(oe.Empty)),[h,g,p]);const x=b===oe.Available,v=!x&&b!==oe.Empty;return(0,a.jsx)(r.Vq,{onDismiss:s,"aria-labelledby":"modal-title","data-dialog-wide":!0,children:(0,a.jsxs)(K.l,{className:"relative f6 lh-copy",onSubmit:e=>{e.preventDefault(),f(d),s()},children:[(0,a.jsx)(m.xB,{title:"Set URL",icon:se.Z,onDismiss:s}),(0,a.jsxs)(m.fe,{children:[(0,a.jsxs)("div",{className:ne()("flex items-stretch br2 ba",v?"b--dark-pink":"b--black-10 hover-b--black-30"),children:[(0,a.jsxs)("div",{className:"pa2 pr0 pr1 black-70 bg-near-white br b--black-10 br2 br--left",onClick:()=>{var e;null===(e=document.querySelector("#slug"))||void 0===e||e.focus()},children:["observablehq.com/@",l.login,"/"]}),(0,a.jsx)("input",{id:"slug",placeholder:d,value:d,className:"pa2 black br2 flex-auto br--right bn",onChange:e=>u(e.target.value)})]}),v?(0,a.jsx)("div",{className:"pa1 mt1 f7 fw5 dark-pink",children:(j=b,j===oe.Conflict?"A notebook already exists at that URL.":j===oe.Invalid?"URL can only include lowercase alphanumeric characters, hyphens, underscores, and an optional forward slash suffix (/2).":j===oe.TooLong?"URL must be less than 255 characters long.":null)}):null]}),(0,a.jsx)(m.mz,{children:(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)(C.sn,{text:"Reset",destructive:!0,"data-cy":"reset-slug",onClick:e=>{e.preventDefault(),f(null),s()}}),(0,a.jsxs)(C.CQ,{children:[(0,a.jsx)(C.kq,{text:"Cancel",onClick:s}),(0,a.jsx)(C.KM,{text:"Confirm",type:"submit",disabled:!x})]})]})})]})});var j}));var de=n(20042),ue=n(27919),me=n(37809),he=n(54256),be=n(87671),ge=n(87769),pe=n(75838),fe=n(71043),xe=n(55267),ve=n(84193),je=n(33090),we=n(88725);const ye=/^[0-9a-z_-]+(?:\/[0-9]+)?$/;var ke;function Ce(e){return e===ke.Conflict?"A notebook already exists at that URL.":e===ke.Invalid?"URL can only include lowercase alphanumeric characters, hyphens, underscores, and an optional forward slash suffix (/2).":e===ke.TooLong?"URL must be less than 255 characters long.":null}!function(e){e[e.Empty=0]="Empty",e[e.Conflict=1]="Conflict",e[e.Invalid=2]="Invalid",e[e.TooLong=3]="TooLong",e[e.Available=4]="Available"}(ke||(ke={}));const Ne=new URL("https://observablehq.com"),_e=e=>{var{slug:t,title:n,owner:i,notebookId:l,isPublic:r,onValueChange:o,className:c="",disabled:d}=e,u=(0,w.Z)(e,["slug","title","owner","notebookId","isPublic","onValueChange","className","disabled"]);const[m,h,b]=(0,ie.G)("",250),{0:g,1:p}=(0,y.useState)(ke.Available),{0:f,1:x}=(0,y.useState)(!1),{0:v,1:j}=(0,y.useState)(""),{0:k,1:N}=(0,y.useState)(),{data:_}=(0,U.h_)((()=>d||!m||b!==m||g!==ke.Available&&g!==ke.Conflict?null:"/document/".concat(l,"/slug-exists?slug=").concat(encodeURIComponent(b.replace(/\/$/,"")))));(0,y.useEffect)((()=>{k&&clearTimeout(k)}),[]),(0,y.useEffect)((()=>{x(!!t)}),[r,t,h]),(0,y.useEffect)((()=>{f?(j("@".concat(i.login,"/")),h(t||(n?(0,ae.O)(n):""))):(j(r?(0,we.UW)({id:l,owner:i,slug:(0,ae.O)(n)}).substring(1):"d/".concat(l)),h(""))}),[t,h,f,n,r]),(0,y.useEffect)((()=>{let e=ke.Available;m?m.length>255?e=ke.TooLong:ye.exec(m)?(null===_||void 0===_?void 0:_.exists)&&(e=ke.Conflict):e=ke.Invalid:e=ke.Empty,p(e),R(Ce(e)),Z.current&&Z.current.setCustomValidity(f&&e!==ke.Available?"Please enter a Url":""),o(f?m:null)}),[m,p,_,o,f]);const Z=(0,y.useRef)(null),S=g!==ke.Available&&g!==ke.Empty,{0:L,1:R}=(0,y.useState)(Ce(g));return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"flex flex-column",children:[(0,a.jsx)(je.E,{disabled:d,name:"slugMode",label:"Automatic",checked:!f,onChange:()=>x(!1),value:"automatic"}),(0,a.jsx)(je.E,{disabled:d,name:"slugMode",label:"Custom",checked:f,onChange:()=>x(!0),value:"custom"})]}),(0,a.jsxs)("div",{className:"flex lh-default",children:[(0,a.jsxs)("div",{className:ne()("ba br2 pa0 flex items-stretch f6 fw4 flex-grow-1 min-w-0",S?"b--dark-pink":"b--black-10 hover-b--black-30",c),children:[(0,a.jsx)("div",{className:ne()("bg-near-white b--black-10 br2 mid-gray ma0 pa2 truncate",f?"br--left br":"flex-grow-1"),children:"".concat(Ne.host,"/").concat(v)}),f&&(0,a.jsx)("input",(0,s.Z)({type:"text",name:"custom-slug",onInvalid:e=>e.preventDefault(),ref:Z,className:"ba0 br2 br--right pa2 bn near-black flex-grow-1",placeholder:r?(0,ae.O)(n):"",disabled:d||!f,value:m,onInput:e=>h(e.target.value)},u))]}),(0,a.jsx)(C.kq,{className:"ml2","data-cy":"copy",onClick:function(){const e=new URL(v+m,Ne);navigator.clipboard.writeText(e.href);const t=L;R("Copied URL to clipboard"),N(setTimeout((()=>{R(t)}),2e3))},text:"Copy"})]}),L&&(0,a.jsx)("div",{className:"dark-pink f7 fw4",children:L})]})},Ze=e=>{let{description:t="",onValueChange:n}=e;const s=(0,y.useRef)(null),{0:i,1:l}=(0,y.useState)(t);return(0,y.useEffect)((()=>{n(i)}),[n,i]),(0,a.jsxs)("div",{className:"mv3",children:[(0,a.jsx)("div",{className:"mv2 fw5 dark-gray",children:"Set notebook description (internal use only)"}),(0,a.jsx)(S.g,{ref:s,name:"description",className:"db w-100",autoResize:!0,placeholder:"Enter notebook description. Currently only used for editorial purposes, e.g. our blog.",value:i,maxLength:300,onChange:e=>l(e.target.value)}),(0,a.jsx)("div",{className:"flex flex-column items-end mt2 gray f7 fw5",children:(0,a.jsx)("div",{children:"(".concat(i.length,"/").concat(300,")")})})]})};var Se=n(95577),Le=n(43489),Re=n(14921),Ue=n(80835);const De=(e,t)=>{if(!e||!t)return{};const n=e.left+e.width/2-t.width/2,s=window.innerWidth-t.width-2;return{left:Math.min(Math.max(2,n),s)+window.scrollX,top:e.bottom+8+window.scrollY}},Ee=e=>{let{children:t,className:n,label:l}=e;const[r,o]=(0,Ue.lL)(),{isVisible:c,triggerRect:d}=o;return(0,a.jsxs)(a.Fragment,{children:[y.cloneElement(y.Children.only(t),r),c&&(0,a.jsx)(Re.h,{children:(0,a.jsx)("div",{className:"absolute z-5",style:{borderLeft:"".concat(10,"px solid transparent"),borderRight:"".concat(10,"px solid transparent"),borderBottom:"".concat(10,"px solid"),borderBottomColor:"var(--white)",height:0,left:d?d.left-10+d.width/2:"",marginBottom:1,top:d?d.bottom+window.scrollY:"",width:0}})}),(0,a.jsx)(Ue.zG,(0,i.Z)((0,s.Z)({},o),{className:n,label:l,position:De}))]})};var Me=n(86723),Te=n(47692);const Ae=null,Ie={avatar_url:null,bio:"",github_login:null,home_url:"",id:"0",login:"",name:"",pending:!0,role:Ae,status:"member",team_role:null,tier:"pro",type:"team",following_count:0,followers_count:0,following:!1};function Ve(e){return{avatar_url:e.avatar_url,bio:e.bio,github_login:e.github_login,home_url:e.home_url,id:e.id,login:e.login||e.id,name:e.name,pending:!0,role:null,status:"member",team_role:e.role,tier:e.tier,type:"individual",following_count:e.following_count,followers_count:e.following_count,following:e.following}}function qe(e,t){return{avatar_url:e.avatar_url,bio:e.bio,github_login:"github_login"in e?e.github_login:null,home_url:e.home_url,id:e.id,login:e.login||e.id,name:e.name,pending:!0,role:t,status:"status"in e?e.status:"member",team_role:"team_role"in e?e.team_role:Ae,tier:e.tier,type:"type"in e?e.type:"individual",following_count:e.following_count,followers_count:e.following_count,following:e.following}}function Pe(e,t){return t.find((t=>t.id===e.id))||qe(e,Ae)}function ze(e,t){switch(e){case"editor":return"team"===t.type||"group"===t.type?"Can view or edit":"Can edit";case"viewer":return"Can view";default:return"team"===t.type?"No access":"invited"!==t.status||t.pending?"Remove":"Rescind invitation"}}const Fe=e=>{const{member:t,roles:n,changeMemberRole:s}=e;return(0,a.jsx)(Z.P,{name:"role_change","data-scope":"user:".concat(t.login),value:t.role||"",onChange:e=>{s(t,e.target.value?e.target.value:null)},disabled:n.length<=1,children:n.map((e=>(0,a.jsx)("option",{value:e||"",children:ze(e,t)},e)))})},Be="mr2 br-100 flex justify-center items-center dark-green bg-observable-washed-green",Oe=e=>{const{member:t,pendingMembers:n,memberCount:s,changeMemberRole:i,notebook:l,canAssignRoles:r,disclaimer:o,currentUser:c,liveSelected:d}=e,u=(0,y.useMemo)((()=>{const e=[];return r?(["owner","member","guest_member",null].includes(t.team_role)&&e.push("editor"),function(){if("editor"!==t.role)return!1;const e=n.filter((e=>"editor"===e.role));if(1===e.length&&t.id===e[0].id)return!0;const s=(0,I.jR)(l.owner.id,c);if(!s||s.setting_publish_transfer||(0,T.ws)(l))return!1;const i=e.filter((e=>"owner"===e.team_role||e.id===l.owner.id));return!(i.length>1||0===i.length)&&t.id===i[0].id}()||(e.push("viewer"),d&&t.role!==Ae||e.push(Ae))):(c.id===t.id&&e.push(Ae),e.push(t.role)),e}),[r,l,c,n,t,d]),m=t.icon,h=void 0!==s&&s>0;return(0,a.jsxs)("div",{className:"flex g3 f6 fw5 mb2 justify-between items-center",children:[(0,a.jsxs)("div",{className:"flex items-center min-w-0 g1",children:["member"===t.status&&m?(0,a.jsx)("div",{className:Be,style:{width:28,height:28},children:(0,a.jsx)(m,{})}):"group"===t.type?(0,a.jsx)(pe.Z,{className:"mr2"}):(0,a.jsx)(k.q,{user:t,id:t.id,size:28,className:"mr2 br-100"}),"invited"===t.status&&(0,a.jsx)("div",{className:"mr2 br-100 bg-light-silver flex items-center justify-center",style:{height:28,width:28},children:(0,a.jsx)(xe.Z,{height:16,className:"mid-gray"})}),(0,a.jsxs)("div",{className:ne()("truncate",h?"flex-column":""),children:[(0,a.jsx)("span",{className:"near-black",children:t.name||t.login}),t.id===c.id?(0,a.jsx)("span",{className:"ml1 gray",children:"(You)"}):"invited"===t.status&&t.pending?(0,a.jsx)("span",{className:"truncate gray",children:"\xa0(Invite)"}):"invited"===t.status?(0,a.jsx)("span",{className:"truncate gray",children:"\xa0(Invited)"}):"group"===t.type?(0,a.jsx)("span",{className:"truncate gray",children:"\xa0(Group)"}):t.name&&t.name!==t.login&&(0,a.jsxs)("span",{className:"truncate gray",children:["\xa0(@",t.login,")"]}),h&&(0,a.jsx)("div",{className:"gray",children:"".concat(s," member").concat(1!==s?"s":"")})]}),("guest_viewer"===t.team_role||"guest_member"===t.team_role)&&(0,a.jsx)(Le.i,{className:"dark-gray"})]}),(0,a.jsxs)("div",{className:"flex",children:[o&&(0,a.jsx)("div",{className:"flex items-center mr1",children:(0,a.jsx)(Ee,{className:ne()(Ue.Xv,"pa3 pre-line mw5"),label:o.message,children:(0,a.jsx)("div",{className:"flex items-center",children:(0,a.jsx)(o.icon,{})})})}),t.id===l.owner.id&&"individual"===l.owner.type?(0,a.jsx)("div",{className:"gray pv2 bt bb b--transparent lh-default",children:"Owner"}):(0,a.jsx)(Fe,{member:t,changeMemberRole:i,roles:u})]})]})},Ye=e=>{const{notebook:t,changePublishLevel:n,publishLevel:s}=e;return(0,a.jsxs)("div",{className:"flex f6 fw5 mb2 justify-between items-center",children:[(0,a.jsxs)("div",{className:"flex items-center min-w-0",children:[(0,a.jsx)("div",{className:Be,style:{width:28,height:28},children:(0,a.jsx)(ge.Z,{})}),(0,a.jsx)("div",{children:(0,a.jsx)("span",{className:"near-black",children:"Public"})})]}),(0,a.jsxs)("div",{className:"flex items-center",children:[("public"===s||"shared"===s)&&(0,a.jsx)("div",{className:"flex items-center mr1",children:(0,a.jsx)(Ee,{className:ne()(Ue.Xv,"pa3 pre-line mw5"),label:(0,a.jsxs)(a.Fragment,{children:["A published or unlisted version of this notebook is visible to the public, but new edits are not.",(0,a.jsx)("p",{children:"Change this setting to make this notebook fully public or private."})]}),children:(0,a.jsx)("div",{children:(0,a.jsx)(be.Z,{className:"w1 h1 mh2 gold bg-lightest-yellow flex-no-shrink br-pill"})})})}),(0,a.jsxs)(Z.P,{name:"role_change","data-scope":"public",value:s,onChange:e=>n(e.target.value),disabled:!(0,M.zB)(t),children:[(0,a.jsx)("option",{value:"live",children:"Can view"}),((0,T.nv)(t)||(0,M._l)(t))&&(0,a.jsx)("option",{value:"live_unlisted",children:"Can view (unlisted)"}),(0,T.cg)(t)&&(0,a.jsx)("option",{value:"shared",children:"Can view unlisted published version"}),(0,T.s9)(t)&&(0,a.jsx)("option",{value:"public",children:"Can view published version"}),((0,T.ws)(t)||(0,M._l)(t))&&(0,a.jsx)("option",{value:"private",children:"No access"})]})]})]})},Xe=(0,q.ZV)((e=>{let{notebook:t,currentUser:n}=e;return{notebook:t,currentUser:n}}),(e=>({dispatch:e})))((e=>{const{notebook:t,currentUser:n}=e,l="team"===t.owner.type,{data:r}=(0,U.h_)("/document/".concat(t.id,"/members")),o=(0,y.useMemo)((()=>null===r||void 0===r?void 0:r.map((e=>(0,i.Z)((0,s.Z)({},e),{bio:"",github_login:null,home_url:"",pending:!1})))),[r]),{data:c}=(0,U.h_)(l?"/team/".concat(t.owner.id,"/members"):null),d=(0,y.useMemo)((()=>null===c||void 0===c?void 0:c.map(Ve)),[c]),{data:u}=(0,U.h_)(l?"/team/".concat(t.owner.id,"/groups"):null),{data:m}=(0,U.h_)("/document/".concat(t.id,"/importers?page=1"));return o&&(!l||d)&&m?(0,a.jsx)(Ge,(0,i.Z)((0,s.Z)({},e),{currentUser:n,documentMembers:o,teamMembers:d,groups:u,importers:m})):null})),Ge=e=>{const{notebook:t,onDismiss:n,dispatch:s,documentMembers:i,teamMembers:l,groups:o,importers:c}=e,d=e.currentUser,u="team"===t.owner.type&&d.teams.some((e=>e.id===t.owner.id)),{0:h,1:b}=(0,y.useState)("editor"),{0:g,1:p}=(0,y.useState)(null),{0:f,1:x}=(0,y.useState)(null),{0:v,1:j}=(0,y.useState)(null),{0:w,1:k}=(0,y.useState)(""),{defaultThumbnail:N,owner:S,publishLevel:L,thumbnail:R}=t,U=(0,Me.X)(),D="public"===S.tier&&(null===U||void 0===U?void 0:U.id)===S.id,{0:E,1:A}=(0,y.useState)(!0),I=E&&(w||R!==t.defaultThumbnail)&&w!==R&&(0,M.fW)(t),V=E&&f!==t.slug&&(0,M.mO)(t),q=E&&null!==v&&"description"in t&&v!==t.description,P=(0,y.useRef)(null),z=g&&("invited"in g?{avatar_url:null,bio:"",github_login:null,home_url:"",id:g.login,name:"",login:g.login,pending:!0,role:Ae,status:"invited",team_role:null,tier:"pro",type:"individual",following_count:0,followers_count:0,following:!1}:qe(g,Ae)),{0:F,1:B}=(0,y.useState)([]),{0:O,1:Y}=(0,y.useState)([]),{0:X,1:G}=(0,y.useState)(""),W=(0,le.Ui)("title"in t?t:t.model),{0:$,1:H}=(0,y.useState)(L),K="live"===$||"live_unlisted"===$;(0,y.useEffect)((()=>{B(i),Y(i)}),[i]);const J=F.filter((e=>"individual"===e.type&&!O.find((t=>t.id===e.id)))).length,ee=Pe(d,O),te=Pe(d,F),ne=u?Pe(t.owner,O):Ie,se=u?Pe(t.owner,F):Ie,ie=u?O.filter((e=>"group"===e.type&&(null===o||void 0===o?void 0:o.find((t=>t.id===e.id&&t.ids.includes(d.id)))))):null,ae=u?F.filter((e=>"group"===e.type&&(null===o||void 0===o?void 0:o.find((t=>t.id===e.id&&t.ids.includes(d.id)))))):null,re=Pe(t.owner,O),oe=F.filter((e=>e.id!==t.owner.id&&e.id!==d.id)),ce=!u&&"model"in t&&(0,Te.Z)(t.model.nodes),be=ce&&(ce.databaseClients.size>0||ce.secrets.size>0),pe=O.length===F.length&&O.every((e=>F.some((t=>e.id===t.id&&t.role===e.role))));function xe(e){return"team"!==e.type||F.some((e=>("individual"===e.type||"group"===e.type)&&"editor"===e.role))?"editor"===se.role&&"viewer"===e.role&&"viewer"!==e.team_role&&"guest_viewer"!==e.team_role&&"guest_member"!==e.team_role?{icon:ue.Z,message:"individual"===e.type?"This user can still edit the notebook because they\u2019re an editor in the team it\u2019s shared with.":"Users in this group will still be able to edit the notebook if they\u2019re an editor in the team it\u2019s shared with."}:"individual"===t.owner.type&&(0,T.ws)(t)&&"public"===e.tier&&!K?{icon:he.Z,message:"This user will need to upgrade to Pro to view this private notebook.\n\nAlternatively, set Public to \u201cCan view\u201d to collaborate with Free users in public."}:void 0:{icon:fe.Z,message:"Notebooks must have at least one editor."}}function je(e,t){const n=F.findIndex((t=>t.id===e.id)),s=qe(e,t);if(n>-1)if(t!==Ae){const e=Array.from(F);e[n]=s,B(e)}else B(F.filter((t=>t.id!==e.id)));else B([...F,s])}var ye;const ke=["guest_member","guest_viewer"].includes(null!==(ye=ee.team_role)&&void 0!==ye?ye:""),Ce="editor"===ee.role||"editor"===ne.role&&!ke||ie&&ie.length>0&&ie.some((e=>"editor"===e.role)),Ne="editor"===te.role||"editor"===se.role&&!ke||ae&&ae.length>0&&ae.some((e=>"editor"===e.role)),Le="viewer"===te.role||"viewer"===se.role&&!ke||ae&&ae.length>0&&ae.some((e=>"viewer"===e.role)),Re=Ce&&!Ne&&F!==O,Ue=!Ne&&!Le&&F!==O,De=I||V||q||!pe||$!==L;function Ee(e){if(e.preventDefault(),I&&s({type:"setNotebookThumbnail",customThumbnail:w}),V&&s({type:"setSlug",slug:f||null}),q&&s({type:"descriptionUpdate",description:v,onDismiss:n}),!pe){const e=Ue?[]:Re?["viewer"]:t.roles.filter((e=>!(K&&"readonly"===e)));s({type:"share",currentMembers:O,newMembers:F,newRoles:e,message:X})}$!==L&&s(K?{type:"publishLiveRequested",unlisted:"live_unlisted"===$}:{type:"unpublishRequested"}),n()}const Ve=(0,M.sZ)(d,t),ze=!u&&F.length>=5;return(0,a.jsx)(r.Vq,{onDismiss:n,"aria-labelledby":"modal-title",children:(0,a.jsxs)("form",{noValidate:!0,name:"publishForm",ref:P,onSubmit:Ee,children:[(0,a.jsx)(m.xB,{title:"Share",icon:ge.Z,onDismiss:n}),!!c.total&&"private"!==t.publishLevel&&"private"===$&&(0,a.jsxs)("aside",{className:"pa3 flex bg-observable-dark-gold white",children:[(0,a.jsx)("div",{children:(0,a.jsx)(he.Z,{className:"mr2",width:16})}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"mb2",children:[(0,a.jsx)(ve.Z,{href:"".concat((0,we.Bi)(t),"/importers"),children:(0,a.jsx)("a",{className:"hover-dark-blue",id:"importers-link",style:{textDecoration:"underline"},children:"".concat((0,T.YY)(c.total,"notebook"))})})," ","".concat((0,T.xC)(c.total,"imports","import")," cells from this notebook.")]}),(0,a.jsx)("span",{className:"fw6",children:"Making it private will cause ".concat((0,T.xC)(c.total,"this","these")," ").concat((0,T.xC)(c.total,"import")," to fail.")})," ",(0,a.jsxs)("span",{children:["If you want to work on substantial edits to this notebook, consider"," ",(0,a.jsx)(ve.Z,{href:"/@observablehq/fork-suggest-merge?collection=@observablehq/editing-publishing-collaborating",children:(0,a.jsx)("a",{className:"hover-dark-blue",style:{textDecoration:"underline"},children:"forking and merging"})})," ","or using"," ",(0,a.jsx)(ve.Z,{href:"/@observablehq/pause-live-edits-in-public-notebooks?collection=@observablehq/editing-publishing-collaborating",children:(0,a.jsx)("a",{className:"hover-dark-blue",style:{textDecoration:"underline"},children:"pause live edits"})})," ","from the notebook menu."]})]})]}),(0,a.jsxs)(m.fe,{children:[(0,M.mO)(t)&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(m.pe,{className:"mt0",title:"Notebook URL"}),(0,a.jsx)(_e,{owner:t.owner,notebookId:t.id,title:W,slug:t.slug,isPublic:"public"===t.publishLevel&&!K,onValueChange:e=>{x(e),P.current&&A(P.current.checkValidity())}})]}),(0,a.jsxs)("div",{className:"mb3",children:[(0,a.jsx)(m.pe,{className:(0,M.mO)(t)?"mt4":"mt0",title:"Access"}),D&&(0,a.jsx)(Se.N,{size:"large",user:U})]}),(0,a.jsxs)("div",{className:"mb2",children:[(0,a.jsx)(Ye,{publishLevel:$,notebook:t,changePublishLevel:e=>{H(e),K&&u&&se.role===Ae&&je(se,"viewer")}}),u&&(0,a.jsx)(Oe,{member:se,pendingMembers:F,liveSelected:K,notebook:t,canAssignRoles:Ve,memberCount:null===l||void 0===l?void 0:l.filter((e=>"guest_viewer"!==e.team_role&&"guest_member"!==e.team_role)).length,changeMemberRole:je,currentUser:d,disclaimer:xe(se)}),!u&&(0,a.jsx)(Oe,{member:re,pendingMembers:F,notebook:t,canAssignRoles:Ve,changeMemberRole:je,currentUser:d}),(0,a.jsx)("div",{className:"w-100 overflow-auto",style:{maxHeight:250},children:te.role||oe.length?(0,a.jsxs)(a.Fragment,{children:[te.role&&te.id!==t.owner.id&&(0,a.jsx)(Oe,{member:te,pendingMembers:F,notebook:t,canAssignRoles:Ve,changeMemberRole:je,disclaimer:xe(te),currentUser:d}),oe.map((e=>{var n;return(0,a.jsx)(Oe,{member:e,memberCount:"group"===e.type?null===(n=null===o||void 0===o?void 0:o.find((t=>t.id===e.id)))||void 0===n?void 0:n.ids.length:void 0,pendingMembers:F,notebook:t,canAssignRoles:Ve,changeMemberRole:je,disclaimer:xe(e),currentUser:d},e.id)}))]}):u?(0,a.jsx)("div",{className:"f7 fw5 gray",style:{padding:"15px 0"},children:"No team members have been granted individual access to this notebook."}):t.owner.id===d.id?(0,a.jsx)("div",{className:"f7 fw5 gray",style:{padding:"15px 0"},children:"Only you can make changes to this notebook."}):(0,a.jsx)("div",{className:"f7 fw5 gray",style:{padding:"15px 0"},children:"You will no longer have access to this notebook."})})]}),Ve&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsx)(de.o,{value:g,type:"individual",className:"flex items-center flex-grow-1 min-w-0",universe:u?[...l||[],...(o||[]).map((e=>function(e){return{avatar_url:null,bio:"",github_login:null,home_url:"",id:e.id,login:e.id,name:e.name,pending:!0,role:null,status:"member",team_role:null,tier:"pro",type:"group",following_count:0,followers_count:0,following:!1}}(e)))]:void 0,excluded:F,placeholder:u&&(0,T.qb)(t.owner)?"Search for a teammate or group":u?"Search for a teammate":"User to share with, or email to invite",disabled:ze,allowEmail:!u,onSelectUser:e=>{const t=e&&!("invited"in e)&&(null===l||void 0===l?void 0:l.some((t=>t.id===e.id&&("viewer"===t.team_role||"guest_viewer"===t.team_role))));p(e),b(t?"viewer":"editor")}}),(0,a.jsxs)(Z.P,{value:h,onChange:e=>b(e.target.value),disabled:ze||!z,className:"mh2 f6 fw5",children:[(!z||"viewer"!==z.team_role&&"guest_viewer"!==z.team_role&&"group"!==z.type)&&(0,a.jsx)("option",{value:"editor",children:"Can edit"}),"group"===(null===z||void 0===z?void 0:z.type)&&(0,a.jsx)("option",{value:"editor",children:"Can view or edit"}),(0,a.jsx)("option",{value:"viewer",children:"Can view"})]}),(0,a.jsx)(C.aX,{text:"Add",onClick:function(){null!==z&&(je(z,h),p(null))},disabled:!z,"data-cy":"add-user"})]}),ze&&(0,a.jsx)("div",{className:"mv1 pl2 f7 mid-gray",style:{marginLeft:1},children:"Personal notebooks can be shared with up to four people"}),J>0&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(m.pe,{className:"mt3",title:"Invitation message"}),(0,a.jsx)("div",{className:"flex flex-row items-center self-start w-100",children:(0,a.jsx)(_.Z,{className:"w-100",type:"text",placeholder:"Optional message to ".concat(J," new member").concat(1===J?"":"s"),value:X,onChange:e=>G(e.target.value),onKeyDown:e=>{"Enter"===e.key&&Ee(e)},maxLength:255})})]})]}),(0,M.fW)(t)&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(m.pe,{title:"Thumbnail"}),(0,a.jsx)(Q.E,{thumbnail:R,defaultThumbnail:N,onValueChange:e=>{k(e),P.current&&A(P.current.checkValidity())}})]}),(0,M.qG)(d,t)&&"description"in t&&(0,a.jsx)(Ze,{description:t.description,onValueChange:j})]}),(0,a.jsxs)(m.mz,{children:[Ue||Re?(0,a.jsx)(me.b,{type:"warning",title:"You'll no longer be able to ".concat(Ue?"access":"edit"," this notebook"),description:"Please make changes to the roles above if you wish to retain your current access.",className:"mb3"}):null,be?(0,a.jsx)(me.b,{type:"warning",title:"Database clients and secrets will stop working when you share",description:"These features can be used only in private notebooks.",className:"mb3"}):null,(0,a.jsxs)(C.CQ,{children:[(0,a.jsx)(C.kq,{onClick:n,text:"Cancel"}),(0,a.jsx)(C.KM,{"data-cy":"confirm",type:"submit",disabled:!De,text:"Save"})]})]})]})})};var We=n(8433);const $e=P((e=>{let{notebook:t}=e;return{notebook:t}}),(e=>({dispatch:e})))((e=>{let{notebook:t,relocate:n,dispatch:s,onDismiss:i}=e;return(0,a.jsx)(m.On,{title:"Move to trash",icon:We.Z,description:"Are you sure you want to move this notebook to the trash? Notebooks can be removed from the trash for 30 days before they are permanently deleted.",onCancel:i,onConfirm:()=>{i(),s({type:"trashRequested",trashed:!0,relocate:n})},isConfirming:t.isUpdatingTrash,destructive:!0})}));var He=n(29157);const Ke=(0,v.$j)(((e,t)=>{let{notebook:n}=e,{id:s}=t;return{data:(0,x.DY)(n.model,s).data}}),(e=>({dispatch:e})))((e=>{let{dispatch:t,onDismiss:n,id:s,data:i}=e;return(0,a.jsxs)(r.Vq,{onDismiss:n,children:[(0,a.jsx)(m.xB,{title:"Customize",onDismiss:n}),(0,a.jsxs)("div",{className:"flex flex-column pa3 bt b--silver",children:[(0,a.jsx)("button",{className:"ml-auto bg-transparent bn blue fw6 f7 pa0 pointer",onClick:()=>t({type:"setChartConfig",id:s,options:null,source:"customize"}),children:"Clear"}),(0,a.jsx)(He.X,{id:s,options:i.config.options,dispatch:t})]})]})})),Qe=(0,i.Z)((0,s.Z)({},l.V),{setSlug:ce,share:Xe,trash:$e,fork:$.e1,forkWithComments:e=>{let{onConfirm:t,onDismiss:n}=e;return(0,a.jsx)(m.On,{title:"Continue with fork",icon:H.Z,description:"Your unsaved comments will be lost if you fork. Are you sure you want to continue?",onCancel:n,onConfirm:()=>{n(),t()}})},collections:X,setNotebookThumbnail:ee,tableOperation:j,transfer:$.Zd,chartCustomize:Ke})}}]);