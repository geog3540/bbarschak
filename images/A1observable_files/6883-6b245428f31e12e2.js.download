"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6883],{27565:function(e,t,s){s.d(t,{E:function(){return a}});var n=s(85893),r=s(602),i=s(4598);const a=e=>{let{provider:t,children:s,alreadyAuthenticated:a,redirectToPicker:l=!1,onAuth:o}=e;return(0,n.jsxs)("form",{onSubmit:e=>{e.target.token.value=(0,r.FN)(),o&&o(t,a)},action:"".concat("https://api.observablehq.com","/user/token/authorize"),method:"post",children:[(0,n.jsx)("input",{type:"hidden",name:"token",value:""}),(0,n.jsx)("input",{type:"hidden",name:"path",value:"".concat(location.pathname).concat(l?"?cloudFileProvider=".concat(t):"")}),(0,n.jsx)("input",{type:"hidden",name:"scopes",value:i.c[t].scopes.join(" ")}),(0,n.jsx)("input",{type:"hidden",name:"provider",value:t}),s]})}},94726:function(e,t,s){s.d(t,{h:function(){return p}});var n=s(85893),r=s(67294),i=s(8385),a=s(17905),l=s(84749),o=s(36815),c=s(14151),d=s(93939),h=s(62990),u=s(36448),m=s(80835);const p=e=>{let{commentingLock:t}=e;const{admin_locked:s,admin_lock_reason:p,user_lock_actor:x,time:f}=t,g=f||void 0,v=(0,d.K)(g),b=g&&(0,h.LN)(g,v),j=(0,c.d)((0,r.useCallback)((()=>(0,n.jsx)(m.u,{label:(0,n.jsxs)("div",{className:"truncate w5 pa2 f6 dark-gray",children:[s?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{children:["By"," ",(0,n.jsx)("a",{href:o.Eo.support,rel:"noopener noreferrer",target:"_blank",className:"no-underline dark-gray hover-blue",children:"Observable Support"}),b&&(0,n.jsxs)(n.Fragment,{children:[" on ",b]})]}),(0,n.jsx)("div",{className:"mt2 f7 fw5 ws-normal dark-gray lh-copy",children:p})]}):x&&(0,n.jsxs)("div",{className:"flex truncate items-center",children:["By",(0,n.jsx)(i.q,{user:x,size:14,alt:"@".concat(x.login),className:"mh1 br-100"}),(0,u.RX)(x),b&&(0,n.jsxs)(n.Fragment,{children:[" on ",b]})]}),(0,n.jsxs)("div",{className:"mt2 f7 fw5 ws-normal dark-gray lh-copy",children:["While comments are locked, only editors may comment."," ",(0,n.jsxs)("a",{href:"/@observablehq/comments",target:"_blank",rel:"noreferrer",className:"inline-flex no-underline blue items-center",children:["Learn more",(0,n.jsx)(a.Z,{})]})]})]}),children:(0,n.jsx)("span",{children:"Comments locked"})})),[s,p,x,b]));return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(l.Z,{className:"mr1 moon-gray"}),j]})}},26674:function(e,t,s){s.d(t,{J:function(){return y}});var n=s(85893),r=(s(67294),s(54239)),i=s(87671),a=s(41799),l=s(69396);var o=e=>{let{mimeType:t}=e;if(!t)return(0,n.jsx)(d,{className:"flex-shrink-0"});const[s,r]=t.split("/"),i={className:"flex-shrink-0",title:t};switch(s){case"audio":return(0,n.jsx)(u,(0,a.Z)({},i));case"video":return(0,n.jsx)(f,(0,a.Z)({},i));case"image":return"svg+xml"===r?(0,n.jsx)(x,(0,a.Z)({},i)):(0,n.jsx)(p,(0,a.Z)({},i));case"text":return"csv"===r||"tab-separated-values"===r?(0,n.jsx)(c,(0,a.Z)({},i)):(0,n.jsx)(m,(0,a.Z)({},i));case"application":switch(r){case"pdf":return(0,n.jsx)(h,(0,a.Z)({},i));case"geo+json":return(0,n.jsx)(g,(0,a.Z)({},i));case"xml":case"json":case"x-sqlite3":return(0,n.jsx)(c,(0,a.Z)({},i))}}return(0,n.jsx)(d,(0,a.Z)({},i))};function c(e){return(0,n.jsxs)("svg",(0,l.Z)((0,a.Z)({width:"24",height:"27",viewBox:"0 0 28 32",fill:"white"},e),{children:[(0,n.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M2 26.5C2 28.433 3.567 30 5.5 30H22.5C24.433 30 26 28.433 26 26.5V10.5H19.5C18.3954 10.5 17.5 9.60457 17.5 8.5V2H5.5C3.567 2 2 3.567 2 5.5V26.5Z",fill:"#EFEFEF"}),(0,n.jsx)("path",{d:"M26 10.5L17.5 2V8.5C17.5 9.60457 18.3954 10.5 19.5 10.5H26Z",fill:"#E2E2E2"}),(0,n.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M10.1111 14C9.49746 14 9 14.4975 9 15.1111V17.3333C9 17.947 9.49746 18.4444 10.1111 18.4444H12.3333C12.947 18.4444 13.4444 17.947 13.4444 17.3333V15.1111C13.4444 14.4975 12.947 14 12.3333 14H10.1111ZM15.6667 14C15.053 14 14.5556 14.4975 14.5556 15.1111V17.3333C14.5556 17.947 15.053 18.4444 15.6667 18.4444H17.8889C18.5025 18.4444 19 17.947 19 17.3333V15.1111C19 14.4975 18.5025 14 17.8889 14H15.6667ZM9 20.6667C9 20.053 9.49746 19.5556 10.1111 19.5556H12.3333C12.947 19.5556 13.4444 20.053 13.4444 20.6667V22.8889C13.4444 23.5025 12.947 24 12.3333 24H10.1111C9.49746 24 9 23.5025 9 22.8889V20.6667ZM15.6667 19.5556C15.053 19.5556 14.5556 20.053 14.5556 20.6667V22.8889C14.5556 23.5025 15.053 24 15.6667 24H17.8889C18.5025 24 19 23.5025 19 22.8889V20.6667C19 20.053 18.5025 19.5556 17.8889 19.5556H15.6667Z",fill:"#C4C4C4"})]}))}function d(e){return(0,n.jsxs)("svg",(0,l.Z)((0,a.Z)({width:"24",height:"27",viewBox:"0 0 28 32",fill:"none"},e),{children:[(0,n.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M2 26.5C2 28.433 3.567 30 5.5 30H22.5C24.433 30 26 28.433 26 26.5V10.5H19.5C18.3954 10.5 17.5 9.60457 17.5 8.5V2H5.5C3.567 2 2 3.567 2 5.5V26.5Z",fill:"#F2F2F2"}),(0,n.jsx)("path",{d:"M26 10.5L17.5 2V8.5C17.5 9.60457 18.3954 10.5 19.5 10.5H26Z",fill:"#E4E4E4"}),(0,n.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M13.4462 14.0293C12.5637 13.0792 11.0428 13.1363 10.2339 14.1499C9.5666 14.9861 9.6264 16.1884 10.3734 16.9543L16.6159 23.3543C16.8831 23.6284 17.3237 23.6284 17.591 23.3543C17.8491 23.0898 17.8491 22.6677 17.591 22.4032L11.979 16.6495L13.1244 15.5323L18.7364 21.286C19.6006 22.172 19.6006 23.5855 18.7364 24.4715C17.8412 25.3893 16.3657 25.3893 15.4705 24.4715L9.22803 18.0714C7.91758 16.7279 7.81268 14.6188 8.98334 13.1519C10.4023 11.3738 13.0703 11.2737 14.6185 12.9404L20.5861 19.3646L19.4139 20.4535L13.4462 14.0293Z",fill:"#C4C4C4"})]}))}function h(e){return(0,n.jsxs)("svg",(0,l.Z)((0,a.Z)({width:"24",height:"27",viewBox:"0 0 28 32",fill:"white"},e),{children:[(0,n.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M2 26.5C2 28.433 3.567 30 5.5 30H22.5C24.433 30 26 28.433 26 26.5V10.5H19.5C18.3954 10.5 17.5 9.60457 17.5 8.5V2H5.5C3.567 2 2 3.567 2 5.5V26.5Z",fill:"#EFEFEF"}),(0,n.jsx)("path",{d:"M26 10.5L17.5 2V8.5C17.5 9.60457 18.3954 10.5 19.5 10.5H26Z",fill:"#E2E2E2"}),(0,n.jsx)("rect",{x:"7",y:"20",width:"4",height:"4",stroke:"#C4C4C4",strokeWidth:"2"}),(0,n.jsx)("circle",{cx:"12.5",cy:"13.5",r:"2.5",stroke:"#C4C4C4",strokeWidth:"2"}),(0,n.jsx)("path",{d:"M15.4689 21.25L18.5 16L21.5311 21.25H15.4689Z",stroke:"#C4C4C4",strokeWidth:"2"})]}))}function u(e){return(0,n.jsxs)("svg",(0,l.Z)((0,a.Z)({width:"24",height:"27",viewBox:"0 0 28 32",fill:"white"},e),{children:[(0,n.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M2 26.5C2 28.433 3.567 30 5.5 30H22.5C24.433 30 26 28.433 26 26.5V10.5H19.5C18.3954 10.5 17.5 9.60457 17.5 8.5V2H5.5C3.567 2 2 3.567 2 5.5V26.5Z",fill:"#EFEFEF"}),(0,n.jsx)("path",{d:"M26 10.5L17.5 2V8.5C17.5 9.60457 18.3954 10.5 19.5 10.5H26Z",fill:"#E2E2E2"}),(0,n.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M17.0761 20.0534V14.2508L11.9239 15.8358V23.5082C11.9736 23.6655 12 23.8303 12 24C12 25.1046 10.8807 26 9.5 26C8.11929 26 7 25.1046 7 24C7 22.8954 8.11929 22 9.5 22C9.69829 22 9.89118 22.0185 10.0761 22.0534V15.8358C10.0761 15.0246 10.6052 14.3083 11.3806 14.0698L17.4893 12.1905C18.2021 11.9712 18.9239 12.5043 18.9239 13.2502V21.5082C18.9736 21.6655 19 21.8303 19 22C19 23.1046 17.8807 24 16.5 24C15.1193 24 14 23.1046 14 22C14 20.8954 15.1193 20 16.5 20C16.6983 20 16.8912 20.0185 17.0761 20.0534Z",fill:"#C4C4C4"})]}))}function m(e){return(0,n.jsxs)("svg",(0,l.Z)((0,a.Z)({width:"24",height:"27",viewBox:"0 0 28 32",fill:"white"},e),{children:[(0,n.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M2 26.5C2 28.433 3.567 30 5.5 30H22.5C24.433 30 26 28.433 26 26.5V10.5H19.5C18.3954 10.5 17.5 9.60457 17.5 8.5V2H5.5C3.567 2 2 3.567 2 5.5V26.5Z",fill:"#EFEFEF"}),(0,n.jsx)("path",{d:"M26 10.5L17.5 2V8.5C17.5 9.60457 18.3954 10.5 19.5 10.5H26Z",fill:"#E2E2E2"}),(0,n.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M7 15C7 14.4477 7.44772 14 8 14H20C20.5523 14 21 14.4477 21 15C21 15.5523 20.5523 16 20 16H8C7.44772 16 7 15.5523 7 15ZM7 19C7 18.4477 7.44772 18 8 18H20C20.5523 18 21 18.4477 21 19C21 19.5523 20.5523 20 20 20H8C7.44772 20 7 19.5523 7 19ZM8 22C7.44772 22 7 22.4477 7 23C7 23.5523 7.44772 24 8 24H15C15.5523 24 16 23.5523 16 23C16 22.4477 15.5523 22 15 22H8Z",fill:"#C4C4C4"})]}))}function p(e){return(0,n.jsxs)("svg",(0,l.Z)((0,a.Z)({width:"24",height:"27",viewBox:"0 0 28 32",fill:"white"},e),{children:[(0,n.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M2 26.5C2 28.433 3.567 30 5.5 30H22.5C24.433 30 26 28.433 26 26.5V10.5H19.5C18.3954 10.5 17.5 9.60457 17.5 8.5V2H5.5C3.567 2 2 3.567 2 5.5V26.5Z",fill:"#EFEFEF"}),(0,n.jsx)("path",{d:"M26 10.5L17.5 2V8.5C17.5 9.60457 18.3954 10.5 19.5 10.5H26Z",fill:"#E2E2E2"}),(0,n.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M19.9143 17.8125C21.2432 17.8125 22.3205 16.7352 22.3205 15.4062C22.3205 14.0773 21.2432 13 19.9143 13C18.5853 13 17.508 14.0773 17.508 15.4062C17.508 16.7352 18.5853 17.8125 19.9143 17.8125ZM9.08063 16.0838C9.42048 15.5174 10.2414 15.5174 10.5812 16.0838L13.7013 21.284L15.0893 19.4333C15.4393 18.9667 16.1393 18.9667 16.4893 19.4333L18.8643 22.6C19.2969 23.1768 18.8853 24 18.1643 24H13.7855H13.4143H5.87635C5.19622 24 4.77612 23.258 5.12605 22.6748L9.08063 16.0838Z",fill:"#C4C4C4"})]}))}function x(e){return(0,n.jsxs)("svg",(0,l.Z)((0,a.Z)({width:"24",height:"27",viewBox:"0 0 28 32",fill:"white"},e),{children:[(0,n.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M2 26.5C2 28.433 3.567 30 5.5 30H22.5C24.433 30 26 28.433 26 26.5V10.5H19.5C18.3954 10.5 17.5 9.60457 17.5 8.5V2H5.5C3.567 2 2 3.567 2 5.5V26.5Z",fill:"#EFEFEF"}),(0,n.jsx)("path",{d:"M26 10.5L17.5 2V8.5C17.5 9.60457 18.3954 10.5 19.5 10.5H26Z",fill:"#E2E2E2"}),(0,n.jsx)("rect",{x:"7",y:"20",width:"4",height:"4",stroke:"#C4C4C4",strokeWidth:"2"}),(0,n.jsx)("circle",{cx:"12.5",cy:"13.5",r:"2.5",stroke:"#C4C4C4",strokeWidth:"2"}),(0,n.jsx)("path",{d:"M15.4689 21.25L18.5 16L21.5311 21.25H15.4689Z",stroke:"#C4C4C4",strokeWidth:"2"})]}))}function f(e){return(0,n.jsxs)("svg",(0,l.Z)((0,a.Z)({width:"24",height:"27",viewBox:"0 0 28 32",fill:"white"},e),{children:[(0,n.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M2 26.5C2 28.433 3.567 30 5.5 30H22.5C24.433 30 26 28.433 26 26.5V10.5H19.5C18.3954 10.5 17.5 9.60457 17.5 8.5V2H5.5C3.567 2 2 3.567 2 5.5V26.5Z",fill:"#EFEFEF"}),(0,n.jsx)("path",{d:"M26 10.5L17.5 2V8.5C17.5 9.60457 18.3954 10.5 19.5 10.5H26Z",fill:"#E2E2E2"}),(0,n.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M14.1061 25.2121C17.4783 25.2121 20.2121 22.4783 20.2121 19.1061C20.2121 15.7338 17.4783 13 14.1061 13C10.7338 13 8 15.7338 8 19.1061C8 22.4783 10.7338 25.2121 14.1061 25.2121ZM16.2945 19.8756C16.8288 19.5017 16.8288 18.7104 16.2945 18.3365L14.175 16.8528C13.5524 16.417 12.6969 16.8624 12.6969 17.6224V20.5897C12.6969 21.3497 13.5524 21.7951 14.175 21.3593L16.2945 19.8756Z",fill:"#C4C4C4"})]}))}function g(e){return(0,n.jsxs)("svg",(0,l.Z)((0,a.Z)({width:"24",height:"27",viewBox:"0 0 28 32",fill:"white"},e),{children:[(0,n.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M2 26.5C2 28.433 3.567 30 5.5 30H22.5C24.433 30 26 28.433 26 26.5V10.5H19.5C18.3954 10.5 17.5 9.60457 17.5 8.5V2H5.5C3.567 2 2 3.567 2 5.5V26.5Z",fill:"#EFEFEF"}),(0,n.jsx)("path",{d:"M26 10.5L17.5 2V8.5C17.5 9.60457 18.3954 10.5 19.5 10.5H26Z",fill:"#E2E2E2"}),(0,n.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M14 13C11.2386 13 9 15.2501 9 18.0256C9 20.1019 10.0788 21.4751 11.0711 22.7383C11.4054 23.1638 11.7299 23.5768 12 24C12.515 24.8069 12.9234 25.4282 13.2332 25.8905C13.607 26.4482 14.393 26.4482 14.7668 25.8905C15.0766 25.4282 15.485 24.8069 16 24C16.2783 23.564 16.6142 23.1523 16.9591 22.7295C17.943 21.5235 19 20.228 19 18.0256C19 15.2501 16.7614 13 14 13ZM14 20C15.1046 20 16 19.1046 16 18C16 16.8954 15.1046 16 14 16C12.8954 16 12 16.8954 12 18C12 19.1046 12.8954 20 14 20Z",fill:"#C4C4C4"})]}))}var v=s(3683),b=s(27193),j=s(3142);const y=e=>{let{file:t,used:s,isPrivateInPublic:a=!1}=e;var l;return a?(0,n.jsxs)("div",{className:"flex f7 items-center",children:[(0,n.jsxs)("div",{className:"relative flex-shrink-0",children:[(0,n.jsx)(o,{mimeType:t.mimeType}),(0,n.jsx)("div",{className:"flex absolute bottom-0 br-100 bg-red justify-center items-center",style:{right:"-3px",width:14,height:14},children:(0,n.jsx)(i.Z,{className:"white","aria-label":"Private file",style:{width:14,height:14}})})]}),(0,n.jsxs)("div",{className:"ph2 overflow-x-hidden",children:[(0,n.jsx)("div",{className:"truncate pb1 fw6 dark-gray",title:t.name,children:t.name}),(0,n.jsx)("div",{className:"truncate gray lh-title",children:"Only available in private notebooks"})]})]}):(0,n.jsxs)("div",{className:"flex f7 items-center",children:[(0,n.jsxs)("div",{className:"relative flex-shrink-0",children:[(null===(l=t.mimeType)||void 0===l?void 0:l.startsWith("image/"))&&"url"in t?(0,n.jsx)("img",{src:t.url,alt:t.name,className:"br2 ba bw1 b--light-silver",style:{width:20,height:24,objectFit:"cover"}}):(0,n.jsx)(o,{mimeType:t.mimeType}),s&&(0,n.jsx)("div",{className:"flex absolute bottom-0 br-100 bg-blue justify-center items-center",style:{right:"-3px",width:14,height:14},children:(0,n.jsx)(r.Z,{className:"white","aria-label":"Private file",style:{width:14,height:14}})})]}),(0,n.jsxs)("div",{className:"ph2 overflow-x-hidden",children:["downloadUrl"in t?(0,n.jsx)("a",{className:"db truncate pb1 fw6 no-underline dark-gray hover-blue",href:t.downloadUrl,title:t.name,children:t.name}):(0,n.jsx)("div",{className:"truncate pb1 fw6 dark-gray",title:t.name,children:t.name}),(0,n.jsxs)("div",{className:"truncate gray lh-title",children:[(0,j.lL)(t)?(0,n.jsx)("span",{className:"f7 gray",children:"Local"}):s?(0,n.jsx)("span",{className:"f7 fw6 blue",children:"In use"}):(0,n.jsx)("span",{className:"f7 gray",children:"Unused"}),(0,n.jsx)("span",{className:"light-gray",children:" \u2022 "}),"size"in t?(0,n.jsxs)(n.Fragment,{children:[(0,b.BU)(t.size),(0,n.jsx)("span",{className:"light-gray",children:" \u2022 "})]}):null,(0,n.jsx)(v.q,{time:t.createTime})]})]})]})}},54137:function(e,t,s){s.d(t,{q:function(){return r}});var n=s(85893);s(67294);const r=e=>{let{text:t,matcher:s,highlightClass:r="underline"}=e;const i=[];let a=0;for(let[l,o]of s.matches(t).sort(((e,t)=>{let[s]=e,[n]=t;return s-n})))l=Math.max(a,l),o=Math.max(a,o),o>l&&(l>a&&i.push((0,n.jsx)(n.Fragment,{children:t.slice(a,l)})),i.push((0,n.jsx)("span",{className:r,children:t.slice(l,o)},l)),a=o);return i.push((0,n.jsx)(n.Fragment,{children:t.slice(a)})),(0,n.jsx)(n.Fragment,{children:i})}},30238:function(e,t,s){var n=s(41799),r=s(69396),i=s(85893);s(67294);t.Z=e=>(0,i.jsxs)("svg",(0,r.Z)((0,n.Z)({width:"16",height:"16",viewBox:"0 0 16 16",fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd"},e),{children:[(0,i.jsx)("path",{d:"M10.2929 8.29291L11.7071 9.70712L9.4142 12L11.7071 14.2929L10.2929 15.7071L6.58577 12L10.2929 8.29291Z"}),(0,i.jsx)("path",{d:"M8 11L14 11L14 13L8 13L8 11Z"}),(0,i.jsx)("path",{d:"M2 3C2 1.89543 2.89543 1 4 1H10L14 5V8H12V6H9V3H4V13H6V15H4C2.89543 15 2 14.1046 2 13V3Z"})]}))},71675:function(e,t,s){var n=s(41799),r=s(69396),i=s(85893);s(67294);t.Z=e=>(0,i.jsxs)("svg",(0,r.Z)((0,n.Z)({width:"16",height:"16",viewBox:"0 0 16 16",fill:"none"},e),{children:[(0,i.jsx)("rect",{x:"9",y:"12",width:"2",height:"10",transform:"rotate(-180 9 12)",fill:"currentColor"}),(0,i.jsx)("path",{d:"M12 9L8 13L4 9",stroke:"currentColor",strokeWidth:"2",strokeLinejoin:"round"}),e.children]}))},75872:function(e,t,s){var n=s(41799),r=s(69396),i=s(85893);s(67294);t.Z=e=>(0,i.jsxs)("svg",(0,r.Z)((0,n.Z)({width:"16",height:"16",viewBox:"0 0 16 16",fill:"none"},e),{children:[(0,i.jsx)("rect",{x:"7",y:"4",width:"2",height:"10",fill:"currentColor"}),(0,i.jsx)("path",{d:"M4 7L8 3L12 7",stroke:"currentColor",strokeWidth:"2",strokeLinejoin:"round"}),e.children]}))},46802:function(e,t,s){var n=s(41799),r=s(69396),i=s(85893);s(67294);t.Z=e=>(0,i.jsxs)("svg",(0,r.Z)((0,n.Z)({width:"16",height:"16",viewBox:"0 0 16 16",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg"},e),{children:[(0,i.jsxs)("g",{clipPath:"url(#clip0_2412_6063)",children:[(0,i.jsx)("path",{d:"M8 11.1C9.65685 11.1 10.8 9.65685 10.8 8H10C8.89543 8 8 7.10457 8 6V5C6.34315 5 5 6.34315 5 8C5 9.65685 6.34315 11.1 8 11.1Z"}),(0,i.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M2.19093 7.98979C2.46293 8.46514 3.04532 9.12944 3.94418 9.73177C5.02258 10.4544 6.4321 11 8.00001 11C9.56792 11 10.9774 10.4544 12.0558 9.73177C12.9547 9.12944 13.5371 8.46514 13.8091 7.98978C13.2086 6.84813 11.2592 5 8.00001 5C4.74085 5 2.79147 6.84813 2.19093 7.98979ZM0.151323 7.68377C0.794907 5.75302 3.59368 3 8.00001 3C12.4063 3 15.2051 5.75302 15.8487 7.68377L15.9541 8L15.8487 8.31623C15.5017 9.35714 14.4797 10.5151 13.1692 11.3932C11.8226 12.2956 10.0321 13 8.00001 13C5.96792 13 4.17744 12.2956 2.83083 11.3932C1.52032 10.5151 0.498294 9.35714 0.151323 8.31623L0.0459137 8L0.151323 7.68377Z"}),(0,i.jsx)("rect",{width:"19.578",height:"2",rx:"1",transform:"matrix(-0.707107 -0.707107 -0.707107 0.707107 15.658 14.8438)",fill:"white"}),(0,i.jsx)("rect",{width:"16.2193",height:"2",transform:"matrix(-0.707107 -0.707107 -0.707107 0.707107 15.3884 12.5742)"})]}),(0,i.jsx)("defs",{children:(0,i.jsx)("clipPath",{id:"clip0_2412_6063",children:(0,i.jsx)("rect",{width:"16",height:"16",fill:"white"})})})]}))},51517:function(e,t,s){var n=s(41799),r=s(69396),i=s(85893);s(67294);t.Z=e=>(0,i.jsxs)("svg",(0,r.Z)((0,n.Z)({width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",stroke:"currentColor"},e),{children:[(0,i.jsx)("circle",{cx:"4",cy:"3",r:"2",strokeWidth:"1.5"}),(0,i.jsx)("circle",{cx:"12",cy:"13",r:"2",strokeWidth:"1.5"}),(0,i.jsx)("path",{d:"M4 5V11C4 12.1046 4.89543 13 6 13H7",strokeWidth:"2"}),(0,i.jsx)("path",{d:"M12 11V5C12 3.89543 11.1046 3 10 3H9",strokeWidth:"2"})]}))},61777:function(e,t,s){var n=s(41799),r=s(69396),i=s(85893);s(67294);t.Z=e=>(0,i.jsx)("svg",(0,r.Z)((0,n.Z)({width:"16",height:"16",viewBox:"0 0 16 16",fill:"currentColor"},e),{children:(0,i.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M8 2.15771L3.98463 4.50001L5 5.0923L9.01537 2.75001L8 2.15771ZM11 3.90771L6.98463 6.25001L8 6.8423L12.0154 4.50001L11 3.90771ZM13 6.24104L9 8.57438V13.259L13 10.9256V6.24104ZM7 13.259V8.57438L3 6.24104V10.9256L7 13.259ZM7.24419 0.283189C7.71124 0.0107464 8.28876 0.0107473 8.75581 0.283189L14.5039 3.63623C14.8111 3.81544 15 4.14434 15 4.50001V11.2128C15 11.7463 14.7166 12.2397 14.2558 12.5085L8.50387 15.8638C8.19251 16.0454 7.80749 16.0454 7.49613 15.8638L1.74419 12.5085C1.28337 12.2397 1 11.7463 1 11.2128V4.50001C1 4.14434 1.18891 3.81544 1.49613 3.63623L7.24419 0.283189Z"})}))},26825:function(e,t,s){var n=s(41799),r=s(69396),i=s(85893);s(67294);t.Z=e=>(0,i.jsxs)("svg",(0,r.Z)((0,n.Z)({width:"16",height:"16",viewBox:"0 0 16 16",fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd"},e),{children:[(0,i.jsx)("path",{d:"M2 3C2 1.89543 2.89543 1 4 1H10L14 5V8H12V6H9V3H4V13H6V15H4C2.89543 15 2 14.1046 2 13V3Z"}),(0,i.jsx)("path",{d:"M7.3598 12.7682L8.64017 11.2318L11 13.1983L13.3598 11.2318L14.6402 12.7682L11 15.8017L7.3598 12.7682Z"}),(0,i.jsx)("path",{d:"M10 15L10 9L12 9L12 15L10 15Z"})]}))},86057:function(e,t,s){var n=s(41799),r=s(69396),i=s(85893);s(67294);t.Z=e=>(0,i.jsxs)("svg",(0,r.Z)((0,n.Z)({width:"16",height:"16",viewBox:"0 0 16 16",fill:"currentColor"},e),{children:[(0,i.jsx)("path",{d:"M8 11C9.65685 11 11 9.65685 11 8H10C8.89543 8 8 7.10457 8 6V5C6.34315 5 5 6.34315 5 8C5 9.65685 6.34315 11 8 11Z"}),(0,i.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M2.19092 7.98979C2.46291 8.46514 3.0453 9.12944 3.94417 9.73177C5.02256 10.4544 6.43208 11 7.99999 11C9.5679 11 10.9774 10.4544 12.0558 9.73177C12.9547 9.12944 13.5371 8.46514 13.8091 7.98978C13.2085 6.84813 11.2592 5 7.99999 5C4.74083 5 2.79145 6.84813 2.19092 7.98979ZM0.151308 7.68377C0.794892 5.75302 3.59366 3 7.99999 3C12.4063 3 15.2051 5.75302 15.8487 7.68377L15.9541 8L15.8487 8.31623C15.5017 9.35714 14.4797 10.5151 13.1692 11.3932C11.8226 12.2956 10.0321 13 7.99999 13C5.9679 13 4.17742 12.2956 2.83082 11.3932C1.52031 10.5151 0.498278 9.35714 0.151308 8.31623L0.0458984 8L0.151308 7.68377Z"})]}))},1099:function(e,t,s){s.d(t,{v:function(){return a}});var n=s(41799),r=s(69396),i=s(85893);s(67294);const a=e=>(0,i.jsxs)("svg",(0,r.Z)((0,n.Z)({viewBox:"0 0 16 16",width:"16",height:"16",fill:"currentColor"},e),{children:[(0,i.jsx)("circle",{r:"1.5",cy:"8",cx:"2.5"}),(0,i.jsx)("circle",{r:"1.5",cy:"8",cx:"7.5"}),(0,i.jsx)("circle",{r:"1.5",cy:"8",cx:"12.5"})]}))},93797:function(e,t,s){var n=s(41799),r=s(69396),i=s(85893);s(67294);t.Z=e=>(0,i.jsxs)("svg",(0,r.Z)((0,n.Z)({width:"16",height:"16",viewBox:"0 0 16 16",fill:"none"},e),{children:[(0,i.jsx)("path",{d:"M11 15V15C11 14.4477 10.5523 14 10 14L6 14C5.44772 14 5 14.4477 5 15V15",stroke:"currentColor",strokeWidth:"2"}),(0,i.jsx)("path",{d:"M3 3L13 3",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),(0,i.jsx)("path",{d:"M11 8.25L13 3L15 8.25C15 9.2165 14.1046 10 13 10C11.8954 10 11 9.2165 11 8.25Z",stroke:"currentColor",strokeWidth:"2",strokeLinejoin:"round"}),(0,i.jsx)("path",{d:"M1 8.25L3 3L5 8.25C5 9.2165 4.10457 10 3 10C1.89543 10 1 9.2165 1 8.25Z",stroke:"currentColor",strokeWidth:"2",strokeLinejoin:"round"}),(0,i.jsx)("path",{d:"M8 3L8 14",stroke:"currentColor",strokeWidth:"2"})]}))},26492:function(e,t,s){var n=s(41799),r=s(69396),i=s(85893);t.Z=e=>(0,i.jsxs)("svg",(0,r.Z)((0,n.Z)({width:"16",height:"16",viewBox:"0 0 16 16",fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd"},e),{children:[(0,i.jsx)("path",{d:"M3 1.75C2.30964 1.75 1.75 2.30964 1.75 3C1.75 3.69036 2.30964 4.25 3 4.25C3.69036 4.25 4.25 3.69036 4.25 3C4.25 2.30964 3.69036 1.75 3 1.75ZM0.25 3C0.25 1.48122 1.48122 0.25 3 0.25C4.51878 0.25 5.75 1.48122 5.75 3C5.75 4.51878 4.51878 5.75 3 5.75C1.48122 5.75 0.25 4.51878 0.25 3Z"}),(0,i.jsx)("path",{d:"M13 11.75C12.3096 11.75 11.75 12.3096 11.75 13C11.75 13.6904 12.3096 14.25 13 14.25C13.6904 14.25 14.25 13.6904 14.25 13C14.25 12.3096 13.6904 11.75 13 11.75ZM10.25 13C10.25 11.4812 11.4812 10.25 13 10.25C14.5188 10.25 15.75 11.4812 15.75 13C15.75 14.5188 14.5188 15.75 13 15.75C11.4812 15.75 10.25 14.5188 10.25 13Z"}),(0,i.jsx)("path",{d:"M10 12C9.44771 12 9 11.5523 9 11V5C9 3.34315 7.65685 2 6 2H5V4H6C6.55228 4 7 4.44772 7 5V11C7 12.6569 8.34315 14 10 14H11V12H10Z"})]}))},14663:function(e,t,s){var n=s(41799),r=s(69396),i=s(85893);s(67294);t.Z=e=>(0,i.jsxs)("svg",(0,r.Z)((0,n.Z)({width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinejoin:"round"},e),{children:[(0,i.jsx)("path",{d:"M2 9V5.89453C2 5.34225 2.44772 4.89453 3 4.89453H10C10.5523 4.89453 11 5.34225 11 5.89453V13.8945C11 14.4468 10.5523 14.8945 10 14.8945H8"}),(0,i.jsx)("line",{x1:"4",y1:"10",x2:"4",y2:"16"}),(0,i.jsx)("path",{d:"M5 3L5 2.00001L12 2C13.1046 2 14 2.89543 14 4V12H13"}),(0,i.jsx)("line",{x1:"7",y1:"13",x2:"1",y2:"13"}),e.children]}))},86466:function(e,t,s){var n=s(41799),r=s(69396),i=s(85893);s(67294);t.Z=e=>(0,i.jsxs)("svg",(0,r.Z)((0,n.Z)({width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",stroke:"currentColor",strokeWidth:"2"},e),{children:[(0,i.jsx)("rect",{x:"2",y:"2",width:"4",height:"12",rx:"1"}),(0,i.jsx)("rect",{x:"10",y:"2",width:"4",height:"12",rx:"1"})]}))},71066:function(e,t,s){var n=s(41799),r=s(69396),i=s(85893);s(67294);t.Z=e=>(0,i.jsxs)("svg",(0,r.Z)((0,n.Z)({width:"16",height:"16",fill:"currentColor",viewBox:"0 0 16 16"},e),{children:[(0,i.jsx)("path",{d:"M8 1h3v1l-1 1v4l2 .875V9H9v5.125L8 15l-1-.875V9H4V7.875L6 7V3L5 2V1z"}),e.children]}))},3338:function(e,t,s){s.d(t,{s:function(){return l}});var n=s(41799),r=s(69396),i=s(85893);s(67294);const a=e=>(0,i.jsxs)("svg",(0,r.Z)((0,n.Z)({width:"16",height:"16",fill:"none",stroke:"currentColor",strokeLinejoin:"round",strokeWidth:"2",viewBox:"0 0 16 16"},e),{children:[(0,i.jsx)("path",{d:"M4 12.4788V3.52116C4 2.23802 5.50646 1.54723 6.47878 2.38451L11.68 6.86335C12.375 7.46178 12.375 8.53822 11.68 9.13665L6.47878 13.6155C5.50646 14.4528 4 13.762 4 12.4788Z"}),e.children]}));t.Z=a;const l=e=>(0,i.jsx)(a,(0,n.Z)({fill:"currentColor"},e))},95024:function(e,t,s){s.d(t,{E:function(){return a}});var n=s(41799),r=s(69396),i=s(85893);const a=e=>(0,i.jsxs)("svg",(0,r.Z)((0,n.Z)({width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",stroke:"currentColor"},e),{children:[(0,i.jsx)("path",{d:"M8 9L8 3C8 2.44772 8.44772 2 9 2L11 2",strokeWidth:"2"}),(0,i.jsx)("path",{d:"M5 6L8 9L11 6",strokeWidth:"2"}),(0,i.jsx)("circle",{cx:"8",cy:"14",r:"0.5"}),(0,i.jsx)("circle",{cx:"5",cy:"14",r:"0.5"}),(0,i.jsx)("circle",{cx:"11",cy:"14",r:"0.5"})]}))},75063:function(e,t,s){s.d(t,{x:function(){return a}});var n=s(41799),r=s(69396),i=s(85893);const a=e=>(0,i.jsxs)("svg",(0,r.Z)((0,n.Z)({width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",stroke:"currentColor"},e),{children:[(0,i.jsx)("path",{d:"M8 9L8 3C8 2.44772 8.44772 2 9 2L11 2",strokeWidth:"2"}),(0,i.jsx)("path",{d:"M5 6L8 9L11 6",strokeWidth:"2"}),(0,i.jsx)("circle",{cx:"8",cy:"14",r:"0.5"})]}))},26959:function(e,t,s){var n=s(41799),r=s(69396),i=s(85893);s(67294);t.Z=e=>(0,i.jsxs)("svg",(0,r.Z)((0,n.Z)({width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",stroke:"currentColor",strokeWidth:"2"},e),{children:[(0,i.jsx)("rect",{x:"3",y:"7",width:"10",height:"7",rx:"0.5"}),(0,i.jsx)("path",{d:"M5 7.5V5C5 1.36704 9.9495 1.03365 10.8577 4"})]}))},22513:function(e,t,s){var n=s(41799),r=s(69396),i=s(85893);s(67294);t.Z=e=>(0,i.jsx)("svg",(0,r.Z)((0,n.Z)({viewBox:"0 0 16 16",width:"16",height:"16",fill:"none",strokeWidth:"1.5",strokeLinecap:"round",stroke:"currentColor"},e),{children:(0,i.jsx)("path",{d:"M6.983 2.57l-5.021 8.25a1.19 1.19 0 0 0 1.017 1.785h10.013a1.19 1.19 0 0 0 1.017-1.784L9.017 2.57a1.19 1.19 0 0 0-2.034 0zM8 5.45V8M8 10v.1"})}))},96455:function(e,t,s){s.d(t,{i:function(){return Ke}});var n=s(85893),r=s(94184),i=s.n(r),a=s(67294),l=s(40872),o=s(41799),c=s(60357),d=s.n(c),h=s(90793),u=s(64063),m=s.n(u),p=s(60486),x=s(76522),f=s(49516),g=s(69396);const v=e=>(0,n.jsxs)("svg",(0,g.Z)((0,o.Z)({width:"16",height:"16",viewBox:"0 0 16 16",fill:"none"},e),{children:[(0,n.jsx)("rect",{x:"3",y:"5",width:"10",height:"2",rx:"0.5",fill:"currentColor"}),(0,n.jsx)("path",{d:"M9 3.5C9 3.22386 9.22386 3 9.5 3H10.5C10.7761 3 11 3.22386 11 3.5V12.5C11 12.7761 10.7761 13 10.5 13H9.5C9.22386 13 9 12.7761 9 12.5V3.5Z",fill:"currentColor"}),(0,n.jsx)("path",{d:"M5 3.5C5 3.22386 5.22386 3 5.5 3H6.5C6.77614 3 7 3.22386 7 3.5V12.5C7 12.7761 6.77614 13 6.5 13H5.5C5.22386 13 5 12.7761 5 12.5V3.5Z",fill:"currentColor"}),(0,n.jsx)("rect",{x:"3",y:"9",width:"10",height:"2",rx:"0.5",fill:"currentColor"})]})),b=e=>(0,n.jsxs)("svg",(0,g.Z)((0,o.Z)({width:"16",height:"16",viewBox:"0 0 16 16",fill:"none"},e),{children:[(0,n.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M4 5C4 3.89543 4.89543 3 6 3H10C11.1046 3 12 3.89543 12 5V6.27924C12 7.1401 11.4491 7.90438 10.6325 8.17661L9 8.72076V10H7V8.72076C7 7.8599 7.55086 7.09562 8.36754 6.82339L10 6.27924V5H6V6H4V5Z",fill:"currentColor"}),(0,n.jsx)("rect",{x:"7",y:"11",width:"2",height:"2",rx:"0.5",fill:"currentColor"})]}));var j=e=>(0,n.jsx)("svg",(0,g.Z)((0,o.Z)({width:"16",height:"16",viewBox:"0 0 16 16",fill:"none"},e),{children:(0,n.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M4 4.70711C4 3.7643 4.7643 3 5.70711 3H10C11.1046 3 12 3.89543 12 5V6H10V5H6.41421L8 6.58579C8.78105 7.36683 8.78105 8.63316 8 9.41421L6.41421 11H10V10H12V11C12 12.1046 11.1046 13 10 13H5.70711C4.7643 13 4 12.2357 4 11.2929C4 10.8401 4.17986 10.4059 4.5 10.0858L6.58579 8L4.5 5.91421C4.17986 5.59407 4 5.15986 4 4.70711Z",fill:"currentColor"})})),y=s(89905),V=s(70975),w=s(48627),C=s(10718),k=s(3894),N=s(69150),Z=s(4242),L=s(29878);const M={x:{name:"X",title:"Horizontal encoding"},y:{name:"Y",title:"Vertical encoding"},color:{name:"Color",title:"Color and series encoding"},size:{name:"Size",title:"Size encoding for dot marks"},fx:{name:"Facet X",title:"Horizontal facet encoding"},fy:{name:"Facet Y",title:"Vertical facet encoding"},mark:{name:"Mark",title:"Override for automatic mark selection"}},S=["#9d5bf3","#ff57f6","#ff77a7","#ffc850","#ffff53","#adff7f","#39ffc9","#2bffff","#65a7ff","#6e40aa","#c83dac","#ff5375","#ff8c38","#c9d33a","#79f659","#28ea8d","#1eb8d0","#4775de","#4d2d77","#8c2b78","#b33a52","#b36227","#8d9429","#55ac3e","#1ca463","#158192","#32529b","#000000","#666666","#cccccc","#ffffff"];function H(e,t){const s=[];for(let n=0,r=e.length;n<r;n+=t)s.push(e.slice(n,n+t));return s}const _=["x","y","color","size"];function R(e){let{x:t,y:s,color:n,size:r}=e;return t.reduce&&s.reduce?[]:t.reduce?["y"]:s.reduce?["x"]:n.reduce||r.reduce?["x","y"]:[]}const E=()=>(0,n.jsx)("div",{className:"bb b--light-gray ma0 mb1"}),D=e=>{let{show:t}=e;return t?(0,n.jsx)(f.Z,{className:"mr1"}):(0,n.jsx)("div",{style:{width:12},className:"mr1"})},F=e=>{let{value:t,specValue:s,options:r,label:i,allowNull:a}=e;return(0,n.jsxs)(V.uf,{style:{padding:"4px 0",margin:0},children:[(0,n.jsx)("div",{className:"gray f7 ph12 mb2 mt1",children:i}),(0,n.jsx)(E,{}),a&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(V.wt,{value:"__null",className:"flex items-center justify-between ph12",children:(0,n.jsxs)("span",{className:"flex items-center flex-auto",children:[(0,n.jsx)(D,{show:"__null"===t}),"\u2014"]})},"__null"),(0,n.jsx)(E,{})]}),(0,n.jsx)(V.wt,{value:"__undefined",className:"flex items-center justify-between ph12",children:(0,n.jsxs)("span",{className:"flex items-center flex-auto justify-between",children:[(0,n.jsxs)("span",{className:"flex items-center",children:[(0,n.jsx)(D,{show:"__undefined"===t}),"Auto"]}),"__undefined"===t&&(0,n.jsx)("span",{className:"gray",children:s||"\u2014"})]})},"__undefined"),(0,n.jsx)(E,{}),r.map((e=>(0,n.jsxs)(V.wt,{value:e,className:"flex items-center ph12",children:[(0,n.jsx)(D,{show:e===t}),(0,n.jsx)("span",{className:"truncate",children:e})]},"".concat(e))))]})},I=e=>{let{options:t,onChange:s,value:r,chartSpec:a,focusedOrSelected:l}=e;r=null===r?"__null":void 0===r?"__undefined":r;const o=null===a||void 0===a?void 0:a.mark;return(0,n.jsxs)(V.vz,{onChange:s,value:r,className:i()("flex-auto bn br2 br--left chart-input","__undefined"===r?l?"bg-observable-focus-light-blue":"bg-light-silver":"bg-white"),style:{overflow:"visible"},children:[(0,n.jsxs)(V.Y4,{className:"flex items-center justify-between f6 fw5 br2 br--left",style:{margin:0},children:[(0,n.jsx)("div",{className:i()("flex items-stretch pl2","__undefined"===r?"mid-gray":""),children:"__undefined"===r?"Auto".concat(o?": ".concat(o):""):"__null"===r?"\u2014":r}),(0,n.jsx)(V.r9,{className:"inline-flex items-center pr2",children:(0,n.jsx)(x.Z,{})})]}),(0,n.jsx)(V.jI,{style:{maxHeight:"400px",overflowY:"scroll"},children:(0,n.jsx)(F,{value:r,specValue:o,options:t,label:"Mark",allowNull:!1})})]})},T=e=>{let{channel:t,options:s,onChange:r,value:a,chartSpec:l}=e;a=null===a?"__null":void 0===a?"__undefined":a;const o=l?l[t].reduce:void 0,c=l&&R(l).map((e=>l[e].value||e)).join(" and "),d=c&&o?"count"===o?"Count by ".concat(c):"".concat(o[0].toUpperCase()+o.slice(1)," of ").concat(l[t].value||"\u2013"," by ").concat(c):void 0;return(0,n.jsxs)(V.vz,{onChange:r,value:a,className:"bn br2 chart-input",style:{overflow:"visible",color:"inherit"},title:d,children:[(0,n.jsxs)(V.Y4,{className:i()("br2 flex items-center justify-between f7 fw5","__undefined"===a?"o-50":""),style:{margin:0},children:[(0,n.jsx)(j,{className:"mr1"}),("__undefined"!==a||o)&&(0,n.jsx)("div",{className:"flex items-stretch pr2 lh-solid",children:"__undefined"===a?o?"Auto: ".concat(o):"":"__null"===a?"\u2014":a}),(0,n.jsx)(V.r9,{className:"inline-flex items-center pr2",children:(0,n.jsx)(x.Z,{})})]}),(0,n.jsx)(V.jI,{style:{maxHeight:"400px",overflowY:"scroll",minWidth:180},children:(0,n.jsx)(F,{value:a,specValue:o,options:s,label:"Reducer",allowNull:!0})})]})},P={number:v,integer:v,bigint:v,string:e=>(0,n.jsxs)("svg",(0,g.Z)((0,o.Z)({width:"16",height:"16",viewBox:"0 0 16 16",fill:"none"},e),{children:[(0,n.jsx)("path",{d:"M13 4C13 3.44772 12.5523 3 12 3H10C9.44772 3 9 3.44772 9 4V7C9 7.55228 9.44772 8 10 8H13V4Z",fill:"currentColor"}),(0,n.jsx)("path",{d:"M7 4C7 3.44772 6.55228 3 6 3H4C3.44772 3 3 3.44772 3 4V7C3 7.55228 3.44772 8 4 8H7V4Z",fill:"currentColor"}),(0,n.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M5.00001 8H7.00001V9C7.00001 9.8692 6.85308 10.6012 6.37625 11.2687C5.94256 11.8759 5.28996 12.3419 4.55471 12.8321L3.44531 11.168C4.21007 10.6581 4.55747 10.3741 4.74878 10.1063C4.89694 9.89883 5.00001 9.63081 5.00001 9V8Z",fill:"currentColor"}),(0,n.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M11 8H13V9C13 9.8692 12.8531 10.6012 12.3762 11.2687C11.9426 11.8759 11.29 12.3419 10.5547 12.8321L9.44531 11.168C10.2101 10.6581 10.5575 10.3741 10.7488 10.1063C10.8969 9.89883 11 9.63081 11 9V8Z",fill:"currentColor"})]})),boolean:e=>(0,n.jsxs)("svg",(0,g.Z)((0,o.Z)({width:"16",height:"16",viewBox:"0 0 16 16",fill:"none"},e),{children:[(0,n.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M11.1652 3.00672C11.1107 3.00227 11.0556 3 11 3H5C3.89543 3 3 3.89543 3 5V11C3 12.1046 3.89543 13 5 13H11C12.1046 13 13 12.1046 13 11V6.82873L11 8.82873V11H5L5 5H9.17188L11.1652 3.00672Z",fill:"currentColor"}),(0,n.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M13.7071 4.70711L8.00001 10.4142L5.29291 7.70711L6.70712 6.29289L8.00001 7.58579L12.2929 3.29289L13.7071 4.70711Z",fill:"currentColor"})]})),date:e=>(0,n.jsxs)("svg",(0,g.Z)((0,o.Z)({width:"16",height:"16",viewBox:"0 0 16 16",fill:"none"},e),{children:[(0,n.jsx)("circle",{cx:"8",cy:"8",r:"5",stroke:"currentColor",strokeWidth:"2"}),(0,n.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M7 3H9V7.58579L10.7071 9.29289L9.29289 10.7071L7 8.41421V3Z",fill:"currentColor"})]})),object:e=>(0,n.jsxs)("svg",(0,g.Z)((0,o.Z)({width:"16",height:"16",viewBox:"0 0 16 16",fill:"none"},e),{children:[(0,n.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M2.99997 4.5C2.99997 3.67157 3.67154 3 4.49997 3H6.99997V5H4.99997V5.76393C4.99997 6.07442 4.92768 6.38065 4.78883 6.65836L3.50018 8L4.78883 9.34164C4.92768 9.61935 4.99997 9.92558 4.99997 10.2361V11H6.99997V13H4.49997C3.67154 13 2.99997 12.3284 2.99997 11.5V10.2361L2.16145 8.55902C1.98549 8.20711 1.98549 7.79289 2.16145 7.44098L2.99997 5.76393V4.5Z",fill:"currentColor"}),(0,n.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M13 4.5C13 3.67157 12.3285 3 11.5 3H9.00003V5H11V5.76393C11 6.07442 11.0723 6.38065 11.2112 6.65836L12.4998 8L11.2112 9.34164C11.0723 9.61935 11 9.92558 11 10.2361V11H9.00003V13H11.5C12.3285 13 13 12.3284 13 11.5V10.2361L13.8386 8.55902C14.0145 8.20711 14.0145 7.79289 13.8386 7.44098L13 5.76393V4.5Z",fill:"currentColor"})]})),buffer:e=>(0,n.jsxs)("svg",(0,g.Z)((0,o.Z)({width:"16",height:"16",viewBox:"0 0 16 16",fill:"none"},e),{children:[(0,n.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M6 5H5L5 11H6V5ZM5 3C3.89543 3 3 3.89543 3 5V11C3 12.1046 3.89543 13 5 13H6C7.10457 13 8 12.1046 8 11V5C8 3.89543 7.10457 3 6 3H5Z",fill:"currentColor"}),(0,n.jsx)("path",{d:"M10.374 3.08397C10.4562 3.02922 10.5527 3 10.6514 3H11.5C11.7761 3 12 3.22386 12 3.5V11H12.5C12.7761 11 13 11.2239 13 11.5V12.5C13 12.7761 12.7761 13 12.5 13H9.5C9.22386 13 9 12.7761 9 12.5V11.5C9 11.2239 9.22386 11 9.5 11H10V6H9.5C9.22386 6 9 5.77614 9 5.5V4.26759C9 4.10042 9.08355 3.9443 9.22265 3.85157L10.374 3.08397Z",fill:"currentColor"})]})),array:e=>(0,n.jsxs)("svg",(0,g.Z)((0,o.Z)({width:"16",height:"16",viewBox:"0 0 16 16",fill:"none"},e),{children:[(0,n.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M3 5C3 3.89543 3.89543 3 5 3H7V5H5V11H7V13H5C3.89543 13 3 12.1046 3 11V5Z",fill:"currentColor"}),(0,n.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M11 5H9V3H11C12.1046 3 13 3.89543 13 5V11C13 12.1046 12.1046 13 11 13H9V11H11V5Z",fill:"currentColor"})]}))},A=e=>{let{data:t,channel:s,value:r,dispatch:i,setIsExpanded:l}=e;const o=(0,C.Nq)(t,i),{isExpanded:c}=(0,h.kR)();return(0,a.useEffect)((()=>l(c)),[c,l]),(0,n.jsxs)(V.uf,{style:{padding:"4px 0",margin:0},children:[(0,n.jsx)("div",{className:"gray f7 ph12 mb2 mt1",children:"Field"}),(0,n.jsx)(E,{}),(0,n.jsx)(V.wt,{value:"__undefined",className:"flex items-center justify-between ph12",children:(0,n.jsxs)("span",{className:"flex items-center flex-auto",children:[(0,n.jsx)(D,{show:"undefined"===r.type}),"\u2014"]})},"__undefined"),(0,n.jsx)(E,{}),o?[...o].map((e=>{let[t,{type:s}]=e;var i;const a=null!==(i=P[s])&&void 0!==i?i:b;return(0,n.jsxs)(V.wt,{value:t,className:"flex items-center ph12",children:[(0,n.jsx)(D,{show:t===r.value}),(0,n.jsx)(a,{className:"moon-gray mr1 flex-shrink-0"}),(0,n.jsx)("span",{className:"truncate",children:t})]},"".concat(t))})):null,"color"===s?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"bb b--light-gray ma0 mb2"}),(0,n.jsx)("div",{className:"ph12 pt1 flex flex-wrap mb2",style:{gap:3.7},children:S.map((e=>(0,n.jsx)(V.wt,{className:"w1 h1 db ba br2 color-option",value:"__".concat(e),style:{margin:0,background:e,borderColor:"constant"===r.type&&r.value===e?"black":"rgba(0,0,0,0.3)"}},e)))})]}):null]})},O=e=>{let{id:t,data:s,channel:r,value:l,dispatch:c,focused:d,selected:h}=e;const{0:u,1:p}=(0,a.useState)("other"),{0:f,1:g}=(0,a.useState)(!1),v=(0,a.useRef)(null);function j(e){const n=(0,k.VQ)(s);if(!n)return;const i=new w.n4(n,"","chart");var a;const d=null!==(a=l.value)&&void 0!==a?a:"";i.run(c).then((s=>{const n=Array.from(s.keys()),i=n.indexOf(d);let a=-1;if(0===i&&"prev"===e||i===n.length-1&&"next"===e)return void c({type:"setChartConfig",id:t,config:{[r]:L.pG},source:"arrow"});if("undefined"===l.type?("prev"===e&&(a=n.length-1),"next"===e&&(a=0)):("prev"===e&&(a=i-1),"next"===e&&(a=i+1)),"undefined"===typeof n[a])return void console.error("index ".concat(a," does not exist"));const h=s.get(n[a]);h&&p(h.type),c({type:"setChartConfig",id:t,config:{[r]:(0,o.Z)({type:"field",value:n[a]},l.reduce&&{reduce:l.reduce})},source:"arrow"})}),(e=>{console.error("Error fetching chart schema: ",e)}))}var y;(0,a.useEffect)((()=>{v.current&&d&&"x"===r&&m()(s.config,L._4)&&v.current.focus()}),[r,s,d]),(0,a.useEffect)((()=>{const e=(0,k.VQ)(s);if(!e)return;const t=new w.n4(e,"","chart");l.value&&t.run(c).then((e=>{if(l.value){const t=e.get(l.value);t&&t.type!==u&&p(t.type)}}),(e=>{console.error("Error fetching chart schema: ",e)}))}),[l,r,s,c,u,p]);const C=null!==(y=P[u])&&void 0!==y?y:b;return(0,n.jsxs)(V.vz,{onKeyDown:e=>{if(!f)switch(e.key){case"ArrowLeft":j("prev");break;case"ArrowRight":j("next");break;case"Backspace":case"Delete":c({type:"setChartConfig",id:t,config:{[r]:L.pG},source:"clear"})}},onChange:e=>{c({type:"setChartConfig",id:t,config:{[r]:"__undefined"===e?L.pG:"__"===e.slice(0,2)?{type:"constant",value:e.slice(2)}:(0,o.Z)({type:"field",value:e},void 0!==l.reduce&&{reduce:l.reduce})},source:"dropdown"})},value:"undefined"!==l.type?"".concat(l.value):"__undefined",disabled:!l,className:i()("flex-auto bn br2 br--left",void 0===l.value?d||h?"bg-observable-focus-light-blue":"bg-light-silver":"bg-white","chart-input field-selector"),style:{overflow:"visible"},children:[(0,n.jsxs)(V.Y4,{className:"br2 br--left flex items-center justify-between f6 fw5",style:{margin:0},ref:v,title:"Arrow \u2190/\u2192 to cycle; delete to clear",children:[(0,n.jsxs)("div",{className:"flex items-center truncate",children:["undefined"!==l.type&&(0,n.jsx)(C,{className:"moon-gray mh1 db flex-shrink-0"}),"undefined"===l.type?(0,n.jsx)("div",{className:"pl2 mid-gray",children:"\u2014"}):(0,n.jsx)("div",{className:"truncate",children:l.value})]}),(0,n.jsx)(V.r9,{className:"inline-flex items-center pr2",children:(0,n.jsx)(x.Z,{})})]}),(0,n.jsx)(V.jI,{style:{maxHeight:"400px",overflowY:"scroll"},children:(0,n.jsx)(A,{data:s,channel:r,value:l,dispatch:c,setIsExpanded:g})})]})},z=e=>{let{id:t,data:s,channel:r,value:a,chartSpec:l,focused:c,selected:d,dispatch:h}=e;const u=m()(a,{type:"undefined"}),{name:x,title:f}=M[r],g=l&&R(l).includes(r),v=_.includes(r);return(0,n.jsxs)("div",{className:"ma2",children:[(0,n.jsxs)("div",{className:"mb1 pl1 flex justify-between items-center",style:{paddingRight:23},children:[(0,n.jsx)("div",{className:"ph1 fw4 f7",title:f+(g?" (grouped)":""),children:x}),v&&(0,n.jsx)(T,{channel:r,options:p.ns,value:a.reduce,chartSpec:l,onChange:e=>{h({type:"setChartConfig",id:t,config:{[r]:"__undefined"===e?(0,o.Z)({type:a.type},void 0!==a.value&&{value:a.value}):"__null"===e?{type:a.type,value:a.value,reduce:null}:{type:"constant"===a.type?"undefined":a.type,value:"constant"===a.type?void 0:a.value,reduce:e}},source:"dropdown"})}})]}),(0,n.jsxs)("div",{className:"flex items-stretch",style:{gap:1},children:["mark"===r?(0,n.jsx)(I,{options:p.Vv,value:a.value,chartSpec:l,onChange:e=>{h({type:"setChartConfig",id:t,config:{[r]:"__undefined"===e?{type:"undefined"}:{type:"constant",value:e}},source:"dropdown"})},focusedOrSelected:c||d}):(0,n.jsx)(O,{id:t,data:s,channel:r,value:a,dispatch:h,focused:c,selected:d}),(0,n.jsx)("button",{className:i()("br2 br--right chart-button flex-shrink-0 flex items-center justify-center pa0 bn",u?c||d?"bg-observable-focus-light-blue":"bg-light-silver":"pointer bg-white"),style:{width:22},disabled:u,onClick:()=>{h({type:"setChartConfig",id:t,config:{[r]:L.pG},source:"clear"})},title:"Clear",children:(0,n.jsx)(y.Z,{className:u?"o-40":""})})]})]},r)},U=e=>{let{node:t,dispatch:s,hovered:r,focused:o,selected:c}=e;const{id:h,data:u}=t,m=(0,l.Z)({},u.config),x=u.source,{0:f,1:g}=(0,a.useState)(x.name),v=(0,Z.v9)((e=>{let{notebook:{workerStatus:t}}=e;var s;return null===(s=t.get(h))||void 0===s?void 0:s.chartSpec}));return(0,a.useEffect)((()=>{f!==x.name&&(s({id:h,type:"setChartConfig",config:null,source:"toolbar"}),g(x.name))}),[x,f,s,h]),f?(0,n.jsxs)("div",{style:{margin:"0 -14px",padding:"0 2px 5px 2px",minHeight:N.T6,borderBottomLeftRadius:o||r?0:void 0},className:"jsx-f939d1f466b891fe "+(i()("br2 br--bottom",o||c?"bg-observable-focus-lightest-blue observable-focus-darker-blue":"bg-near-white mid-gray")||""),children:[(0,n.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(min(100%, ".concat(400,"px), auto))"),boxSizing:"border-box"},className:"jsx-f939d1f466b891fe",children:H(p.CH,2).map(((e,t)=>(0,n.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(".concat(200,"px, 1fr))")},className:"jsx-f939d1f466b891fe",children:[e.map((e=>(0,n.jsx)(z,{id:h,data:u,focused:o,selected:c,channel:e,value:m[e]||L.pG,chartSpec:v,dispatch:s},e))),1===e.length&&(0,n.jsx)("div",{className:"jsx-f939d1f466b891fe"})]},t)))}),(0,n.jsx)(d(),{id:"f939d1f466b891fe",children:".chart-button:focus{outline:1px solid var(--blue)}.chart-input span:focus{outline:1px solid var(--blue)}.color-option[data-current-nav]{border-color:white!important;outline:1px solid var(--mid-gray)}"})]}):null};var B=s(6016),q=s(29162),W=s(65678),G=s(42510),K=s(12447);const Y=e=>{let{node:t,dispatch:s,hovered:r,focused:l,selected:o,setOperations:c,operations:d,columnsFlash:h,setColumnsFlash:u}=e;var m,p;const{id:x}=t;var f,g;const v=(null!==(f=null===(m=d.filter)||void 0===m?void 0:m.length)&&void 0!==f?f:0)+(null!==(g=null===(p=d.sort)||void 0===p?void 0:p.length)&&void 0!==g?g:0),{0:b,1:j}=(0,a.useState)(!1),{0:y,1:V}=(0,a.useState)(!1),w=(0,K.GS)(K.ro);function C(){const e=d.sort?[...d.sort]:[];let s=[...t.data.operations.sort];return e.length>0&&t.data.operations.sort.length>0&&(s=t.data.operations.sort.filter((t=>e[0].column!==t.column))),[...e,...s]}function k(){const e=d.filter?[...d.filter]:[];let s=[...t.data.operations.filter];return e.length>0&&t.data.operations.filter.length>0&&(s=t.data.operations.filter.filter((t=>{const s=e.find((e=>{let{type:s,operands:n}=e;return n[0].value===t.operands[0].value&&s===t.type}));return s?null:t}))),[...e,...s]}return(0,n.jsxs)("div",{className:i()("flex items-stretch flex-wrap br2 br--bottom",l||o?"bg-observable-focus-lightest-blue":"bg-near-white"),style:{margin:"0 -14px",padding:"4px 6px",rowGap:2,minHeight:N.T6,borderBottomLeftRadius:l||r?0:void 0},children:[(0,n.jsx)(q.w,{id:x,flash:b,setFlash:j,mobile:w}),(0,n.jsx)(B.o,{id:x,flash:h,setFlash:u,mobile:w}),(0,n.jsx)(G.PE,{id:x,flash:y,setFlash:V,mobile:w}),(0,n.jsx)(W.p2,{id:x,mobile:w}),(0,n.jsx)("div",{children:(0,n.jsx)("button",{onClick:function(){s({type:"setDataOperations",id:x,operations:{sort:C(),filter:k()},source:"table"}),d.filter&&j(!0),d.sort&&V(!0),c({filter:void 0,sort:void 0})},className:i()("bn br2 f6 fw6 pv1 ph2 ml2 pointer",v>0?"bg-blue white":"bg-white moon-gray"),children:"Save"})})]})};var $=s(2334),X=s(1864),J=s(29157),Q=s(57003),ee=s(1099);const te=e=>(0,n.jsxs)("svg",(0,g.Z)((0,o.Z)({width:"16",height:"16",viewBox:"0 0 16 16",fill:"none"},e),{children:[(0,n.jsx)("rect",{x:"3",y:"10",width:"9",height:"2",fill:"currentColor"}),(0,n.jsx)("rect",{x:"4",y:"4",width:"9",height:"2",fill:"currentColor"}),(0,n.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M10.7071 7.29289L14.4142 11L10.7071 14.7071L9.29291 13.2929L11.5858 11L9.29291 8.70711L10.7071 7.29289Z",fill:"currentColor"}),(0,n.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M5.29288 1.29289L1.58577 5L5.29288 8.70711L6.70709 7.29289L4.4142 5L6.70709 2.70711L5.29288 1.29289Z",fill:"currentColor"})]}));var se=s(42568);const ne=e=>{let{node:t,dispatch:s,focused:r,selected:a}=e;const{id:l,data:o}=t,c=o.source,d=(0,K.GS)(K.ro),h=(0,K.GS)(K.Mo),u=m()(o.config,L._4),p="undefined"===o.config.x.type&&"undefined"===o.config.y.type,x=[{title:"Clear Chart Selections",label:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(y.Z,{className:"pr1"}),!h&&"Clear All"]}),onClick:()=>{s({id:t.id,type:"setChartConfig",config:null,source:"clearAll"})},disabled:u},{title:"Swap X and Y Dimensions",label:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(te,{className:"pr1"}),!h&&"Swap X/Y"]}),onClick:()=>{s({type:"setChartConfig",id:l,config:{x:o.config.y,y:o.config.x},source:"swap"})},disabled:p},{title:"Customize",label:d?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(Q.Z,{className:"pr1"}),"Customize"]}):(0,n.jsx)(J.l,{id:l,data:o,dispatch:s,focused:r,selected:a,narrow:h}),onClick:d?()=>{s({type:"showModal",modal:"chartCustomize",modalProps:{id:l}})}:()=>{},disabled:!1}];return c.name?d?(0,n.jsx)("div",{className:"flex align-items pr1",children:(0,n.jsx)(se.v2,{children:e=>{let{isExpanded:t}=e;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(se.j2,{className:i()("bn pointer",t?"bg-observable-focus-light-blue br2":"bg-transparent"),children:(0,n.jsx)(ee.v,{className:i()("flex align-items hover-black",t?"black":"dark-gray")})}),(0,n.jsx)(se.qy,{position:se.Ly.bottomLeft,children:x.map((e=>{let{title:t,label:s,onClick:r,disabled:i}=e;return(0,n.jsx)("div",{children:(0,n.jsx)(se.sN,{onSelect:r,disabled:i,title:t,className:"flex items-center f7 fw6",children:s})},t)}))})]})}})}):(0,n.jsx)("div",{className:"flex items-center",style:{maxHeight:N.T6-4},children:x.map((e=>{let{title:t,label:s,onClick:l,disabled:o}=e;return(0,n.jsx)("div",{children:(0,n.jsx)("button",{onClick:l,disabled:o,title:t,className:i()("flex items-center bg-transparent bn f7 fw6 ph1",h?"mr2":"mr3",o?"moon-gray":"pointer hover-black",r||a?"dark-gray":"mid-gray"),children:s})},t)}))}):null};var re=s(22027),ie=s(3338),ae=s(11233),le=s(95024),oe=s(75063),ce=s(51289),de=s(40178),he=s(72760);const ue=a.forwardRef((function(e,t){let{node:s,dispatch:r,disabled:i,autoWidth:l=!1,className:c,style:d,source:h,onSubmit:u=(()=>{}),onFocus:m}=e;const{id:p}=s,x=(0,he.u2)(s)||"",{0:f,1:g}=(0,a.useState)(x),{0:v,1:b}=(0,a.useState)(!1),j=f!==x,y=v&&""!==f&&j,V="cell ".concat(s.id);function w(e){return!(f&&!(0,he.r1)(f))&&(r({type:"setName",name:f,id:p,source:h,replaceReferences:e}),!0)}return(0,a.useEffect)((()=>g(x)),[x]),(0,n.jsxs)("div",{className:"relative flex items-stretch",children:[(0,n.jsx)(ae.Z,{value:f,"data-cy":"cell-name-input-".concat(h),spellCheck:"false",autoCorrect:"off",autoCapitalize:"none",disabled:i,className:c,style:(0,o.Z)({paddingRight:j?20:8,color:!f||(0,he.r1)(f)?void 0:"var(--red)",font:"var(--monospace-font)",textOverflow:"ellipsis",maxWidth:200,minWidth:75,width:l?"calc(".concat(j?16:0,"px + (").concat((f||V).length," * 8.5px) + (2 * var(--spacing-small)))"):(null===d||void 0===d?void 0:d.minWidth)||75},d),minimal:!0,maxLength:65536,placeholder:V,large:!1,onChange:e=>g(e.target.value.replace(/\s/g,"")),onBlur:async()=>{if(await Promise.resolve(),!w(!1))return g(x)},onKeyDown:e=>{if(b(!!e.altKey),"Enter"===e.key||("s"===e.key||"\xdf"===e.key)&&e[ce.Ao]&&!e.shiftKey){if(!w(!!e.altKey))return;if(e.preventDefault(),e.shiftKey||"s"===e.key||"\xdf"===e.key)return e.stopPropagation();u()}},onKeyUp:e=>{e.altKey||b(!1)},onFocus:m,ref:t}),j?(0,n.jsx)("button",{title:"Rename cell ".concat((0,de.Z)("Enter"),"\nAnd replace references ").concat((0,de.Z)("Alt-Enter")),className:"absolute top-0 right-0 h-100 bg-transparent bn ph1 blue hover-dark-blue flex items-center pointer squishy",onMouseDown:()=>r({type:"setName",name:f,id:p,source:"nodeToolbar",replaceReferences:y}),children:y?(0,n.jsx)(le.E,{}):(0,n.jsx)(oe.x,{})}):null]})}));var me=s(12627),pe=s(61107),xe=s(3142);const fe=e=>{let{node:t,editorState:s,hovered:r,focusedFromEditor:l}=e;const{id:o,mode:c,value:d}=t,h=d.length!==s.doc.length||d!==s.doc.toString(),{focused:u,selectionFocused:m,pending:p,readonly:x,hasTable:f}=(0,Z.v9)((e=>{let{notebook:t}=e;var s,n;return{focused:t.focusId===o,selectionFocused:t.selectionFocusId===o||t.selection.has(o),pending:"pending"===(null===(s=t.workerStatus.get(o))||void 0===s?void 0:s.status),readonly:(0,xe.os)(t),hasTable:!!(null===(n=t.heights.get(o))||void 0===n?void 0:n.display)}})),g=(0,Z.I0)(),v=(0,a.useRef)(null);return(0,a.useEffect)((()=>{var e;"table"===c&&u&&!l&&(null===(e=v.current)||void 0===e||e.focus())}),[c,u,l]),(0,n.jsxs)("div",{className:i()("pea flex justify-between items-stretch br2 bb b--white br--top",u||m?"bg-observable-focus-lightest-blue":"bg-near-white"),style:{borderTopLeftRadius:f||u||m||r?0:void 0,borderTopRightRadius:f?0:void 0,borderBottomLeftRadius:"table"===c&&(u||m||r)?0:void 0,margin:"0 -14px",padding:"table"===c?"4px 0":"2px 0",height:N.T6+("table"===c?5:1)},children:[(0,n.jsxs)("div",{className:"flex items-stretch",children:[(0,n.jsx)(ue,{node:t,dispatch:g,source:"nodeEditor",autoWidth:!0,className:"bg-transparent",style:{marginLeft:6,boxShadow:"none"},onFocus:u?void 0:e=>{g({type:"focus",id:o}),e.target.focus()},disabled:x,ref:v}),(0,n.jsx)(me.aN,{node:t})]}),(0,n.jsxs)("div",{className:"flex",children:["chart"===c&&(0,n.jsx)(ne,{node:t,dispatch:g,focused:u,selected:m}),(0,n.jsx)("button",{title:"Run cell ".concat((0,de.Z)("Shift-Enter")),className:i()("bg-transparent bn br2 f6 fw5 flex items-center pointer squishy",h?"blue hover-dark-blue":u||m?"observable-focus-dark-blue hover-blue":"moon-gray hover-mid-gray"),onMouseDown:pe.P,onClick:()=>g({type:"commit",id:o,trigger:"click",source:"nodeEditor"}),children:p?(0,n.jsx)(re.Z,{}):h?(0,n.jsx)(ie.s,{}):(0,n.jsx)(ie.Z,{})})]})]})};var ge=s(71066),ve=s(10420),be=s(14921),je=s(30883),ye=s(37497),Ve=s(71675),we=s(75872),Ce=s(23869),ke=s(46802),Ne=s(86057),Ze=s(14663),Le=s(8433),Me=s(21142),Se=s(74080),He=s(25158),_e=s(40076);const Re=a.memo((function(e){let{node:t,hasPrevious:s,hasNext:r,editorFocused:i,editorKey:l,editorMode:o,editorReadonly:c,editorSettings:d,editors:h,dirty:u,dispatch:m}=e;var p;const{id:x,data:f,pinned:g}=t,v="none"===(null===f||void 0===f||null===(p=f.display)||void 0===p?void 0:p.mode),b=(0,Z.v9)((e=>{let{notebook:t,currentUser:s}=e;return(0,Se.j5)(s,t)})),{0:j,1:V}=(0,a.useState)(0),w=(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(ye.hA,{icon:u?ie.s:ie.Z,title:"Run cell ".concat((0,de.Z)("Shift-Enter")),className:u?"blue":"",onClick:()=>{h.applyCommand(l,(0,ve.z)("click","nodeToolbar"))}}),(0,n.jsx)(ye.hA,{icon:ge.Z,title:"".concat(g?"Unpin":"Pin"," cell ").concat((0,de.Z)("Mod-.")),className:g?"blue ml2":"ml2",joinRight:!0,onClick:()=>m({type:"togglePin",id:x})}),(0,n.jsx)(ye.hA,{icon:v?ke.Z:Ne.Z,title:"".concat(v?"Show":"Hide"," output ").concat((0,de.Z)("Mod-,")),className:"ml2",joinLeft:!0,onClick:()=>m({type:"toggleDisplay",id:x})}),(0,n.jsx)(ye.hA,{icon:Ce.Z,title:"Select cell ".concat((0,de.Z)("Escape-X")),className:"ml2",onClick:()=>m({type:"selectionPromote"})}),(0,n.jsx)(ye.hA,{icon:we.Z,title:"Move cell up ".concat((0,de.Z)("Ctrl-Shift-Up")),className:"ml2",disabled:!s,joinRight:!0,onClick:()=>m({type:"moveUp",id:x})}),(0,n.jsx)(ye.hA,{icon:Ve.Z,title:"Move cell down ".concat((0,de.Z)("Ctrl-Shift-Down")),className:"ml2",disabled:!r,joinLeft:!0,onClick:()=>m({type:"moveDown",id:x})}),(0,n.jsx)(ye.hA,{icon:Ze.Z,title:"Duplicate cell ".concat((0,de.Z)("Shift-Alt-Mod-Down")),className:"ml2",onClick:e=>{m({type:"duplicate",id:x,before:e.shiftKey})}}),(0,n.jsx)(ye.hA,{icon:Le.Z,title:"Double-click to delete cell ".concat((0,de.Z)("Alt-Backspace")),className:"ml2",destructive:0!==j,text:j?"Delete?":"",onClick:e=>{j?(m({type:"remove",focusAfter:e.shiftKey,focusBefore:!e.shiftKey,id:x}),window.clearTimeout(j),V(0)):V(window.setTimeout((()=>V(0)),2500))}}),i&&_e.qz[o].toolbar.length?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"ml2 mv1 bl bw1 br2",style:{borderColor:"var(--observable-focus-light-blue)"}}),_e.qz[o].toolbar.filter((e=>!e.requiresAttachments||b)).map((e=>(0,n.jsx)(ye.hA,{"data-cy":e.name,icon:e.icon,title:e.title,joinLeft:e.joinLeft,joinRight:e.joinRight,className:"ml2",onClick:()=>{"attach"!==e.name||d.fileUploadsOn?e.onClick(l,h,x,m):d.loginToUpload&&m({type:"showModal",modal:"login",modalProps:{loginReason:"files"},trigger:"click",source:"nodeEditorToolbarAttachButton"})}},e.name)))]}):null,(0,n.jsx)("div",{className:"flex flex-grow-1"}),(0,n.jsx)(ye.hA,{icon:y.Z,title:"Blur cell ".concat((0,de.Z)("Escape")),transparent:!0,onMouseDown:e=>{e.stopPropagation()},onClick:()=>{m({type:"blur",id:x})}})]});return(0,He.t)()?(0,n.jsx)("div",{className:"pt1 pb2 near-black",style:{marginLeft:-14,marginRight:-14,minWidth:"calc(100% + 28px)",borderBottomRightRadius:"0.25rem",borderTopRightRadius:0,backgroundColor:"var(--observable-focus-lightest-blue)"},onMouseDown:e=>{e.preventDefault()},children:(0,n.jsx)("div",{className:"ph2 w-100 flex relative no-wrap overflow-y-hidden overflow-x-auto",children:w})}):(0,n.jsx)(be.h,{children:(0,n.jsx)("div",{className:"fixed left-0 right-0 bottom-0 pv2 z-1 bg-white b--silver bt near-black dn-print",onMouseDown:e=>{e.preventDefault(),h.refocus()},children:(0,n.jsx)(Me.Z,{className:"w-100",children:(0,n.jsxs)("div",{className:"flex relative",style:{marginLeft:-14,marginRight:-14},children:[(0,n.jsx)("div",{className:"absolute h-100 flex items-center pr2",style:{font:"var(--monospace-font)",right:"100%"},onMouseDown:e=>{e.stopPropagation()},children:(0,n.jsx)(ue,{node:t,source:"nodeToolbar",dispatch:m,disabled:c,style:{textAlign:"right",width:"calc(max((100vw - var(--max-width-8))/2, 0px))"}})}),w]})})})})}));var Ee=e=>{let{node:t,dirty:s,hasPrevious:r,hasNext:i,editorFocused:a,editorState:l,editors:o,dispatch:c}=e;const d=l.field(X.C);return(0,n.jsx)(Re,{node:t,hasPrevious:r,hasNext:i,editorFocused:a,editorKey:l.field($.A),editorMode:d,editorSettings:l.field(je.i),editors:o,dirty:s,dispatch:c,editorReadonly:l.readOnly})};const De=e=>{let{node:{id:t,data:{source:s}},dispatch:n}=e;const r=(0,a.useRef)();return(0,a.useEffect)((()=>{if(null===s.name)return r.current=void 0,void n({type:"sqlDialectUpdated",id:t,dialect:"sql"});const e=new w.YG(s);r.current=e,e.run(n).then((s=>{let{dialect:i}=s;e===r.current&&(i=(0,k.h8)(i),n({type:"sqlDialectUpdated",id:t,dialect:i}))}),(()=>{e===r.current&&n({type:"sqlDialectUpdated",id:t,dialect:"sql"})}))}),[n,t,s]),null};var Fe=s(73935),Ie=s(39567);var Te=e=>(0,n.jsx)("svg",(0,g.Z)((0,o.Z)({width:"16",height:"16",viewBox:"0 0 16 16",fill:"none"},e),{children:(0,n.jsx)("path",{d:"M9.25 5L6.75 8L9.25 11",stroke:"currentColor",strokeWidth:"2"})})),Pe=s(40287),Ae=s(5152);const Oe=s.n(Ae)()((()=>Promise.all([s.e(7381),s.e(9614)]).then(s.bind(s,89614))),{loadableGenerated:{webpack:()=>[89614]}}),ze=e=>{let{node:t,editors:s}=e;const{signatureHelpData:r,signatureHelpNodeId:i}=(0,Z.v9)((e=>{let{notebook:t}=e;return{signatureHelpData:t.signatureHelpData,signatureHelpNodeId:t.signatureHelpNodeId}})),l=null===r||void 0===r?void 0:r.selectedItemIndex,{0:o,1:c}=(0,a.useState)(null!==l&&void 0!==l?l:0),h=()=>s.repositionTooltips(t.id);if((0,a.useEffect)(h),(0,a.useEffect)((()=>{void 0!==l&&c(l)}),[l,c]),!(null===r||void 0===r?void 0:r.items.length)||i!==t.id||o>=r.items.length)return null;const u=r.items[o];var m;return(0,n.jsxs)("div",{style:{maxHeight:270,fontSize:"0.8125rem"},className:"jsx-208ac902b607ba5c dark-gray bg-white ba b--silver br2 shadow-4 overflow-y-auto",children:[(0,n.jsxs)("div",{className:"jsx-208ac902b607ba5c lh-copy mw6",children:[(0,n.jsx)(Ue,{item:u,argumentIndex:null!==(m=r.argumentIndex)&&void 0!==m?m:0,onReady:h}),r.items.length>1?(0,n.jsxs)("div",{onMouseDown:pe.P,className:"jsx-208ac902b607ba5c bt b--moon-gray pv2 pl2 pr3 flex items-center",children:[(0,n.jsx)(ye.hU,{style:{padding:2},disabled:o<=0,"aria-label":"Previous overload",onClick:()=>c(o-1),icon:Te}),(0,n.jsx)("span",{className:"jsx-208ac902b607ba5c mh1 tabular-nums b",children:o+1})," /",(0,n.jsx)("span",{className:"jsx-208ac902b607ba5c mh1 tabular-nums b",children:r.items.length}),(0,n.jsx)("span",{className:"jsx-208ac902b607ba5c ml1",children:"overloads"}),(0,n.jsx)(ye.hU,{style:{padding:2},disabled:o>=r.items.length-1,"aria-label":"Next overload",onClick:()=>c(o+1),icon:Pe.Z})]}):null]}),(0,n.jsx)(d(),{id:"208ac902b607ba5c",children:".tabular-nums.jsx-208ac902b607ba5c{font-variant-numeric:tabular-nums}"})]})},Ue=e=>{let{item:{prefixDisplayParts:t,parameters:s,suffixDisplayParts:r,documentation:i,tags:l},argumentIndex:o,onReady:c}=e;l=l.filter((e=>"param"!==e.name&&"returns"!==e.name));const d=s.length&&s.length>o?s[o].documentation:[];return d.length||i.length||c(),(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{className:"f7 code pv2 ph3 mt1",children:[(0,n.jsx)(Be,{parts:t}),s.map(((e,t)=>(0,n.jsxs)(a.Fragment,{children:[t>0?(0,n.jsx)("span",{children:", "}):null,(0,n.jsx)("span",{className:o===t?"b blue":"",children:(0,n.jsx)(Be,{parts:e.displayParts})})]},t))),(0,n.jsx)(Be,{parts:r})]}),d.length?(0,n.jsx)("div",{className:"bt b--silver ph3",children:d.map(((e,t)=>(0,n.jsx)(Oe,{onReady:c,children:e.text},t)))}):null,i.length?(0,n.jsx)("div",{className:"bt b--silver ph3",children:i.map(((e,t)=>(0,n.jsx)(Oe,{onReady:c,children:e.text},t)))}):null,l.length?(0,n.jsx)("div",{className:"bt b--silver pv2 ph3",children:l.map(((e,t)=>{var s;return(0,n.jsx)("div",{className:t<l.length-1?"pb1":"",children:e.text?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{children:["@",e.name]}),"link"===e.name?(0,n.jsx)("a",{rel:"ugc nofollow noreferrer",href:(0,Ie.A)(null===(s=e.text[0])||void 0===s?void 0:s.text),children:(0,n.jsx)(Be,{parts:e.text})}):(0,n.jsx)("div",{className:"example"===e.name?"code":"",children:(0,n.jsx)(Be,{parts:e.text})})]}):null},"tag-".concat(t))}))}):null]})},Be=e=>{let{parts:t,boldIndex:s}=e;return(0,n.jsx)(n.Fragment,{children:t.map(((e,t)=>(0,n.jsx)("span",{className:i()(e.kind,s===t?" b":""),children:e.text},t)))})},qe=e=>{let{node:t,editors:s,container:r}=e;return(0,Fe.createPortal)((0,n.jsx)(ze,{node:t,editors:s}),r)};var We=s(5315);const Ge=(0,s(63527).V)([[ce.Mq?"Alt-Tab":"Shift-Alt-ArrowDown",e=>{let{dispatch:t,id:s}=e;return t({type:"focusAfter",id:s}),!0}],[ce.Mq?"Shift-Alt-Tab":"Shift-Alt-ArrowUp",e=>{let{dispatch:t,id:s}=e;return t({type:"focusBefore",id:s}),!0}]]),Ke=a.memo((function(e){let{node:t,editorState:s,focused:r,hovered:l,selected:o,hasPrevious:c,hasNext:d,editors:h,compareStyle:u,operations:m,setOperations:p,columnsFlash:x,setColumnsFlash:f}=e;const{id:g,value:v,pinned:b}=t,j=s.field($.A),y=s.field(X.C),V=(0,Z.I0)(),w=(0,a.useRef)(null),C=(0,a.useRef)(null),{0:k,1:L}=(0,a.useState)(!1),{0:M,1:S}=(0,a.useState)(!1),H=(0,K.GS)(K.ro),{hasOutput:_,pending:R}=(0,Z.v9)((e=>{let{notebook:t}=e;var s;return{hasOutput:(0,We.Gv)(t.heights.get(g))>0,pending:"pending"===(null===(s=t.workerStatus.get(g))||void 0===s?void 0:s.status)}})),E=v.length!==s.doc.length||v!==s.doc.toString();return(0,a.useEffect)((()=>(C.current=H?null:document.createElement("div"),h.attach(j,w.current,C.current),()=>h.detach(j))),[h,H,j]),(0,a.useEffect)((()=>{if(!r)return;const e=w.current;function t(){L(document.hasFocus())}function s(){L(e.contains(document.activeElement))}function n(){L(!1)}return e.addEventListener("focusin",t),e.addEventListener("focusout",n),addEventListener("focus",s),addEventListener("blur",n),L(document.hasFocus()&&e.contains(document.activeElement)),()=>{e.removeEventListener("focusin",t),e.removeEventListener("focusout",n),removeEventListener("focus",s),removeEventListener("blur",n),L(!1)}}),[r]),(0,a.useEffect)((()=>{r||S(!1)}),[r]),(0,n.jsxs)("div",{className:"relative pea",onKeyDown:function(e){(0,_e.hN)(t)&&Ge({dispatch:V,id:g},e)&&(e.preventDefault(),e.stopPropagation())},children:[C.current?(0,n.jsx)(qe,{node:t,editors:h,container:C.current}):null,"sql"===t.mode&&(0,n.jsx)(De,{node:t,dispatch:V}),(0,n.jsxs)("div",{onClick:()=>{r||(S(!0),V({type:"focus",id:g}))},children:[(0,_e.sO)(t)&&(0,n.jsx)(fe,{node:t,editorState:s,hovered:l,focusedFromEditor:M}),"table"===t.mode?(0,n.jsx)(Y,{node:t,dispatch:V,hovered:l,focused:r,selected:o,operations:m,setOperations:p,columnsFlash:x,setColumnsFlash:f}):"chart"===t.mode?(0,n.jsx)(U,{node:t,dispatch:V,hovered:l,focused:r,selected:o}):null]}),(0,n.jsxs)("div",{ref:w,className:i()(l&&"node-hover",s.readOnly&&"node-readonly",r&&"node-focus",o&&"node-select",r||o||"add"!==u?"":" node-add","sql"===y&&"node-toolbar","relative",(0,_e.hN)(t)&&"dn"),children:[!("sql"===y||"table"===y)&&(0,n.jsx)("button",{title:"Run cell ".concat((0,de.Z)("Shift-Enter")),className:i()("flex items-center absolute top-0 bg-transparent bn br2 pointer squishy",E?"blue hover-dark-blue":r||o?"observable-focus-dark-blue hover-blue":"moon-gray hover-mid-gray","dn-print"),onMouseDown:pe.P,onClick:()=>h.applyCommand(j,(0,ve.z)("click","nodeEditor")),style:{right:-14,height:N.T6},children:R?(0,n.jsx)(re.Z,{}):E?(0,n.jsx)(ie.s,{}):(0,n.jsx)(ie.Z,{})}),r&&!s.readOnly&&(0,n.jsx)(Ee,{node:t,dirty:E,editorFocused:k,editorState:s,editors:h,hasPrevious:c,hasNext:d,dispatch:V})]}),(l||r)&&_&&(0,n.jsx)("div",{className:"flex absolute moon-gray",style:{top:4,left:-55},children:(0,n.jsx)(ge.Z,{className:i()(s.readOnly?"":"pointer","squishy",b&&!s.readOnly?"blue":"hover-mid-gray"),role:"button","aria-label":b?"Unpin":"Pin",onMouseDown:pe.P,onClick:()=>s.readOnly?void 0:V({type:"togglePin",id:g}),style:{padding:"3px 0 2px 0"},children:(0,n.jsxs)("title",{children:[b?"Unpin":"Pin"," cell ",(0,de.Z)("Mod-.")]})})})]})}))},93177:function(e,t,s){s.d(t,{a:function(){return Dt}});var n=s(85893),r=s(94184),i=s.n(r),a=s(67294),l=s(94726),o=s(47311),c=s(8385),d=s(63231),h=s(8433),u=s(3683),m=s(37497),p=s(1099),x=s(22513),f=s(84193),g=s(42568),v=s(56367),b=s(45578),j=s(74080),y=s(27193),V=s(66421),w=s(3142),C=s(36448);const k=e=>{let{notebook:t,dispatch:s,comment:r,currentUser:a,first:l,repeated:o}=e;const k=(0,V.Ss)(r,a,t),N=a&&!(0,w.ws)(t),Z=(0,V.O4)(r,a),{create_time:L,update_time:M,content:S,user:H}=r,_=(0,w.tO)(r)?"comment-local-".concat(r.nonce):"comment-".concat(r.id),R=o?null:(0,n.jsx)(f.Z,{href:(0,C.GN)(H),children:(0,n.jsxs)("a",{className:"flex truncate no-underline dark-gray hover-blue items-center mr2",children:[(0,n.jsx)(c.q,{user:H,size:24,className:"mr2 br-100"}),(0,n.jsx)("span",{className:"truncate fw5",children:(0,y.KY)(H)})]})}),E=k||Z||N&&!(0,w.tO)(r);return(0,n.jsxs)("div",{id:_,"data-cy":"comment",className:i()("pv2 hide-child",l||o?"":"bt b--light-gray"),children:[(0,n.jsxs)("div",{className:"flex pb1 items-center justify-between lh-title",children:[(0,n.jsxs)("div",{className:"flex items-center min-w-0",children:[o?null:(0,n.jsx)(b.Gz,{owner:H,children:R}),(0,w.tO)(r)?null:(0,n.jsxs)("a",{className:"mid-gray no-underline nowrap",href:"#".concat(_),children:[(0,n.jsx)(u.q,{time:L}),M&&" (edited)"]})]}),(0,n.jsxs)(g.v2,{children:[(0,n.jsx)(m.hU,{title:"Comment actions",className:E?"":"o-0",colorless:!0,disabled:!E,icon:p.v,asMenuButton:!0}),(0,n.jsxs)(g.qy,{"data-testid":"comment-actions",children:[Z&&(0,n.jsxs)(g.sN,{"data-cy":"update-comment",onSelect:()=>{(0,w.tO)(r)||s({type:"updateCommentStatus",nodeId:r.node_id,status:"updateInitiated",commentId:r.id})},children:[(0,n.jsx)(d.Z,{className:"w1 mr2"}),"Edit"]}),k&&(0,n.jsxs)(g.sN,{"data-cy":"delete-comment",className:"hover-dark-red hover-bg-washed-red",disabled:!(0,j.id)(r),onSelect:()=>{s({type:"showModal",modal:"deleteComment",modalProps:{comment:r}})},children:[(0,n.jsx)(h.Z,{className:"w1 mr2"}),"Delete"]}),N&&!(0,w.tO)(r)&&(0,n.jsxs)(g.sN,{"data-cy":"report-comment",onSelect:()=>{s({type:"showModal",modal:"reportAbuse",modalProps:{comment:r}})},children:[(0,n.jsx)(x.Z,{className:"w1 mr2"}),"Report spam or abuse"]})]})]})]}),(0,n.jsx)("div",{className:"overflow-x-hidden break-word pre-wrap",children:(0,n.jsx)(v.R,{content:S})})]})},N=e=>{let{children:t}=e;return(0,n.jsxs)("span",{className:"relative-ns v-mid disappear-child",style:{lineHeight:0},children:[(0,n.jsx)("span",{className:"dib ml2 f7 fw6 tc mid-gray hover-dark-gray bg-white ba b--silver br-pill hover-b--light-silver pointer",style:{width:"1.1rem",height:"1.1rem",lineHeight:"1.15rem"},children:"?"}),(0,n.jsx)("nav",{className:"db absolute tl lh-solid z-3 child",style:{right:"-11px",width:"16rem"},"aria-label":"submenu","aria-hidden":!open,children:(0,n.jsx)("div",{className:"f7 white bg-black br2 overflow-hidden",style:{marginTop:"7px"},children:(0,n.jsx)("div",{className:"ph2 pv1 lh-copy",children:t})})})]})},Z=e=>{let{notebookAccessText:t,isUpdatingComment:s=!1}=e;const r="You are ".concat(s?"editing comments":"commenting"," on a ").concat(t.toLowerCase()," notebook.");return(0,n.jsxs)("div",{className:"inline-flex items-center",children:[(0,n.jsx)("div",{className:"db-ns dn mr2 f7 mid-gray",children:r}),(0,n.jsxs)(N,{children:[(0,n.jsxs)("span",{className:"dn-ns di",children:[r," "]}),"Your comment will be visible to anyone who can read this notebook."]})]})};function L(e){e.style.height="auto",e.style.height="".concat(e.scrollHeight,"px")}const M=e=>{let{nodeId:t,notebook:s,currentUser:r,dispatch:l,comment:o,isUpdatingComment:c,first:d}=e;const{0:h,1:u}=(0,a.useState)((null===o||void 0===o?void 0:o.content)||""),p=(0,a.useRef)(null),x=(0,a.useCallback)((e=>{L(p.current),u(e.target.value)}),[p]);(0,a.useEffect)((()=>{const{current:e}=p;if(h&&e){const t=h.length;e.setSelectionRange(t,t),L(e)}}),[]);const f=(0,a.useCallback)((e=>{l(o?{type:"updateCommentStatus",status:"unresolved",nodeId:o.node_id,commentId:o.id}:{type:"commentComposeCancel",nodeId:t,trigger:e,content:h.trim(),source:"commentCompose"})}),[t,l,h,o]),g=(0,a.useCallback)(((e,n)=>{e.preventDefault();const i=h.trim();i&&(l({type:"commentCreated",nodeId:t,content:i,trigger:n,currentUser:r,source:"commentCompose"}),"default"===s.subscriptionState&&l({type:"updateSubscription",status:"comments"}),u(""))}),[t,h,r,u,l,s.subscriptionState]),v=(0,a.useCallback)(((e,s)=>{e.preventDefault();const n=h.trim();n&&o&&l({type:"updateComment",nodeId:t,content:n,trigger:s,source:"commentCompose",commentId:o.id})}),[t,h,l,o]),b=(0,a.useCallback)((e=>{"Enter"===e.key&&(e.metaKey||e.ctrlKey)?c?v(e,"keypress"):g(e,"keypress"):"Escape"!==e.key||h.trim()&&!c||f("keypress")}),[f,g,v,c,h]),j=(0,w.OA)(r)?"true":"false";return(0,n.jsxs)("form",{onSubmit:e=>c?v(e,"click"):g(e,"click"),className:i()("flex relative flex-column items-stretch mt",{bt:!d}),style:{borderColor:"#e6e2d4"},children:[(0,n.jsx)("textarea",{className:"w-100 ph0 pv3 sans-serif f6 dark-gray br3 lh-f6 bg-transparent bn",style:{resize:"none"},onKeyDown:b,autoFocus:!0,rows:1,ref:p,value:h,name:"comment_description",placeholder:"",maxLength:65536,onChange:x,spellCheck:j}),(0,n.jsxs)("div",{className:"flex pv2 justify-between",children:[(0,n.jsx)(Z,{notebookAccessText:(0,w.wF)(s),isUpdatingComment:!!c}),(0,n.jsxs)(m.CQ,{children:[(0,n.jsx)(m.kq,{text:"Cancel",onClick:()=>f("click")}),(0,n.jsx)(m.KM,{type:"submit",text:c?"Save":"Comment",disabled:!h.trim()||c&&h===(null===o||void 0===o?void 0:o.content)})]})]})]})};var S=s(40287),H=s(41799),_=s(69396);var R=e=>(0,n.jsx)("svg",(0,_.Z)((0,H.Z)({width:"8",height:"16",viewBox:"0 0 8 16",fill:"none"},e),{children:(0,n.jsx)("path",{d:"M1 9.5L4 7L7 9.5",stroke:"currentColor",strokeWidth:"1.8"})}));const E=e=>{let{numResolved:t,numUnresolved:s,expanded:r,onToggle:a}=e;return(0,n.jsx)("div",{className:i()("flex nl2 nr2",s?"bb":"","b--light-gray"),children:(0,n.jsxs)("button",{type:"button",onClick:a,className:"inline-flex w-100 pa2 f6 mid-gray bg-transparent i pointer bn",children:[r?(0,n.jsx)(R,{className:"mr2"}):(0,n.jsx)(S.Z,{className:"mr2"}),t>1?"".concat(t," resolved comments"):"1 resolved comment"]})})};var D=s(69150),F=s(88725),I=s(4242);function T(e,t,s,r){return e.map(((i,a)=>"updateInitiated"===i.status?(0,n.jsx)(M,{nodeId:i.node_id,notebook:s,currentUser:t,comment:i,isUpdatingComment:!0,dispatch:r,first:0===a},"remote-".concat(i.id)):(0,n.jsx)(k,{currentUser:t,notebook:s,dispatch:r,comment:i,first:0===a,repeated:a>0&&e[a].user.id===e[a-1].user.id},(0,w.tO)(i)?"local-".concat(i.nonce):"remote-".concat(i.id))))}var P=(0,I.$j)(((e,t)=>{let{notebook:s,currentUser:n}=e;return{resolvedComments:(0,F.o7)(s,t.nodeId),unresolvedComments:(0,F.HS)(s,t.nodeId),notebook:s,currentUser:n}}),(e=>({dispatch:e})))((e=>{let{nodeId:t,notebook:s,currentUser:r,resolvedComments:a,unresolvedComments:c,dispatch:d}=e;if(!s.openComments.has(t)||!(0,j.H7)(s))return null;const h=(0,V.f$)(s)&&c.length>0,u=s.composingComments.has(t),p=s.expandedResolvedComments.has(t);return(0,n.jsx)("div",{className:"relative pea sans-serif f6 lh-f6 dark-gray",style:{paddingTop:"0.75rem"},children:(0,n.jsxs)("div",{className:"bg-washed-yellow",style:{maxWidth:640+2*D.Mv,marginLeft:-D.Mv,marginRight:-D.Mv,paddingLeft:D.Mv,paddingRight:D.Mv},children:[p&&T(a,r,s,d),a.length>0&&(0,n.jsx)(E,{numResolved:a.length,numUnresolved:c.length,expanded:p,onToggle:function(){d({type:"toggleResolvedComments",nodeId:t,trigger:"click",source:"commentBox"})}}),T(c,r,s,d),u?(0,n.jsx)(M,{nodeId:t,notebook:s,dispatch:d,currentUser:r,first:c.length+a.length===0}):(0,n.jsxs)("div",{className:i()("flex","justify-".concat(h?"between":"end"),"bg-washed-yellow pb2"),children:[h&&(0,n.jsx)(m.sn,{onClick:function(){d({type:"resolveComments",nodeId:t,trigger:"click",source:"commentBox"})},disabled:!c.every((e=>(0,j.Lj)(e))),text:"Resolve",className:"mr2"}),(0,w.fC)(s)&&!(0,V.RF)(s)?(0,n.jsx)("div",{className:"inline-flex ph2 nr2 pt1 pb3 f6 dark-gray items-center",children:(0,n.jsx)(l.h,{commentingLock:s.commentingLock})}):(0,n.jsx)(m.sn,{icon:o.ZP,text:"Comment",onClick:function(){(0,V.RF)(s)?d({type:"commentComposeOpen",nodeId:t,trigger:"click",source:"commentBox"}):r||d({type:"showModal",modal:"login",modalProps:{loginReason:"comment"},trigger:"click",source:"comment"})}})]})]})})}));var A=e=>{let{id:t,dispatch:s}=e;return(0,n.jsx)("button",{title:"Jump to error",onClick:()=>s({type:"focusError",id:t}),className:"absolute pv1 ph2 bg-near-white red f7 fw5 bn br3 pointer pea",style:{top:-28,right:-14},children:"Jump to error"})},O=s(60357),z=s.n(O);var U=e=>(0,n.jsxs)("svg",(0,_.Z)((0,H.Z)({width:"16",height:"16",viewBox:"0 0 16 16",fill:"none"},e),{children:[(0,n.jsx)("rect",{x:"5",y:"7",width:"6",height:"2",rx:"1",fill:"currentColor"}),(0,n.jsx)("rect",{x:"3",y:"3",width:"10",height:"10",rx:"1",stroke:"currentColor",strokeWidth:"2"})]})),B=s(34091),q=s(26959),W=s(33042),G=s(72760),K=s(56912),Y=s(928),$=s(34318);const X=(0,I.$j)((e=>{let{notebook:t}=e;return{notebook:t}}),(e=>({dispatch:e})))((e=>{let{id:t,notebook:s,dispatch:r}=e;const l=(0,W.DY)(s.model,t),o=(0,G.Qc)(l).body.source.value,c=(0,K.uF)(s),d=(0,K.uF)(s,{ignoreResolutions:!0}),h=(0,a.useMemo)((()=>{if(!c||!d)return;const{directImports:e}=(0,K.$r)(c);return(0,K.ng)(d.specifiers,e,s.model.resolutions).get(o)}),[o,c,d,s.model.resolutions]);if(!h)return null;const u=(0,K.xT)(null===c||void 0===c?void 0:c.specifiers[o]);return Y.Z.parse(o)&&(0,$.qU)(l)?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("button",{title:"".concat(h.updatesAvailable?"Updates available. ":"").concat("locked"===h.lockStatus?"This import and all of its dependencies are locked.":"unlocked"===h.lockStatus?"This import and all of its dependencies are unlocked, so the latest version will always be imported.":"Not all of this import's dependencies are locked."," Click to open the Dependencies pane and manage versions."),onClick:()=>{r({type:"showNotebookDependencyDetails",updatesAvailable:h.updatesAvailable,status:h.lockStatus,specifier:o})},className:z().dynamic([["216e23a914626b64",[u?"color: var(--white)":"",h.updatesAvailable?"background-color: var(--observable-focus-light-blue)":"",u?"background-color: var(--red)":"",u?"color: var(--white)":"",u?"background-color: var(--red);":""]]])+" "+(i()(h.updatesAvailable?"has-updates ":"","lock-status absolute hover-mid-gray pv1 ph2 bg-near-white f7 fw5 bn gray br4 pointer flex items-center align-center pea")||""),children:"locked"===h.lockStatus?(0,n.jsx)(B.Z,{}):"unlocked"===h.lockStatus?(0,n.jsx)(q.Z,{}):(0,n.jsx)(U,{})}),(0,n.jsx)(z(),{id:"216e23a914626b64",dynamic:[u?"color: var(--white)":"",h.updatesAvailable?"background-color: var(--observable-focus-light-blue)":"",u?"background-color: var(--red)":"",u?"color: var(--white)":"",u?"background-color: var(--red);":""],children:".lock-status.__jsx-style-dynamic-selector{padding-left:10px;padding-right:10px;top:-28px;right:-14px;color:var(--observable-focus-dark-blue);".concat(u?"color: var(--white)":"",";").concat(h.updatesAvailable?"background-color: var(--observable-focus-light-blue)":"",";").concat(u?"background-color: var(--red)":"",";}.lock-status.__jsx-style-dynamic-selector:hover{color:var(--mid-gray);").concat(u?"color: var(--white)":"",';}.has-updates.__jsx-style-dynamic-selector::after{content:"";position:absolute;top:0;right:0;width:7px;height:7px;background-color:var(--observable-focus-dark-blue);').concat(u?"background-color: var(--red);":"",";-webkit-border-radius:3.5px;-moz-border-radius:3.5px;border-radius:3.5px}")})]}):null}));var J=s(86253),Q=s(54667),ee=s(33494),te=s(5315),se=s(40076);const ne=e=>{let{node:t,editorState:s,focused:r,selected:l,selectionFocused:o,editorOpen:c,workerHeight:d,editors:h,hovered:u,hasPrevious:m,hasNext:p,editorComponent:x}=e;var f;const g=(0,I.I0)(),v=(0,a.useRef)(null),b=(0,a.useRef)(null),j=(0,a.useRef)(null),y=(0,a.useRef)(null),{id:V}=t,w=(0,G.u2)(t),C=(0,I.v9)((e=>{let{notebook:t}=e;var s,n;return null===(s=t.workerStatus.get(V))||void 0===s||null===(n=s.display)||void 0===n?void 0:n.mode})),{jumpToError:k}=s.field(Q.ei).find((e=>{let{jumpToError:t}=e;return t}))||{},{0:N,1:Z}=(0,a.useState)({filter:void 0,sort:void 0}),{0:L,1:M}=(0,a.useState)(!1);return(0,a.useEffect)((()=>{const e=(0,te.jn)(b.current,V,"editor",g),t=(0,te.jn)(j.current,V,"comments",g),s=(0,te.jn)(y.current,V,"display",g);return()=>{e.disconnect(),t.disconnect(),s.disconnect()}}),[V,g]),(0,a.useEffect)((()=>{o&&(0,ee.zT)(v.current)}),[o]),(0,n.jsxs)("div",{ref:v,className:i()("relative node pen",u||r?"node-hover":""),"data-node-id":V,id:w||void 0,style:{marginTop:D.KI,marginBottom:D.KI,paddingTop:d},onMouseEnter:()=>g({type:"hover",id:V}),children:[l||o?(0,n.jsx)("div",{className:"absolute br2 z-1",style:{top:1,left:-13,right:-13,bottom:1,boxShadow:l&&o?"0px 0px 0px 2px var(--lightest-blue), 0px 0px 0px 4px var(--faint-blue)":l?"0px 0px 0px 2px var(--washed-blue)":"0px 0px 0px 2px var(--lightest-blue)"}}):null,(0,n.jsx)("div",{ref:y,children:(0,se.kk)(t)&&"table"===C&&(0,n.jsx)(J.V,{node:t,operations:N,setOperations:Z,setColumnsFlash:M})}),(0,n.jsxs)("div",{ref:b,className:"relative",children:[k?(0,n.jsx)(A,{dispatch:g,id:V}):"ImportDeclaration"===(null===(f=(0,G.Qc)(t).body)||void 0===f?void 0:f.type)?(0,n.jsx)(X,{id:V}):null,c&&(0,n.jsx)(x,{node:t,editorState:s,focused:r,hovered:u,selected:l||o,editors:h,hasPrevious:m,hasNext:p,operations:N,setOperations:Z,columnsFlash:L,setColumnsFlash:M})]}),(0,n.jsx)("div",{ref:j,children:(0,n.jsx)(P,{nodeId:V})})]})};var re=()=>(0,n.jsx)("div",{className:"absolute w-100 bt b--blue",style:{marginTop:Math.floor(-D.KI/2)}}),ie=s(99534),ae=s(95357);var le=(0,I.$j)((e=>{let{notebook:t}=e;return{isCommentable:(0,j.H7)(t)}}),(e=>({dispatch:e})))((e=>{var{dispatch:t,canComment:s,commentCount:r,isCommentsOpen:a,node:l,isCommentable:c,className:d=""}=e,h=(0,ie.Z)(e,["dispatch","canComment","commentCount","isCommentsOpen","node","isCommentable","className"]);if(!c)return null;const u=a?"Hide comments":r>0?"Show ".concat((0,w.YY)(r,"comment")):"Add comment",m=a?"blue":"";return(0,n.jsxs)("button",(0,_.Z)((0,H.Z)({onClick:e=>{e.stopPropagation(),t(r>0||s?{type:r>0?a?"hideComments":"showComments":"commentComposeOpen",nodeId:l.id,trigger:"click",source:"nodeGutterMenu"}:{type:"showModal",modal:"login",modalProps:{loginReason:"comment"},trigger:"click",source:"comment"})},title:u,"aria-label":u,className:i()("flex items-center sans-serif f6 pointer pa0 hover-mid-gray moon-gray bg-transparent bn no-wrap",d)},h),{children:[r>0?(0,n.jsx)("span",{className:"pr1 ".concat(m),children:r>=9?"9+":r}):(0,n.jsx)(o.GL,{className:m}),(0,n.jsx)(ae.Z,{className:m})]}))})),oe=s(60803),ce=s(952),de=s(49516),he=s(12447);const ue=e=>{let{dispatch:t,mode:s,id:r,disabled:i}=e;return(0,n.jsx)(n.Fragment,{children:Object.entries(se.qz).filter((e=>{let[,{convertible:t}]=e;return t})).map((e=>{let[a,{label:l,icon:o}]=e;const c=s===a;return(0,n.jsxs)(g.sN,{disabled:i,"aria-label":"editor-menu-".concat(l),className:c?"blue":"dark-gray hover-black",onSelect:()=>{t({type:"setMode",id:r,source:"gutterMenu",trigger:"click",mode:a})},children:[(0,n.jsx)("span",{className:"w1 h1 mr1",children:(0,n.jsx)(o,{})}),l,c&&(0,n.jsx)(de.Z,{className:"ml1"})]},a)}))})};var me=(0,I.$j)((()=>({})),(e=>({dispatch:e})))((e=>{var{dispatch:t,node:s,mode:r,focused:a,selected:l,hovered:o,className:c="",readOnly:d,children:h}=e,u=(0,ie.Z)(e,["dispatch","node","mode","focused","selected","hovered","className","readOnly","children"]);const{id:m}=s,{convertible:p}=se.qz[r],{className:x,styles:f}={styles:(0,n.jsx)(z(),{id:"b5651deb920f0506",dynamic:[he.pp],children:"@media ".concat(he.pp,"{*.__jsx-style-dynamic-selector{-webkit-border-bottom-left-radius:var(--border-radius-2);-moz-border-radius-bottomleft:var(--border-radius-2);border-bottom-left-radius:var(--border-radius-2)}}")}),className:z().dynamic([["b5651deb920f0506",[he.pp]]])};return(0,n.jsx)(g.v2,{children:e=>{let{isExpanded:s}=e;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(g.j2,(0,_.Z)((0,H.Z)({title:"".concat(se.qz[r].label).concat(p?"\nClick to set language":""),className:i()(a||l&&o?"observable-focus-dark-blue":l?"washed-blue":s?"dark-gray":o?"gray":"moon-gray",p?a||l?"pointer hover-blue":o?"pointer hover-mid-gray":"pointer":"",a||l&&o?"bg-observable-focus-light-blue":o?"bg-light-silver":"bg-transparent",x,c,"bn pa0"),disabled:!p},u),{children:[h,f]})),(0,n.jsx)(g.qy,{position:g.Ly.right,children:(0,n.jsx)(ue,{dispatch:t,id:m,mode:r,disabled:d})})]})}})})),pe=s(48634),xe=s(14921),fe=s(23869),ge=s(64804),ve=s(61777),be=s(26825),je=s(92946),ye=s(14663),Ve=s(71066),we=s(89905),Ce=s(3961);class ke extends Ce.i{async process(e){const t=await e({type:"request_download_type",node_id:this._id});return{type:Ne(t.type),typeAsView:Ne(t.typeAsView)}}constructor(e){super(),this._id=e}}function Ne(e){return e?"blob"===e.type?{type:"blob",mime:"".concat(e.mime)}:{type:"".concat(e.type)}:void 0}class Ze extends Ce.i{async process(e){return await e({type:"request_download",node_id:this._id,as_view:this._asView,download_type:this._type,format:this._format})}constructor(e,t,s,n){super(),this._id=e,this._asView=t,this._type=s,this._format=n}}var Le=s(35053),Me=s(87099);const Se=e=>{var{commentCount:t,editorOpen:s,editable:r,focused:l,readOnly:o,selected:c,hovered:h,commentable:u,node:m,className:p="",children:x}=e,f=(0,ie.Z)(e,["commentCount","editorOpen","editable","focused","readOnly","selected","hovered","commentable","node","className","children"]);const{id:v,pinned:b,mode:j}=m,y=(0,G.u2)(m),C=(0,I.I0)(),{hasOutput:k,isNodeUnsaved:N,isCommentingLocked:Z,isCommentsOpen:L,isComposeOpen:M,canComment:S,notebookSpecifier:R,deletable:E}=(0,I.v9)((e=>{let{notebook:t}=e;return{hasOutput:(0,te.Gv)(t.heights.get(v))>0,isNodeUnsaved:v>t.saveVersion,isCommentingLocked:(0,w.fC)(t),isCommentsOpen:t.openComments.has(m.id),isComposeOpen:t.composingComments.has(m.id),canComment:(0,V.RF)(t),notebookSpecifier:(0,w.J6)(t),deletable:t.model.nodes.length>1}})),D=(0,a.useRef)(null),F=(0,a.useRef)(!1),[T]=(0,Le._)(v,D,F,r,o,C,"node","notebook");async function P(e,t,s){let n;try{n=await new Ze(v,e,t,s).run(C)}catch(r){return void C({type:"showErrorToast",message:"Unable to download.",key:"download"})}(0,Me.L)(n,"".concat(y||"untitled").concat(s?".".concat(s):""))}function A(){C({type:l?"blur":"focus",id:v})}let O,U="";function B(){C(O)}t?L?(U="Hide ".concat((0,w.xC)(t,"comment")),O={type:"hideComments",nodeId:v,trigger:"click",source:"nodeGutterMenu"}):(U="Show ".concat((0,w.YY)(t,"comment")),O={type:"showComments",nodeId:v,trigger:"click",source:"nodeGutterMenu"}):M?(U="Cancel comment",O={type:"commentComposeCancel",nodeId:v,content:"",trigger:"click",source:"nodeGutterMenu"}):S?(U="Add comment",O={type:"commentComposeOpen",nodeId:v,trigger:"click",source:"nodeGutterMenu"}):(U="Add comment",O={type:"showModal",modal:"login",modalProps:{loginReason:"comment"},trigger:"click",source:"comment"});const q=r?"Click for cell actions\nDrag to move cell":"Click to comment",{className:W,styles:K}={styles:(0,n.jsx)(z(),{id:"d11f5349d80c66de",dynamic:[he.pp,s&&k?0:"var(--border-radius-2)"],children:"*.__jsx-style-dynamic-selector{will-change:transform;cursor:-webkit-grab;cursor:-moz-grab;cursor:grab}@media ".concat(he.pp,"{*.__jsx-style-dynamic-selector{-webkit-border-top-left-radius:var(--border-radius-2);-moz-border-radius-topleft:var(--border-radius-2);border-top-left-radius:var(--border-radius-2);-webkit-border-bottom-left-radius:").concat(s&&k?0:"var(--border-radius-2)",";-moz-border-radius-bottomleft:").concat(s&&k?0:"var(--border-radius-2)",";border-bottom-left-radius:").concat(s&&k?0:"var(--border-radius-2)","}}")}),className:z().dynamic([["d11f5349d80c66de",[he.pp,s&&k?0:"var(--border-radius-2)"]]])},Y=r&&!!y,$=r&&!s&&!b,X=r&&!b&&k,J=r&&k&&!o,Q=r&&!o,ee=r,ne=r,re=r,le=!o,oe=r&&E&&!o,ce=u&&(t>0||S||!Z)&&!o,de=r&&(0,G.q8)(m),me=!k&&se.qz[m.mode].convertible&&!o;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(g.v2,{children:e=>{let{isExpanded:t}=e;return F.current=t,(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(g.j2,(0,_.Z)((0,H.Z)({ref:D,title:q,"aria-label":q,className:i()(l||c&&h?"observable-focus-dark-blue":c?"washed-blue":t?"dark-gray":h?"gray":"moon-gray",l||c?"hover-blue":h?"hover-mid-gray":"",l||c&&h?"bg-observable-focus-light-blue":h?"bg-light-silver":"bg-transparent",!(l||h||!k||t)&&"dn",W,p,"bn pa0")},f),{children:[x,K]})),(0,n.jsxs)(g.qy,{position:g.Ly.right,children:[Y?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(g.Uk,{href:"#".concat(y),children:(0,n.jsx)("div",{className:"mw5 code f7 fw5 hover-blue",children:y})}),(0,n.jsx)(g.R,{})]}):null,$?(0,n.jsxs)(g.sN,{onSelect:A,children:[(0,n.jsx)(d.Z,{className:"w1 h1 mr1"}),"Edit"]}):X?(0,n.jsxs)(g.sN,{onSelect:A,children:[(0,n.jsx)(we.Z,{className:"w1 h1 mr1"}),"Close"]}):null,J&&(0,n.jsxs)(g.sN,{onSelect:()=>C({type:"togglePin",id:v}),children:[(0,n.jsx)(Ve.Z,{className:"w1 h1 mr1","aria-label":b?"Unpin":"Pin"}),b?"Unpin":"Pin"]}),ce&&(0,n.jsxs)(g.sN,{onSelect:B,"aria-label":U,disabled:N,title:N?"Fork this notebook to comment on this cell":void 0,children:[(0,n.jsx)(ae.Z,{className:"w1 h1 mr1"}),U]}),de&&(0,n.jsxs)(g.sN,{title:"Copy the code to import this cell",onSelect:async()=>{await navigator.clipboard.writeText(function(e,t){const{body:s}=(0,G.Qc)(e);if("ImportDeclaration"===(null===s||void 0===s?void 0:s.type)){const{specifiers:e,injections:t,source:n}=s;if(!t)return"import {".concat(e.map((e=>{let{imported:{name:t},local:{name:s},view:n,mutable:r}=e;return"".concat(n?"viewof ".concat(t):r?"mutable ".concat(t):t).concat(t===s?"":" as ".concat(s))})).join(", "),'} from "').concat(n.value,'"')}const n=(0,G.Ad)(e);return"import {".concat(n.join(", "),'} from "').concat(t,'"')}(m,R)),C({type:"showSuccessToast",message:"Copied import code to clipboard"})},children:[(0,n.jsx)(ve.Z,{className:"w1 h1 mr1"}),"Copy import"]}),le&&(0,n.jsxs)(g.sN,{onSelect:()=>C({type:"selectionToggle",id:v}),children:[(0,n.jsx)(fe.Z,{className:"w1 h1 mr1"}),c?"Deselect":"Select"]}),Q&&(0,n.jsxs)(g.sN,{onSelect:()=>C({type:"duplicate",id:v,before:!1}),children:[(0,n.jsx)(ye.Z,{className:"w1 h1 mr1"}),"Duplicate"]}),re&&(0,n.jsxs)(g.sN,{title:"Copy a link to this cell",onSelect:async()=>{const e=new URL("#".concat(y||"cell-".concat(v)),window.location.href);await navigator.clipboard.writeText(e.href),C({type:"showSuccessToast",message:"Copied link to clipboard"})},children:[(0,n.jsx)(je.ZP,{className:"w1 h1 mr1"}),"Copy link"]}),ee&&(0,n.jsxs)(g.sN,{disabled:!y,title:y?"Embed this cell in a web page":"Name this cell to embed",onSelect:()=>C({type:"showModal",modal:"embed",modalProps:{selectedNode:m},source:"nodeGutterMenu"}),children:[(0,n.jsx)(ge.Z,{className:"w1 h1 mr1"}),"Embed"]}),ne&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(Re,{onDownload:P,id:v,dispatch:C}),(0,n.jsx)(Re,{asView:!0,onDownload:P,id:v,dispatch:C})]}),oe&&(0,n.jsx)(He,{dispatch:C,id:v}),me?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(g.R,{}),(0,n.jsx)(ue,{dispatch:C,id:v,mode:j,disabled:o})]}):null]})]})}}),T&&(0,n.jsx)(xe.h,{children:(0,n.jsx)("div",{style:{position:"fixed",top:0,right:0,bottom:0,left:0,cursor:"grabbing",zIndex:1}})})]})},He=e=>{let{dispatch:t,id:s}=e;const{0:r,1:i}=(0,a.useState)(!1),{isExpanded:l}=(0,pe.uF)();return(0,a.useEffect)((()=>{l||i(!1)}),[l]),r?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(g.ti,{children:"Are you sure?"}),(0,n.jsxs)(g.sN,{onSelect:()=>t({type:"remove",id:s}),className:"hover-dark-red hover-bg-washed-red",children:[(0,n.jsx)(h.Z,{"aria-label":"Delete confirmation",className:"w1 h1 mr1"}),"Delete"]})]}):(0,n.jsxs)(g.sN,{onMouseUp:function(e){e.preventDefault(),i(!0)},onSelect:()=>t({type:"remove",id:s}),className:"hover-dark-red hover-bg-washed-red",children:[(0,n.jsx)(h.Z,{"aria-label":"Delete",className:"w1 h1 mr1"}),"Delete"]})},_e=new Set(["csv","map","set","typedarray","array","object"]),Re=e=>{let{asView:t=!1,id:s,dispatch:r,onDownload:i}=e;const{0:l,1:o}=(0,a.useState)(),{isExpanded:c}=(0,pe.uF)();if((0,a.useEffect)((()=>{c?new ke(s).run(r).then(o,(()=>{})):o(void 0)}),[r,s,c]),void 0===l)return null;const d=t?l.typeAsView:l.type;return void 0===d?null:(0,n.jsxs)(n.Fragment,{children:["svg"===d.type&&(0,n.jsxs)(g.sN,{onSelect:()=>i(t,d.type,"svg"),children:[(0,n.jsx)(be.Z,{className:"w1 h1 mr1"}),"Download SVG"]}),("svg"===d.type||"canvas"===d.type)&&(0,n.jsxs)(g.sN,{onSelect:()=>i(t,d.type,"png"),children:[(0,n.jsx)(be.Z,{className:"w1 h1 mr1"}),"Download PNG"]}),"css"===d.type&&(0,n.jsxs)(g.sN,{onSelect:()=>i(t,d.type,"css"),children:[(0,n.jsx)(be.Z,{className:"w1 h1 mr1"}),"Download CSS"]}),"blob"===d.type&&(0,n.jsxs)(g.sN,{onSelect:()=>i(t,d.type,function(e){switch(e){case"image/png":return"png";case"image/jpeg":return"jpg";case"image/gif":return"gif";case"image/bmp":return"bmp";case"application/json":return"json";case"application/x-sqlite3":return"db";case"application/zip":return"zip";case"text/css":return"css";case"text/csv":return"csv";case"text/plain":return"txt";case"text/html":return"html";case"text/javascript":return"js";case"audio/mpeg":return"mp3";case"video/mp4":return"mp4";case"text/tab-separated-values":return"tsv"}return""}(d.mime)),children:[(0,n.jsx)(be.Z,{className:"w1 h1 mr1"}),"Download file"]}),"csv"===d.type&&(0,n.jsxs)(g.sN,{onSelect:()=>i(t,d.type,"csv"),children:[(0,n.jsx)(be.Z,{className:"w1 h1 mr1"}),"Download CSV"]}),"string"===d.type&&(0,n.jsxs)(g.sN,{onSelect:()=>i(t,d.type,"txt"),children:[(0,n.jsx)(be.Z,{className:"w1 h1 mr1"}),"Download text"]}),_e.has(d.type)&&(0,n.jsxs)(g.sN,{onSelect:()=>i(t,d.type,"json"),children:[(0,n.jsx)(be.Z,{className:"w1 h1 mr1"}),"Download JSON"]})]})};var Ee=s(51289),De=s(40178);const Fe=a.memo((function(e){let{editorOpen:t,focused:s,selecting:r,selected:i,selectionFocused:a,height:l,hovered:o,commentable:c,editable:d=!0,node:h,readOnly:u,mode:m,outputHeight:p}=e;const{id:x,pinned:f}=h,g=(0,I.I0)(),v=p>0,{isCommentsOpen:b,canComment:j,nodeComments:y,saveVersion:w}=(0,I.v9)((e=>{let{notebook:t}=e;return{isCommentsOpen:t.openComments.has(h.id),canComment:(0,V.RF)(t),nodeComments:t.comments.get(h.id),saveVersion:t.saveVersion}})),C=se.qz[m].icon,k=D.re,N=v?Math.min(Math.max(p,D.NQ),D.T6):D.T6,Z=(y||[]).filter((e=>e.node_id===h.id&&e.node_id<=w));return(0,n.jsxs)("div",{id:"cell-".concat(x),style:{height:l},className:z().dynamic([["b214c87a357486b8",[D.Mv]]])+" absolute gutter dn-print",children:[(o||Z.length>0)&&(0,n.jsx)(le,{canComment:j,commentCount:Z.length,isCommentsOpen:b,node:h,className:"absolute top-0 z-1",style:{right:2*(k+4),height:N}}),(0,n.jsx)("button",{"aria-label":"gutter",onMouseEnter:()=>g({type:"hover",id:x}),onClick:e=>{r||e[Ee.Ao]?(g({type:"blur"}),g({type:"selectionToggle",id:x})):g({type:s?"blur":"focus",id:x})},title:r?i?"Unselect cell":"Select cell":f?s?"Blur cell ".concat((0,De.Z)("Escape")):"Focus cell":s?"Close cell ".concat((0,De.Z)("Escape")):"Edit cell",className:z().dynamic([["b214c87a357486b8",[D.Mv]]])+" db bn bg-transparent absolute top-0 bottom-0 right-0 w-100 pointer moon-gray hover-mid-gray",children:d&&(s||o||r)&&(0,n.jsx)("div",{style:{right:k+4,width:k,height:N},className:z().dynamic([["b214c87a357486b8",[D.Mv]]])+" absolute top-0 flex items-center justify-center",children:r?(0,n.jsx)("input",{type:"checkbox",checked:i,className:z().dynamic([["b214c87a357486b8",[D.Mv]]])+" pointer"}):v?(0,n.jsx)(oe.Z,{style:{transform:t?"":"rotate(-90deg)",transition:"transform 150ms ease"}}):null})}),(0,n.jsx)(Se,{node:h,focused:s,selected:i||a,editorOpen:t,editable:d,hovered:o,readOnly:u,commentCount:Z.length,commentable:c,className:"absolute top-0",style:{right:1,width:k,height:v?Math.max(p,N):l},children:(0,n.jsx)("div",{style:{width:k,height:N},className:z().dynamic([["b214c87a357486b8",[D.Mv]]])+" absolute top-0 flex items-center justify-center",children:v?(0,n.jsx)(ce.Z,{}):t||o?(0,n.jsx)(C,{className:z().dynamic([["b214c87a357486b8",[D.Mv]]])}):null})}),v&&t&&(0,n.jsx)("div",{style:{top:p,height:"calc(100% - ".concat(p,"px)")},className:z().dynamic([["b214c87a357486b8",[D.Mv]]])+" absolute right-0",children:(0,n.jsx)(me,{node:h,mode:m,focused:s,hovered:o,selected:i||a,className:"absolute bottom-0",readOnly:u,style:{top:-1,right:1,width:k,borderTop:"solid 1px white"},children:(0,n.jsx)("div",{style:{width:k,height:D.T6},className:z().dynamic([["b214c87a357486b8",[D.Mv]]])+" absolute top-0 flex items-center justify-center",children:(0,n.jsx)(C,{className:z().dynamic([["b214c87a357486b8",[D.Mv]]])})})})}),(0,n.jsx)(z(),{id:"b214c87a357486b8",dynamic:[D.Mv],children:".gutter.__jsx-style-dynamic-selector{width:-webkit-calc((100vw - 100%) / 2 - ".concat(D.Mv,"px + 1px);width:-moz-calc((100vw - 100%) / 2 - ").concat(D.Mv,"px + 1px);width:calc((100vw - 100%) / 2 - ").concat(D.Mv,"px + 1px);margin-left:-webkit-calc((100% - 100vw)/2);margin-left:-moz-calc((100% - 100vw)/2);margin-left:calc((100% - 100vw)/2)}")})]})}));var Ie=s(15612),Te=s(54137),Pe=s(37720),Ae=s(586),Oe=s(15706),ze=s(7131),Ue=s(82893),Be=s(61107),qe=s(40873),We=s(34790),Ge=s(78120),Ke=s(3357);var Ye=e=>(0,n.jsxs)("svg",(0,_.Z)((0,H.Z)({width:"16",height:"16",viewBox:"0 0 16 16",fill:"none"},e),{children:[(0,n.jsx)("path",{d:"M9.68457 9.76671L13.4927 8.90167L13.3285 5",stroke:"currentColor",strokeWidth:"1.6"}),(0,n.jsx)("path",{d:"M1 8.57188C4.2091 5.26919 9.5576 4.85634 13.3016 8.98472",stroke:"currentColor",strokeWidth:"1.6"})]})),$e=s(16828),Xe=s(41500),Je=s(2370);var Qe=e=>(0,n.jsxs)("svg",(0,_.Z)((0,H.Z)({width:"16",height:"16",viewBox:"0 0 16 16",fill:"none"},e),{children:[(0,n.jsx)("path",{d:"M13 6C13 6.87768 13 7.5 12.3301 8.5L8 14L3.66987 8.5C3 7.5 3 6.87768 3 6C3 5.12232 3.23103 4.2601 3.66987 3.5C4.10871 2.7399 4.7399 2.10872 5.5 1.66987C6.2601 1.23103 7.12232 1 8 1C8.87768 1 9.7399 1.23103 10.5 1.66987C11.2601 2.10871 11.8913 2.7399 12.3301 3.5C12.769 4.2601 13 5.12232 13 6Z",stroke:"currentColor",strokeWidth:"2"}),(0,n.jsx)("circle",{cx:"8",cy:"6",r:"2",fill:"currentColor"})]})),et=s(2242),tt=s(60138),st=s(45532);const nt=e=>(0,n.jsxs)("svg",(0,_.Z)((0,H.Z)({width:"50",height:"30",viewBox:"0 0 50 30",fill:"none"},e),{children:[(0,n.jsxs)("g",{fill:"currentColor",children:[(0,n.jsx)("path",{d:"M19.7071 15.7071C19.3166 15.3166 19.3166 14.6834 19.7071 14.2929L24.2929 9.70711C24.6834 9.31658 25.3166 9.31658 25.7071 9.70711L30.2929 14.2929C30.6834 14.6834 30.6834 15.3166 30.2929 15.7071L25.7071 20.2929C25.3166 20.6834 24.6834 20.6834 24.2929 20.2929L19.7071 15.7071Z"}),(0,n.jsx)("rect",{x:"39",y:"5",width:"8",height:"8",rx:"2"}),(0,n.jsx)("rect",{x:"39",y:"17",width:"8",height:"8",rx:"2"}),(0,n.jsx)("rect",{x:"3.5",y:"11.5",width:"7",height:"7",rx:"1.5",stroke:"currentColor"})]}),(0,n.jsx)("path",{stroke:"currentColor",strokeOpacity:"0.35",strokeWidth:"2",d:"M38 21L36 21C35.4477 21 35 20.5523 35 20L35 15M35 15L32 15M35 15L35 10C35 9.44772 35.4477 9 36 9L38 9 M12 15L18 15"})]}));var rt=s(48627),it=s(2741),at=s(3894),lt=s(65371),ot=s(84236),ct=s(53556);const dt=[{items:[ut("js"),ut("md"),ut("html")]},{title:"Suggestions",items:[{type:"small",label:"Create\xa0table",category:"Suggestions",icon:st.i,filter:e=>{let{suggestions:t}=e;return t.includes("table")},action:(e,t)=>{let{previousId:s}=t;null!==s&&e({type:"insertSuggestion",id:s,suggestion:e=>({id:s,before:!1,node:{mode:"table",data:{source:{type:"cell",name:e},operations:(0,_.Z)((0,H.Z)({},se.Zu.defaultNode.data.operations),{from:{table:(0,ct.Z)({type:"cell",name:e,dialect:"array"})}})}},type:"insert"})})}},{type:"small",label:"Create\xa0chart",category:"Suggestions",icon:$e.k,filter:e=>{let{suggestions:t}=e;return t.includes("chart")},action:(e,t)=>{let{previousId:s}=t;null!==s&&e({type:"insertSuggestion",id:s,suggestion:e=>({id:s,before:!1,node:{mode:"chart",data:(0,_.Z)((0,H.Z)({},se.mc.defaultNode.data),{source:{type:"cell",name:e}})},type:"insert"})})}},{type:"small",label:"Create\xa0Plot\xa0map",category:"Suggestions",icon:Qe,filter:e=>{let{suggestions:t}=e;return t.includes("map")},action:(e,t)=>{let{previousId:s}=t;null!==s&&e({type:"insertSuggestion",id:s,suggestion:e=>({id:s,before:!1,node:{mode:"js",value:'Plot.plot({ projection: "equal-earth", marks: [Plot.geo('.concat(e,")] })")},type:"insert"})})}},{type:"small",label:"Create\xa0Leaflet\xa0map",category:"Suggestions",icon:Qe,filter:e=>{let{suggestions:t}=e;return t.includes("map")},action:(e,t)=>{let{previousId:s}=t;null!==s&&e({type:"insertSuggestion",id:s,suggestion:e=>({id:s,before:!1,node:{mode:"js",value:'{\n  const container = yield htl.html`<div style="height: 500px;">`;\n  const map = L.map(container);\n  const layer = L.geoJSON('.concat(e,').addTo(map);\n  map.fitBounds(layer.getBounds(), {maxZoom: 9});\n  L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {\n    attribution: "\xa9 <a href=https://www.openstreetmap.org/copyright>OpenStreetMap</a> contributors"\n  }).addTo(map);\n}')},type:"insert"})})}},{type:"small",label:"Convert\xa0to\xa0JavaScript",category:"Suggestions",icon:Ye,filter:e=>{let{previousMode:t}=e;return"chart"===t},action:async(e,t)=>{let{previousId:s,previousNode:n}=t;if(null===s||!n)return;e({type:"insertAfter",id:s,node:{mode:"js",value:await(0,lt.F)((0,G.Qc)(n,{context:void 0}).input)},trigger:"click",source:"nodeInserterMenu"})}},{type:"small",label:"Convert\xa0to\xa0SQL",category:"Suggestions",icon:Ye,filter:e=>{let{previousMode:t}=e;return"table"===t},action:(e,t)=>{let s,{previousId:n,previousNode:r}=t;if(null!==n&&"table"===(null===r||void 0===r?void 0:r.mode)){try{s=(0,at.M7)(r.data)}catch(i){s={name:"",type:"cell"}}new rt.zL(s,r.data.operations).run(e).then(ot.Je,(e=>(console.error("Error fetching query: ",e),""))).then((t=>{e({type:"insertAfter",id:n,node:{mode:"sql",data:{source:s},value:t},trigger:"click",source:"nodeInserterMenu"})}))}}}]},{title:"Data",items:[{type:"large",label:"File attachment",category:"Data",description:"Upload a local file",icon:e=>(0,n.jsx)("svg",(0,_.Z)((0,H.Z)({width:"50",height:"30",viewBox:"0 0 50 30",fill:"none"},e),{children:(0,n.jsx)("path",{d:"M24.7851 9.69193L24.0524 10.3725L24.7851 9.69193ZM20.2008 14.0556L19.4849 14.7538L20.2008 14.0556ZM22.4652 13.2134L28.5448 19.4466L29.9766 18.0501L23.8969 11.8169L22.4652 13.2134ZM27.6793 20.2908L20.9167 13.3574L19.4849 14.7538L26.2476 21.6873L27.6793 20.2908ZM24.0524 10.3725L30.5173 17.3321L31.9827 15.9709L25.5177 9.01134L24.0524 10.3725ZM20.7743 10.4956C21.5997 9.46123 23.1518 9.40298 24.0524 10.3725L25.5177 9.01134C23.785 7.14606 20.7991 7.25813 19.2111 9.24804L20.7743 10.4956ZM20.9167 13.3574C20.1543 12.5758 20.0933 11.3489 20.7743 10.4956L19.2111 9.24804C17.9009 10.8898 18.0183 13.2502 19.4849 14.7538L20.9167 13.3574ZM28.5448 20.2908C28.3076 20.534 27.9165 20.534 27.6793 20.2908L26.2476 21.6873C27.2697 22.7352 28.9544 22.7352 29.9766 21.6873L28.5448 20.2908ZM28.5448 19.4466C28.7739 19.6814 28.7739 20.056 28.5448 20.2908L29.9766 21.6873C30.9633 20.6756 30.9633 19.0617 29.9766 18.0501L28.5448 19.4466Z",fill:"currentColor"})})),filter:e=>{let{allowFileAttachments:t}=e;return t},action:(e,t)=>{let{nextId:s}=t;(0,it.Z)().then((t=>{e({type:"attachLocalFiles",files:t,beforeId:s,source:"filesPane",trigger:"click"})}))}},{type:"large",label:"Cloud file",category:"Data",description:"Load a file from Google or Microsoft",icon:e=>(0,n.jsx)("svg",(0,_.Z)((0,H.Z)({width:"50",height:"30",viewBox:"0 0 50 30",fill:"none"},e),{children:(0,n.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M30.057 10.115C29.2921 9.31814 28.026 9.29226 27.2292 10.0572L24.3436 12.8272L22.9585 11.3844L25.8442 8.61437C27.4379 7.08452 29.97 7.13628 31.4998 8.72997C33.0297 10.3237 32.9779 12.8558 31.3842 14.3856L28.4986 17.1557L27.1136 15.7129L29.9992 12.9428C30.7961 12.1779 30.822 10.9118 30.057 10.115ZM19.9571 19.8102C20.722 20.6071 21.9881 20.6329 22.7849 19.868L25.6706 17.098L27.0556 18.5408L24.1699 21.3108C22.5763 22.8407 20.0441 22.7889 18.5143 21.1952C16.9844 19.6015 17.0362 17.0694 18.6299 15.5396L21.5155 12.7695L22.9005 14.2123L20.0149 16.9824C19.218 17.7473 19.1922 19.0134 19.9571 19.8102ZM26.4787 12.1636L22.1503 16.3187L23.5353 17.7615L27.8638 13.6065L26.4787 12.1636Z",fill:"currentColor"})})),filter:e=>{let{allowPrivateData:t}=e;return t},action:e=>e({type:"showModal",modal:"addCloudFile"})},...Ke.B7.map((e=>mt(e,"js","Data"))),{type:"large",label:"Database query",category:"Data",description:"Query a SQL database",icon:e=>(0,n.jsxs)("svg",(0,_.Z)((0,H.Z)({width:"50",height:"30",viewBox:"0 0 50 30",fill:"none"},e),{children:[(0,n.jsx)("path",{d:"M30 11C30 11.2456 29.7749 11.7372 28.7954 12.2269C27.8758 12.6867 26.5353 13 25 13C23.4647 13 22.1242 12.6867 21.2046 12.2269C20.2251 11.7372 20 11.2456 20 11C20 10.7544 20.2251 10.2628 21.2046 9.77311C22.1242 9.31327 23.4647 9 25 9C26.5353 9 27.8758 9.31327 28.7954 9.77311C29.7749 10.2628 30 10.7544 30 11Z",stroke:"currentColor",strokeWidth:"2"}),(0,n.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M29 13.2361C30.2275 12.6868 31 11.8885 31 11V13V15.25C31 17.0449 28.3137 18 25 18C21.6863 18 19 17.0449 19 15.25V13V11C19 11.8885 19.7725 12.6868 21 13.2361V13.2365V13.2475V13.2585V13.2695V13.2805V13.2915V13.3025V13.3136V13.3246V13.3357V13.3467V13.3578V13.3689V13.3799V13.391V13.4021V13.4133V13.4244V13.4355V13.4466V13.4578V13.4689V13.4801V13.4912V13.5024V13.5136V13.5248V13.536V13.5472V13.5584V13.5696V13.5808V13.592V13.6032V13.6145V13.6257V13.6369V13.6482V13.6594V13.6707V13.6819V13.6932V13.7045V13.7158V13.727V13.7383V13.7496V13.7609V13.7722V13.7835V13.7948V13.8061V13.8174V13.8287V13.84V13.8513V13.8626V13.874V13.8853V13.8966V13.9079V13.9193V13.9306V13.9419V13.9533V13.9646V13.9759V13.9873V13.9986V14.0099V14.0213V14.0326V14.0439V14.0553V14.0666V14.0779V14.0893V14.1006V14.1119V14.1233V14.1346V14.1459V14.1573V14.1686V14.1799V14.1913V14.2026V14.2139V14.2252V14.2366V14.2479V14.2592V14.2705V14.2818V14.2931V14.3044V14.3157V14.327V14.3383V14.3496V14.3609V14.3722V14.3834V14.3947V14.406V14.4172V14.4285V14.4398V14.451V14.4623V14.4735V14.4847V14.496V14.5072V14.5184V14.5296V14.5408V14.552V14.5632V14.5744V14.5856V14.5968V14.608V14.6191V14.6303V14.6414V14.6526V14.6637V14.6748V14.6859V14.6971V14.7082V14.7193V14.7303V14.7414V14.7525V14.7635V14.7746V14.7856V14.7967V14.8077V14.8187V14.8297V14.8407V14.8517V14.8627V14.8736V14.8846V14.8955V14.9065V14.9174V14.9283V14.9392V14.9501V14.961V14.9719V14.9827V14.9936V15.0044V15.0152V15.026V15.0368V15.0476V15.0584V15.0691V15.0799V15.0906V15.1013V15.1121V15.1227V15.1334V15.1441V15.1459C21.0646 15.2086 21.216 15.3194 21.542 15.4585C22.291 15.7779 23.4959 16 25 16C26.5041 16 27.709 15.7779 28.458 15.4585C28.784 15.3194 28.9354 15.2086 29 15.1459V15.1396V15.132V15.1243V15.1165V15.1087V15.1009V15.093V15.0851V15.0772V15.0692V15.0612V15.0531V15.045V15.0369V15.0287V15.0205V15.0123V15.004V14.9957V14.9874V14.979V14.9706V14.9622V14.9537V14.9452V14.9366V14.928V14.9194V14.9108V14.9021V14.8934V14.8847V14.8759V14.8671V14.8582V14.8494V14.8405V14.8315V14.8226V14.8136V14.8046V14.7955V14.7864V14.7773V14.7682V14.759V14.7498V14.7405V14.7313V14.722V14.7127V14.7033V14.694V14.6846V14.6751V14.6657V14.6562V14.6467V14.6372V14.6276V14.618V14.6084V14.5988V14.5891V14.5794V14.5697V14.56V14.5502V14.5404V14.5306V14.5208V14.5109V14.501V14.4911V14.4812V14.4713V14.4613V14.4513V14.4413V14.4312V14.4212V14.4111V14.401V14.3909V14.3807V14.3705V14.3604V14.3502V14.3399V14.3297V14.3194V14.3091V14.2988V14.2885V14.2782V14.2678V14.2574V14.247V14.2366V14.2262V14.2157V14.2053V14.1948V14.1843V14.1738V14.1632V14.1527V14.1421V14.1316V14.121V14.1104V14.0997V14.0891V14.0784V14.0678V14.0571V14.0464V14.0357V14.025V14.0142V14.0035V13.9927V13.982V13.9712V13.9604V13.9496V13.9387V13.9279V13.9171V13.9062V13.8953V13.8845V13.8736V13.8627V13.8518V13.8409V13.8299V13.819V13.8081V13.7971V13.7862V13.7752V13.7642V13.7532V13.7422V13.7312V13.7202V13.7092V13.6982V13.6872V13.6761V13.6651V13.654V13.643V13.6319V13.6209V13.6098V13.5987V13.5877V13.5766V13.5655V13.5544V13.5433V13.5322V13.5211V13.51V13.4989V13.4878V13.4767V13.4656V13.4545V13.4434V13.4322V13.4211V13.41V13.3989V13.3878V13.3766V13.3655V13.3544V13.3433V13.3321V13.321V13.3099V13.2988V13.2877V13.2765V13.2654V13.2543V13.2432V13.2361ZM29.0419 15.0893C29.0447 15.0899 29.0398 15.1028 29.0191 15.1261C29.0288 15.1003 29.0392 15.0886 29.0419 15.0893ZM20.9581 15.0893C20.9608 15.0886 20.9712 15.1003 20.9809 15.1261C20.9602 15.1028 20.9553 15.0899 20.9581 15.0893Z",fill:"currentColor"}),(0,n.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M29 13.2361C30.2275 12.6868 31 11.8885 31 11V13V19C31 20.7949 28.3137 22 25 22C21.6863 22 19 20.7949 19 19V13V11C19 11.8885 19.7725 12.6868 21 13.2361V13.2457V13.2647V13.2838V13.3029V13.3221V13.3413V13.3605V13.3798V13.3992V13.4185V13.438V13.4574V13.4769V13.4965V13.5161V13.5357V13.5554V13.5751V13.5948V13.6146V13.6344V13.6543V13.6741V13.6941V13.714V13.734V13.7541V13.7741V13.7942V13.8144V13.8345V13.8547V13.8749V13.8952V13.9155V13.9358V13.9561V13.9765V13.9969V14.0174V14.0378V14.0583V14.0788V14.0994V14.1199V14.1405V14.1611V14.1818V14.2024V14.2231V14.2438V14.2646V14.2853V14.3061V14.3269V14.3477V14.3686V14.3894V14.4103V14.4312V14.4521V14.473V14.494V14.515V14.5359V14.5569V14.5779V14.599V14.62V14.6411V14.6621V14.6832V14.7043V14.7254V14.7465V14.7677V14.7888V14.81V14.8311V14.8523V14.8735V14.8947V14.9158V14.937V14.9583V14.9795V15.0007V15.0219V15.0431V15.0644V15.0856V15.1069V15.1281V15.1494V15.1706V15.1919V15.2131V15.2344V15.2556V15.2769V15.2981V15.3194V15.3406V15.3619V15.3831V15.4043V15.4256V15.4468V15.468V15.4893V15.5105V15.5317V15.5529V15.5741V15.5953V15.6165V15.6376V15.6588V15.68V15.7011V15.7222V15.7434V15.7645V15.7856V15.8067V15.8278V15.8488V15.8699V15.8909V15.9119V15.9329V15.9539V15.9749V15.9959V16.0168V16.0377V16.0586V16.0795V16.1004V16.1212V16.1421V16.1629V16.1837V16.2044V16.2252V16.2459V16.2666V16.2873V16.3079V16.3286V16.3492V16.3698V16.3903V16.4108V16.4313V16.4518V16.4723V16.4927V16.5131V16.5334V16.5538V16.5741V16.5944V16.6146V16.6348V16.655V16.6751V16.6953V16.7153V16.7354V16.7554V16.7754V16.7953V16.8152V16.8351V16.855V16.8748V16.8945V16.9142V16.9339V16.9536V16.9732V16.9928V17.0123V17.0318V17.0512V17.0706V17.09V17.1093V17.1286V17.1478V17.167V17.1862V17.2053V17.2243V17.2433V17.2623V17.2812V17.3001V17.3189V17.3377V17.3564V17.3751V17.3937V17.4123V17.4308V17.4493V17.4677V17.4861V17.5044V17.5227V17.5409V17.559V17.5771V17.5952V17.6132V17.6311V17.649V17.6668V17.6846V17.7023V17.72V17.7375V17.7551V17.7726V17.79V17.8073V17.8246V17.8418V17.859V17.8761V17.8932V17.9101V17.927V17.9439V17.9607V17.9774V17.9941V18.0106V18.0272V18.0436V18.06V18.0763V18.0926V18.1088V18.1249V18.1409V18.1569V18.1728V18.1886V18.2044V18.22V18.2357V18.2512V18.2667V18.282V18.2974V18.3126V18.3278V18.3428V18.3579V18.3728V18.3876V18.4024V18.4171V18.4317V18.4463V18.4607V18.4751V18.4894V18.5036V18.5178V18.5318V18.5458V18.5597V18.5735V18.5872V18.6008V18.6144V18.6278V18.6412V18.6545V18.6677V18.6808V18.6938V18.7068V18.7196V18.7324V18.745V18.7576V18.7701V18.7825V18.7948V18.807V18.8191V18.8312V18.8431V18.8549V18.8667V18.8783V18.8899V18.9013V18.9127V18.9239V18.9341C21.0457 19.0021 21.1957 19.1633 21.6288 19.3729C22.3708 19.7321 23.5531 20 25 20C26.4469 20 27.6292 19.7321 28.3712 19.3729C28.8043 19.1633 28.9543 19.0021 29 18.9341V18.9314V18.9232V18.9148V18.9064V18.8978V18.889V18.8802V18.8712V18.8621V18.8529V18.8436V18.8342V18.8246V18.8149V18.8051V18.7952V18.7852V18.7751V18.7648V18.7545V18.744V18.7334V18.7227V18.7119V18.701V18.69V18.6788V18.6676V18.6562V18.6448V18.6332V18.6215V18.6098V18.5979V18.5859V18.5738V18.5616V18.5493V18.5369V18.5244V18.5118V18.4991V18.4863V18.4733V18.4603V18.4472V18.434V18.4207V18.4073V18.3938V18.3802V18.3666V18.3528V18.3389V18.3249V18.3109V18.2967V18.2825V18.2681V18.2537V18.2392V18.2246V18.2099V18.1951V18.1802V18.1652V18.1502V18.1351V18.1198V18.1045V18.0891V18.0737V18.0581V18.0425V18.0267V18.0109V17.995V17.9791V17.963V17.9469V17.9307V17.9144V17.898V17.8816V17.865V17.8484V17.8318V17.815V17.7982V17.7813V17.7643V17.7473V17.7302V17.713V17.6957V17.6784V17.661V17.6435V17.6259V17.6083V17.5907V17.5729V17.5551V17.5372V17.5193V17.5012V17.4832V17.465V17.4468V17.4285V17.4102V17.3918V17.3734V17.3549V17.3363V17.3176V17.2989V17.2802V17.2614V17.2425V17.2236V17.2046V17.1855V17.1665V17.1473V17.1281V17.1088V17.0895V17.0702V17.0507V17.0313V17.0118V16.9922V16.9726V16.9529V16.9332V16.9134V16.8936V16.8737V16.8538V16.8339V16.8139V16.7938V16.7737V16.7536V16.7334V16.7132V16.6929V16.6726V16.6523V16.6319V16.6115V16.591V16.5705V16.55V16.5294V16.5088V16.4881V16.4674V16.4467V16.426V16.4052V16.3843V16.3635V16.3426V16.3217V16.3007V16.2797V16.2587V16.2376V16.2166V16.1954V16.1743V16.1531V16.132V16.1107V16.0895V16.0682V16.0469V16.0256V16.0043V15.9829V15.9615V15.9401V15.9187V15.8972V15.8757V15.8543V15.8327V15.8112V15.7897V15.7681V15.7465V15.7249V15.7033V15.6816V15.66V15.6383V15.6166V15.595V15.5733V15.5515V15.5298V15.5081V15.4863V15.4646V15.4428V15.421V15.3992V15.3774V15.3556V15.3338V15.312V15.2902V15.2684V15.2465V15.2247V15.2029V15.181V15.1592V15.1373V15.1155V15.0936V15.0718V15.0499V15.0281V15.0063V14.9844V14.9626V14.9407V14.9189V14.8971V14.8753V14.8534V14.8316V14.8098V14.788V14.7662V14.7445V14.7227V14.7009V14.6792V14.6574V14.6357V14.614V14.5923V14.5706V14.5489V14.5272V14.5056V14.4839V14.4623V14.4407V14.4191V14.3975V14.376V14.3544V14.3329V14.3114V14.2899V14.2685V14.247V14.2256V14.2042V14.1829V14.1615V14.1402V14.1189V14.0976V14.0763V14.0551V14.0339V14.0128V13.9916V13.9705V13.9494V13.9283V13.9073V13.8863V13.8654V13.8444V13.8235V13.8026V13.7818V13.761V13.7402V13.7195V13.6988V13.6781V13.6575V13.6369V13.6164V13.5959V13.5754V13.5549V13.5345V13.5142V13.4939V13.4736V13.4534V13.4332V13.413V13.3929V13.3729V13.3529V13.3329V13.313V13.2931V13.2733V13.2535V13.2361ZM29.0175 18.8988C29.0186 18.899 29.0166 18.9065 29.0086 18.9204C29.0125 18.9055 29.0165 18.8985 29.0175 18.8988ZM20.9825 18.8988C20.9835 18.8985 20.9875 18.9055 20.9914 18.9204C20.9834 18.9065 20.9814 18.899 20.9825 18.8988Z",fill:"currentColor"})]})),action:(e,t)=>{let{nextId:s,trigger:n}=t;return e({type:"insertBefore",id:s,node:{mode:"sql"},trigger:n,source:"nodeInserterMenu"})}}]},{title:"Tables",items:[{type:"large",label:"Data table",category:"Tables",description:"Filter and summarize tabular data",icon:e=>{var{width:t="50",height:s="30",viewBox:r="-17 -7 50 30"}=e,i=(0,ie.Z)(e,["width","height","viewBox"]);return(0,n.jsx)(st.i,(0,H.Z)({width:t,height:s,viewBox:r},i))},action:(e,t)=>{let{nextId:s,trigger:n}=t;return e({type:"insertBefore",id:s,node:{mode:"table"},trigger:n,source:"nodeInserterMenu"})}},(0,_.Z)((0,H.Z)({},mt(Ke.Cq.find((e=>{let{label:t}=e;return"Table\xa0input"===t})),"js","Tables")),{label:"JavaScript table"}),(0,_.Z)((0,H.Z)({},mt(Ke.L7.find((e=>{let{label:t}=e;return"Table"===t})),"md","Tables")),{label:"Markdown table"}),{label:"HTML table",category:"Tables",description:"Basic custom table layout",icon:e=>(0,n.jsxs)("svg",(0,_.Z)((0,H.Z)({width:"50",height:"30",viewBox:"0 0 50 30",fill:"currentColor"},e),{children:[(0,n.jsxs)("g",{fill:"currentColor",children:[(0,n.jsx)("path",{d:"M4 5C4 4.44772 4.44772 4 5 4H18V10H4V5Z",fill:"currentColor"}),(0,n.jsx)("rect",{x:"4",y:"11",width:"14",height:"7",fillOpacity:"0.35"}),(0,n.jsx)("path",{d:"M4 19H18V26H5C4.44772 26 4 25.5523 4 25V19Z",fillOpacity:"0.35"}),(0,n.jsx)("rect",{x:"18",y:"4",width:"14",height:"6",fill:"currentColor"}),(0,n.jsx)("rect",{x:"18",y:"11",width:"14",height:"7",fillOpacity:"0.35"}),(0,n.jsx)("rect",{x:"18",y:"19",width:"14",height:"7",fillOpacity:"0.35"}),(0,n.jsx)("path",{d:"M32 4H45C45.5523 4 46 4.44772 46 5V10H32V4Z",fill:"currentColor"}),(0,n.jsx)("rect",{x:"32",y:"11",width:"14",height:"7",fillOpacity:"0.35"}),(0,n.jsx)("path",{d:"M32 19H46V25C46 25.5523 45.5523 26 45 26H32V19Z",fillOpacity:"0.35"})]}),(0,n.jsx)("path",{d:"M18 26V4",stroke:"white"}),(0,n.jsx)("path",{d:"M32 26V4",stroke:"white"})]})),type:"large",action:(e,t)=>{let{previousId:s}=t;return e({type:"insertSnippet",apply:pt('<table>\n  <thead>\n    <tr>\n      <th>Name</th>\n      <th>Fuel economy</th>\n      <th>Year</th>\n    </tr>\n  </thead>\n  <tbody>\n    ${cars.slice(0, 5).map(car => htl.html`<tr>\n      <td>${car["name"]}</td>\n      <td>${car["economy (mpg)"]} mpg</td>\n      <td>\u2019${car["year"]}</td>\n    </tr>`)}\n  </tbody>\n</table>'),label:"Insert",mode:"html",afterId:s})}}]},{title:"Plot",items:[{type:"large",label:"Chart",category:"Plot",description:"Quick plots without code",newUntil:new Date("2023-06-01"),icon:e=>{var{width:t="50",height:s="30",viewBox:r="-17 -7 50 30"}=e,i=(0,ie.Z)(e,["width","height","viewBox"]);return(0,n.jsx)($e.k,(0,H.Z)({width:t,height:s,viewBox:r},i))},action:(e,t)=>{let{nextId:s,trigger:n}=t;return e({type:"insertBefore",id:s,node:{mode:"chart"},trigger:n,source:"nodeInserterMenu"})}},...Ke.aS.map((e=>mt(e,"js","Plot")))]},{title:"Maps",items:[{label:"Interactive map",category:"Maps",description:"Zoomable map with Leaflet",thumbnail:e=>(0,n.jsxs)("svg",(0,_.Z)((0,H.Z)({width:"50",height:"30",viewBox:"0 0 50 30",fill:"none"},e),{children:[(0,n.jsx)("path",{d:"M29 19H31V20H30V22H29V19Z",fill:"currentColor"}),(0,n.jsx)("path",{d:"M38 23V21V20H40V19H42V20H43V21H44V23H43V24H42V25H41V23H38Z",fill:"currentColor"}),(0,n.jsx)("path",{d:"M46 23V24H45V25H44H43V24H44H45V23H46Z",fill:"currentColor"}),(0,n.jsx)("path",{d:"M41 18V17H43V18H44V19H42V18H41Z",fill:"currentColor"}),(0,n.jsx)("path",{d:"M37 19H40V18H39V17H40V16H41V15H39V16H38V17H36V18H37V19Z",fill:"currentColor"}),(0,n.jsx)("path",{d:"M23 11H24H25V10H26V9H27H28V10H27V11H29V12H30V13H32V14H33V16H34V17H35V14H36V16H38V14H39V11H38V10H39H40V12H41V9H40V8H39V7H40H41V8H42V5H39V4H37V5H34V4H31V5H30V6H29V4H28V6H27V5H26V7H24V8H23V9H22V11H23Z",fill:"currentColor"}),(0,n.jsx)("path",{d:"M24 11V12H29V13H30V15H28V16H30V17H29V18H28V20V21H27V23H26V24H25V23H24V17H21V16H20V14H21V13H22V12H23V11H24Z",fill:"currentColor"}),(0,n.jsx)("path",{d:"M6 12V9H5V8H4V7H5V6H6V5H8V6H12V5H13H14V4H16V6H14V7H16V9H15V10H14V11H13V12H12V13H10V14V15H11H15V16H16V17H17V18H19V20H18V22H17V24H16V25H15V27H16V28H15V27H13V21H12V20H11V16H9V15H8V13H7V12H6Z",fill:"currentColor"}),(0,n.jsx)("path",{d:"M17 5V4H21V5H20V6H19V7H18V5H17Z",fill:"currentColor"}),(0,n.jsx)("path",{d:"M21 6H22V7H21V6Z",fill:"currentColor"}),(0,n.jsx)("path",{d:"M23 3H25V4H23V3Z",fill:"currentColor"}),(0,n.jsx)("path",{d:"M23 5H25V6H24V7H23V5Z",fill:"currentColor"})]})),apply:(0,Ke.eu)((e=>"#{1:".concat(e("map"),'} = {\n  const container = yield htl.html`<div style="height: 500px;">`;\n  const map = L.map(container).setView([#{2:37.774}, #{3:-122.423}], #{4:13});\n  L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {\n    attribution: "\xa9 <a href=https://www.openstreetmap.org/copyright>OpenStreetMap</a> contributors"\n  }).addTo(map);\n}')))}].map((e=>mt(e,"js","Maps")))},{title:"Trees and Networks",items:[{label:"Tidy tree",description:"Tree diagram with Plot",thumbnail:e=>(0,n.jsxs)("svg",(0,_.Z)((0,H.Z)({width:"50",height:"30",viewBox:"0 0 50 30",fill:"none"},e),{children:[(0,n.jsx)("path",{d:"M10 15H14C15.1046 15 16 14.1046 16 13V11C16 9.89543 16.8954 9 18 9H22 M10 15H14C15.1046 15 16 15.8954 16 17V19C16 20.1046 16.8954 21 18 21H22 M40 4H36C34.8954 4 34 4.89543 34 6V7C34 8.10457 33.1046 9 32 9H28H40 M32 21H28H40M32 21C33.1046 21 34 20.1046 34 19V18C34 16.8954 34.8954 16 36 16H40M32 21C33.1046 21 34 21.8954 34 23V24C34 25.1046 34.8954 26 36 26H40",stroke:"currentColor",strokeOpacity:"0.35",strokeWidth:"2"}),(0,n.jsxs)("g",{fill:"currentColor",children:[(0,n.jsx)("rect",{x:"5",y:"14",width:"4",height:"2",rx:"0.5"}),(0,n.jsx)("rect",{x:"23",y:"8",width:"4",height:"2",rx:"0.5"}),(0,n.jsx)("rect",{x:"23",y:"20",width:"4",height:"2",rx:"0.5"}),(0,n.jsx)("rect",{x:"41",y:"15",width:"4",height:"2",rx:"0.5"}),(0,n.jsx)("rect",{x:"41",y:"20",width:"4",height:"2",rx:"0.5"}),(0,n.jsx)("rect",{x:"41",y:"25",width:"4",height:"2",rx:"0.5"}),(0,n.jsx)("rect",{x:"41",y:"3",width:"4",height:"2",rx:"0.5"}),(0,n.jsx)("rect",{x:"41",y:"8",width:"4",height:"2",rx:"0.5"})]})]})),mode:"js",type:"snippet",apply:(0,We.DB)('Plot.plot({\n  axis: null,\n  margin: 20,\n  marginRight: 120,\n  marks: [\n    Plot.tree(flare.slice(0, 50), {path: "name", delimiter: "."})\n  ]\n})')},{label:"Circle packing",description:"Nested hierarchy with D3",thumbnail:e=>(0,n.jsxs)("svg",(0,_.Z)((0,H.Z)({width:"50",height:"30",viewBox:"0 0 50 30",fill:"none"},e),{children:[(0,n.jsxs)("g",{stroke:"currentColor",children:[(0,n.jsx)("circle",{cx:"33",cy:"13",r:"9.5"}),(0,n.jsxs)("g",{strokeOpacity:"0.35",children:[(0,n.jsx)("circle",{cx:"14.5",cy:"10.5",r:"7",stroke:"#C4C4C4"}),(0,n.jsx)("circle",{cx:"20",cy:"22",r:"3.5",stroke:"#C4C4C4"})]})]}),(0,n.jsxs)("g",{fill:"currentColor",children:[(0,n.jsx)("circle",{cx:"30",cy:"9",r:"3"}),(0,n.jsx)("circle",{cx:"37",cy:"14",r:"4"}),(0,n.jsx)("circle",{cx:"29",cy:"16",r:"3"}),(0,n.jsxs)("g",{fillOpacity:"0.35",children:[(0,n.jsx)("circle",{cx:"16.5",cy:"12.5",r:"2.5"}),(0,n.jsx)("circle",{cx:"12.5",cy:"8.5",r:"2.5"}),(0,n.jsx)("circle",{cx:"20",cy:"22",r:"2"})]})]})]})),mode:"js",type:"snippet",apply:(0,We.DB)('Pack(flare, {\n  path: (d) => d.name.replaceAll(".", "/"), // e.g. flare/animate/Easing\n  label: (d) => d.name.split(".").pop(), // display text\n  value: (d) => d?.size, // area of each circle\n  title: (d, n) => [n.id, n.value.toLocaleString()].join("\\n"), // hover text\n  width,\n  height: 720\n})'),imports:[["Pack","@d3/pack"]]},{label:"Icicle partition",description:"Left-to-right hierarchy with D3",thumbnail:e=>(0,n.jsxs)("svg",(0,_.Z)((0,H.Z)({width:"50",height:"30",viewBox:"0 0 50 30",fill:"currentColor"},e),{children:[(0,n.jsx)("rect",{x:"5",y:"5",width:"12",height:"8"}),(0,n.jsx)("rect",{x:"18",y:"9",width:"13",height:"4"}),(0,n.jsx)("rect",{x:"32",y:"11",width:"13",height:"2"}),(0,n.jsxs)("g",{fillOpacity:"0.35",children:[(0,n.jsx)("rect",{x:"5",y:"14",width:"12",height:"6"}),(0,n.jsx)("rect",{x:"18",y:"14",width:"13",height:"2"}),(0,n.jsx)("rect",{x:"18",y:"17",width:"13",height:"3"}),(0,n.jsx)("path",{d:"M18 5H31V8H18V5Z"}),(0,n.jsx)("rect",{x:"32",y:"9",width:"13",height:"1"}),(0,n.jsx)("rect",{x:"32",y:"17",width:"13",height:"1"}),(0,n.jsx)("rect",{x:"32",y:"19",width:"13",height:"1"}),(0,n.jsx)("path",{d:"M32 21H45V24C45 24.5523 44.5523 25 44 25H32V21Z"}),(0,n.jsx)("rect",{x:"5",y:"21",width:"12",height:"4"}),(0,n.jsx)("path",{d:"M18 21H31V25H18V21Z"})]})]})),mode:"js",type:"snippet",apply:(0,We.DB)('Icicle(flare, {\n  path: (d) => d.name.replaceAll(".", "/"), // e.g. flare/animate/Easing\n  label: (d) => d.name.split(".").pop(), // display text\n  value: (d) => d?.size, // height of each rect\n  title: (d, n) => [n.id, n.value.toLocaleString()].join("\\n"), // hover text\n  width,\n  height: 500\n})'),imports:[["Icicle","@d3/icicle"]]},{label:"Sunburst partition",description:"Radial hierarchy with D3",thumbnail:e=>(0,n.jsxs)("svg",(0,_.Z)((0,H.Z)({width:"50",height:"30",viewBox:"0 0 50 30",fill:"currentColor"},e),{children:[(0,n.jsx)("path",{fillOpacity:"0.35",d:"M23.9648 12.1524L21.9997 8.67561C22.7855 8.30283 23.6335 8.07995 24.5 8.0179V12.0116C24.3177 12.0421 24.1386 12.0892 23.9648 12.1524Z M24.5 7.01473C23.4609 7.07979 22.4438 7.34711 21.5061 7.80229L19.5357 4.31631C20.0106 4.07343 20.4998 3.86315 21 3.68631C22.1242 3.28884 23.3038 3.06032 24.5 3.01044V7.01473Z M30.1374 21.1337L32.8953 24.0368C32.072 24.7562 31.1554 25.3586 30.1716 25.8284C29.6279 26.0881 29.0637 26.3073 28.4834 26.4833C26.595 27.0562 24.5944 27.1544 22.6589 26.7694C20.7234 26.3844 18.9128 25.5281 17.3873 24.2761C17.2123 24.1325 17.0417 23.9843 16.8756 23.8315L19.7071 21C19.7783 21.0628 19.8507 21.1244 19.9243 21.1848C20.9414 22.0195 22.1486 22.5905 23.4391 22.8472C24.6441 23.0869 25.8869 23.0456 27.0713 22.7282C27.1176 22.7158 27.1637 22.703 27.2098 22.6897C27.2474 22.6789 27.285 22.6678 27.3225 22.6564C28.3561 22.3429 29.3131 21.8241 30.1374 21.1337Z M26.6958 17.511L29.4464 20.4064C28.7363 20.9905 27.9161 21.4304 27.032 21.6986C26.7691 21.7783 26.5025 21.8423 26.2336 21.8905C25.3756 22.0441 24.494 22.0365 23.6344 21.8655C22.5053 21.6409 21.4491 21.1414 20.5593 20.4111C20.5111 20.3716 20.4635 20.3314 20.4165 20.2907L23.2404 17.4667C23.5891 17.7154 23.9873 17.8879 24.4089 17.9718C24.8976 18.069 25.4027 18.0442 25.8796 17.8995C26.1706 17.8112 26.4456 17.68 26.6958 17.511Z M21.9927 14.6304C21.9897 14.6546 21.987 14.6788 21.9846 14.703C21.9358 15.1989 22.01 15.6992 22.2007 16.1595C22.2888 16.3723 22.4006 16.5735 22.5333 16.7596L19.7093 19.5836C19.2192 19.0178 18.8213 18.3751 18.5328 17.6788C18.0923 16.6153 17.9209 15.4595 18.0337 14.3139C18.0609 14.0381 18.1043 13.765 18.1635 13.4959L21.9927 14.6304Z M22.2768 13.6716C22.3365 13.5492 22.4046 13.4306 22.4807 13.3167C22.6508 13.0621 22.8579 12.8357 23.0942 12.6444L21.1291 9.16767C21.0857 9.19646 21.0427 9.22572 21 9.25545C20.2847 9.75353 19.6666 10.3823 19.1797 11.111C18.8808 11.5585 18.6355 12.0371 18.4476 12.5371L22.2768 13.6716Z M17.4858 12.2521C17.7036 11.6563 17.9924 11.0864 18.3475 10.5549C18.9506 9.65233 19.7297 8.88393 20.6355 8.29435L18.6652 4.80836C17.2163 5.70891 15.9735 6.90978 15.0224 8.33317C14.4431 9.20009 13.9815 10.1354 13.6465 11.1145L17.4858 12.2521Z M13.3624 12.0733C13.2182 12.6467 13.1161 13.2317 13.0578 13.8238C12.8644 15.7877 13.1583 17.769 13.9134 19.5922C14.4538 20.8968 15.2184 22.0916 16.1685 23.1244L19 20.2929C18.4181 19.6333 17.947 18.8799 17.6081 18.0618C17.1046 16.8462 16.9086 15.5252 17.0376 14.2158C17.071 13.8767 17.1259 13.5411 17.2017 13.2109L13.3624 12.0733Z"}),(0,n.jsx)("path",{d:"M25.5 3.01044V7.01473C26.6847 7.0889 27.8376 7.42579 28.8749 8.00002C28.9168 8.02321 28.9585 8.04678 29 8.07074C29.151 8.15792 29.2995 8.2502 29.4451 8.34749C30.7355 9.20975 31.7468 10.4283 32.3565 11.8541L36.1589 10.5866C36.1353 10.5269 36.1112 10.4673 36.0866 10.4078C35.1783 8.2151 33.6402 6.34096 31.6668 5.02238C30.8325 4.46488 29.9361 4.01728 29 3.68631C27.8778 3.28956 26.6984 3.0604 25.5 3.01044Z M36.4877 11.5311L32.6915 12.7965C32.9952 13.8564 33.0769 14.9692 32.9298 16.0647L36.8758 16.7224C37.1281 14.9823 36.9947 13.2101 36.4877 11.5311Z M36.6911 17.7054L32.7349 17.046C32.7327 17.0545 32.7304 17.0629 32.7282 17.0713C32.7158 17.1176 32.7029 17.1638 32.6897 17.2098C32.3434 18.4149 31.7181 19.5237 30.8624 20.445L33.6203 23.3481C34.5276 22.4112 35.2716 21.3374 35.8284 20.1716C36.2033 19.3866 36.4933 18.56 36.6911 17.7054Z M25.5 8.0179V12.0116C25.9214 12.0821 26.325 12.2413 26.6834 12.4807C27.1816 12.8136 27.57 13.2869 27.7993 13.8405C28.0286 14.3942 28.0887 15.0034 27.9717 15.5911C27.8826 16.0395 27.6935 16.4599 27.4208 16.8222L30.1714 19.7177C31.0296 18.777 31.6163 17.6184 31.8655 16.3657C31.8742 16.3217 31.8826 16.2777 31.8904 16.2336C32.1262 14.9168 31.9798 13.5589 31.4672 12.3212C30.9545 11.0836 30.0978 10.0199 29 9.25546C28.9633 9.22988 28.9263 9.20463 28.889 9.17973C27.8769 8.50346 26.7084 8.10442 25.5 8.0179Z"})]})),mode:"js",type:"snippet",apply:(0,We.DB)('Sunburst(flare, {\n  path: (d) => d.name.replaceAll(".", "/"), // e.g. flare/animate/Easing\n  label: (d) => d.name.split(".").pop(), // display text\n  value: (d) => d?.size, // angle of each arc\n  title: (d, n) => [n.id, n.value.toLocaleString()].join("\\n"), // hover text\n  width,\n  height: 720\n})'),imports:[["Sunburst","@d3/sunburst"]]},{label:"Treemap",description:"Nested hierarchy with D3",thumbnail:e=>(0,n.jsxs)("svg",(0,_.Z)((0,H.Z)({width:"50",height:"30",viewBox:"0 0 50 30",fill:"currentColor"},e),{children:[(0,n.jsx)("rect",{x:"5",y:"5",width:"20",height:"12"}),(0,n.jsxs)("g",{fillOpacity:"0.35",children:[(0,n.jsx)("rect",{x:"26",y:"5",width:"18",height:"7"}),(0,n.jsx)("rect",{x:"26",y:"13",width:"9",height:"7"}),(0,n.jsx)("rect",{x:"36",y:"13",width:"8",height:"7"}),(0,n.jsx)("rect",{x:"5",y:"18",width:"20",height:"7"}),(0,n.jsx)("rect",{x:"26",y:"21",width:"12",height:"4"}),(0,n.jsx)("rect",{x:"39",y:"21",width:"5",height:"4"})]})]})),mode:"js",type:"snippet",apply:(0,We.DB)('Treemap(flare, {\n  path: (d) => d.name.replaceAll(".", "/"), // e.g. flare/animate/Easing\n  label: (d) => d.name.split(".").pop(), // display text\n  group: (d) => d.name.split(".")[1], // for color; e.g. animate\n  value: (d) => d?.size, // area of each rect\n  title: (d, n) => [n.id, n.value.toLocaleString()].join("\\n"), // hover text\n  width,\n  height: 500\n})'),imports:[["Treemap","@d3/treemap"]]},{label:"Force-directed graph",description:"Node-link diagram with D3",thumbnail:e=>(0,n.jsxs)("svg",(0,_.Z)((0,H.Z)({width:"50",height:"30",viewBox:"0 0 50 30",fill:"currentColor"},e),{children:[(0,n.jsx)("path",{fillOpacity:"0.35",d:"M9.45007 9.62691L14.221 13.8678C14.4808 13.2308 14.9531 12.7032 15.5499 12.3731L10.779 8.13226C10.5192 8.76917 10.0469 9.29678 9.45007 9.62691Z M19.6441 13.5815C19.8712 14.0038 20 14.4869 20 15C20 15.1908 19.9822 15.3773 19.9482 15.5582L27.3559 14.4186C27.1288 13.9962 27 13.5131 27 13C27 12.8093 27.0178 12.6227 27.0518 12.4418L19.6441 13.5815Z M32.0826 10.8407C32.5645 11.3055 32.8912 11.9302 32.9773 12.6294L37.9174 10.1593C37.4355 9.69448 37.1088 9.06979 37.0227 8.37064L32.0826 10.8407Z M41.4899 10.6045C41.051 10.8561 40.5423 11 40 11C39.8374 11 39.6778 10.9871 39.5222 10.9622L40.5101 16.3956C40.9491 16.1439 41.4577 16 42 16C42.1626 16 42.3222 16.0129 42.4778 16.0379L41.4899 10.6045Z M39.4982 20.6562C39.1834 20.1816 39 19.6122 39 19C39 18.9042 39.0045 18.8094 39.0133 18.7159L32.5018 20.3438C32.8166 20.8184 33 21.3878 33 22C33 22.0958 32.9955 22.1906 32.9867 22.2841L39.4982 20.6562Z M29 19.1707C29.3128 19.0602 29.6494 19 30 19C30.3506 19 30.6872 19.0602 31 19.1707V15.8293C30.6872 15.9399 30.3506 16 30 16C29.6494 16 29.3128 15.9399 29 15.8293V19.1707Z M32.0826 15.1593L39.0227 18.6294C39.1088 17.9302 39.4355 17.3055 39.9174 16.8407L32.9773 13.3706C32.8912 14.0698 32.5645 14.6945 32.0826 15.1593Z M15.7066 17.7076C15.0888 17.412 14.588 16.9112 14.2924 16.2934L11.2934 19.2924C11.9112 19.588 12.412 20.0888 12.7076 20.7066L15.7066 17.7076Z"}),(0,n.jsx)("circle",{cx:"8",cy:"7",r:"2"}),(0,n.jsx)("circle",{cx:"17",cy:"15",r:"2"}),(0,n.jsx)("circle",{cx:"10",cy:"22",r:"2"}),(0,n.jsx)("circle",{cx:"30",cy:"13",r:"2"}),(0,n.jsx)("circle",{cx:"42",cy:"19",r:"2"}),(0,n.jsx)("circle",{cx:"30",cy:"22",r:"2"}),(0,n.jsx)("circle",{cx:"40",cy:"8",r:"2"})]})),mode:"js",type:"snippet",apply:(0,We.DB)("ForceGraph(miserables, {\n  nodeId: (d) => d.id, // node identifier, to match links\n  nodeGroup: (d) => d.group, // group identifier, for color\n  nodeTitle: (d) => d.id, // hover text\n  width,\n  height: 520,\n  invalidation // stop when the cell is re-run\n})"),imports:[["ForceGraph","@d3/force-directed-graph"]]},{label:"Graphviz",description:"Node-link diagram with DOT",thumbnail:nt,apply:xt("dot`digraph g {\n\trankdir = LR;\n\ta -> b -> c;\n}`",4,1)},{label:"Mermaid",description:"Node-link diagram with Mermaid",thumbnail:nt,apply:xt("mermaid`graph LR\na--\x3eb\nb--\x3ec`",8,1)}].map((e=>mt(e,"js","Trees and Networks")))},{title:"Inputs",items:Ke.Cq.filter((e=>{let{label:t}=e;return"Table\xa0input"!==t})).map((e=>mt(e,"js","Inputs")))},{title:"Text",items:[...Ke.L7.filter((e=>{let{label:t}=e;return"Table"!==t})).map((e=>{let{label:t,description:s,apply:n,thumbnail:r}=e;return{label:t,description:null!==s&&void 0!==s?s:"",thumbnail:r||et.Z,apply:n}})).map((e=>mt(e,"md","Text"))),mt({label:"Mathematical formula",description:"Typeset math with TeX",thumbnail:Je.Z,type:"snippet",apply:xt("c = \\pm\\sqrt{a^2 + b^2}")},"tex","Text")]},{title:"Graphics",items:[{label:"D3 starter",category:"Graphics",description:"Scales, axes, margins, and a line",icon:e=>(0,n.jsx)("svg",(0,_.Z)((0,H.Z)({width:"50",height:"30",viewBox:"0 0 50 30",fill:"none"},e),{children:(0,n.jsx)("path",{d:"M15 5H16.776C19.5414 5 22.1935 6.00089 24.149 7.78249C26.1044 9.56408 27.203 11.9804 27.203 14.5C27.203 17.0196 26.1044 19.4359 24.149 21.2175C22.1935 22.9991 19.5414 24 16.776 24H15V19.8242H16.776C18.3259 19.8242 19.8122 19.2632 20.9081 18.2648C22.004 17.2663 22.6197 15.9121 22.6197 14.5C22.6197 13.0879 22.004 11.7337 20.9081 10.7352C19.8122 9.73676 18.3259 9.17582 16.776 9.17582H15V5ZM23.3074 5H30.6406C31.849 4.99999 33.0323 5.31362 34.052 5.90417C35.0718 6.49472 35.8857 7.33774 36.3986 8.33453C36.9115 9.33132 37.1021 10.4406 36.9481 11.5325C36.7941 12.6244 36.3018 13.6538 35.5289 14.5C36.3018 15.3462 36.7941 16.3756 36.9481 17.4675C37.1021 18.5594 36.9115 19.6687 36.3986 20.6655C35.8857 21.6623 35.0718 22.5053 34.052 23.0958C33.0323 23.6864 31.849 24 30.6406 24H23.3074C25.1119 22.9702 26.5921 21.5313 27.6034 19.8242H30.6404C30.8736 19.8242 31.1046 19.7823 31.3201 19.701C31.5355 19.6197 31.7313 19.5005 31.8962 19.3502C32.0612 19.2 32.192 19.0216 32.2812 18.8253C32.3705 18.629 32.4164 18.4185 32.4164 18.206C32.4164 17.9935 32.3705 17.7831 32.2812 17.5868C32.192 17.3905 32.0612 17.2121 31.8962 17.0619C31.7313 16.9116 31.5355 16.7924 31.3201 16.7111C31.1046 16.6298 30.8736 16.5879 30.6404 16.5879H28.8644C29.1515 15.2083 29.1515 13.7917 28.8644 12.4121H30.6404C30.8736 12.4121 31.1046 12.3702 31.3201 12.2889C31.5355 12.2076 31.7313 12.0884 31.8962 11.9381C32.0612 11.7879 32.192 11.6095 32.2812 11.4132C32.3705 11.2169 32.4164 11.0065 32.4164 10.794C32.4164 10.5815 32.3705 10.371 32.2812 10.1747C32.192 9.9784 32.0612 9.80002 31.8962 9.64976C31.7313 9.49951 31.5355 9.38032 31.3201 9.299C31.1046 9.21768 30.8736 9.17582 30.6404 9.17582H27.6034C26.5921 7.46865 25.1119 6.02981 23.3074 5V5Z",fill:"currentColor"})})),type:"large",action:(e,t)=>{let{previousId:s}=t;return e({type:"insertSnippet",apply:(0,Ke.eu)((e=>"".concat(e("chart"),' = {\n  const width = 640;\n  const height = 400;\n  const margin = {top: 20, right: 30, bottom: 30, left: 40};\n\n  const x = d3.scaleUtc()\n      .domain(d3.extent(aapl, d => d.Date))\n      .range([margin.left, width - margin.right]);\n\n  const y = d3.scaleLinear()\n      .domain([0, d3.max(aapl, d => d.Close)])\n      .range([height - margin.bottom, margin.top]);\n\n  const svg = d3.create("svg")\n      .attr("width", width)\n      .attr("height", height);\n\n  svg.append("g")\n      .attr("transform", `translate(0,$\\{height - margin.bottom})`)\n      .call(d3.axisBottom(x));\n\n  svg.append("g")\n      .attr("transform", `translate($\\{margin.left},0)`)\n      .call(d3.axisLeft(y));\n\n  svg.append("path")\n      .attr("fill", "none")\n      .attr("stroke", "steelblue")\n      .attr("stroke-width", 1.5)\n      .attr("d", d3.line()\n        .x(d => x(d.Date))\n        .y(d => y(d.Close))\n        (aapl));\n\n  return svg.node();\n}'))),label:"D3 starter",mode:"js",afterId:s})}},{label:"SVG",category:"Graphics",description:"Expressive declarative graphics",icon:e=>(0,n.jsx)("svg",(0,_.Z)((0,H.Z)({width:"50",height:"30",viewBox:"0 0 50 30"},e),{children:(0,n.jsx)("path",{d:"M35 12.2308C35 15.5 29 20.0769 25 24C21 20.0769 15 15.5 15 12.2308C15 8.96154 17 7 19.6667 7C22.3333 7 24.3333 9.61538 25 10.9231C25.6667 9.61538 27.6667 7 30.3333 7C33 7 35 8.96154 35 12.2308Z",stroke:"currentColor",fill:"none",strokeWidth:"2"})})),type:"large",action:(e,t)=>{let{previousId:s}=t;return e({type:"insertSnippet",apply:pt('<svg width=${width} height="200" viewBox="0 0 ${width} 200">\n  <rect width="100%" height="100%" fill="hsl(216deg 100% 13%)" />\n</svg>'),label:"SVG",mode:"html",afterId:s})}},{label:"Canvas",category:"Graphics",description:"Low-level, high-performance",icon:e=>(0,n.jsxs)("svg",(0,_.Z)((0,H.Z)({width:"50",height:"30",viewBox:"0 0 50 30"},e),{children:[(0,n.jsx)("rect",{x:"30",y:"16",width:"9",height:"9",rx:"1",stroke:"currentColor",fill:"none",strokeWidth:"2"}),(0,n.jsx)("circle",{cx:"25.5",cy:"8.5",r:"5.5",fill:"currentColor",fillOpacity:"0.35"}),(0,n.jsx)("path",{d:"M16.433 12.75L21.6292 21.75C21.8216 22.0833 21.5811 22.5 21.1962 22.5H10.8038C10.4189 22.5 10.1784 22.0833 10.3708 21.75L15.567 12.75C15.7594 12.4167 16.2406 12.4167 16.433 12.75Z",fill:"currentColor",stroke:"#currentColor"})]})),type:"large",action:(e,t)=>{let{previousId:s}=t;return e({type:"insertSnippet",apply:(0,Ke.eu)((e=>"".concat(e("canvas"),' = {\n  const context = DOM.context2d(width, 200);\n  context.fillStyle = "hsl(216deg 100% 13%)";\n  context.fillRect(0, 0, width, 200);\n  return context.canvas;\n}'))),label:"Canvas",mode:"js",afterId:s})}}]},{title:"Imports",items:Ke.Xk.map((e=>mt(e,"js","Imports")))}],ht=[...["js","md","html"].map((e=>{const{label:t,icon:s}=se.qz[e];return{label:"Insert as ".concat(t),type:"small",icon:s,action:(t,s)=>{let{previousId:n,filter:r}=s;return t({type:"insertSnippet",apply:pt(r),label:"Insert",mode:e,afterId:n})}}})),{label:"Search",type:"small",icon:tt.Z,action:(e,t)=>{let{filter:s}=t;return e({type:"showModal",modal:"search",modalProps:{query:s}})}}];function ut(e){const{label:t,icon:s}=se.qz[e];return{type:"small",label:t,icon:s,action:(t,s)=>{let{nextId:n,trigger:r}=s;return t({type:"insertBefore",id:n,node:{mode:e},trigger:r,source:"nodeInserterMenu"})}}}function mt(e,t,s){var n;const r=null!==(n=e.shortLabel)&&void 0!==n?n:e.label;var i,a;return{type:"large",label:r,category:s,description:null!==(i=e.description)&&void 0!==i?i:"",icon:null!==(a=e.thumbnail)&&void 0!==a?a:Xe.Z,newUntil:e.newUntil,action:(s,n)=>{let{previousId:i}=n;return s({type:"insertSnippet",apply:e.apply,label:r,mode:t,afterId:i,imports:e.imports})}}}function pt(e){return(t,s,n,r)=>{t.dispatch(t.state.update({changes:{from:n,to:r,insert:e},selection:Ge.jT.cursor(n+e.length)}))}}function xt(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return(n,r,i,a)=>{n.dispatch(n.state.update({changes:{from:i,to:a,insert:e},selection:Ge.jT.range(t,e.length-s)}))}}for(const Ft of dt)for(const e of Ft.items)e.category=Ft.title;{const e=new Set;for(const t of dt)for(const s of t.items){for(;e.has(s.label);)s.label+=" ";e.add(s.label)}}function ft(e){e.dispatchEvent(new KeyboardEvent("keydown",{key:"ArrowDown",bubbles:!0}))}const gt=2592e5,vt=e=>{let{newUntil:t}=e;const s=+t-+new Date,r=s<gt?"saturate(".concat(s/gt,")"):void 0;return(0,n.jsx)("span",{className:"br2 ttu ml1 bg-faint-blue dark-blue",style:{padding:3,fontSize:"0.5rem",filter:r},children:"New"})},bt=e=>{let{item:t,onClick:s,labelMatcher:r,descriptionMatcher:a,isSuggestion:l,fuzzyMatch:o=!1}=e;const{label:c,type:d,newUntil:h,icon:u}=t;return(0,n.jsxs)(Ie.O2,{value:c,className:i()("combobox-option ph1 theme-blue",l&&"gold"),onClick:e=>s(e,c),children:["small"===d?(0,n.jsxs)("div",{className:"jsx-fba29814d32d7d5f flex justify-between items-center h2 pa1 br2 fw5",children:[(0,n.jsxs)("div",{className:"jsx-fba29814d32d7d5f truncate flex",children:[(0,n.jsxs)("div",{className:"jsx-fba29814d32d7d5f flex items-center",children:[l?(0,n.jsx)(Oe.v,{className:"mr1"}):null,r&&o?(0,n.jsx)(Te.q,{text:c,matcher:r}):c]}),h&&h>new Date&&(0,n.jsx)(vt,{newUntil:h})]}),(0,n.jsx)("div",{style:{width:16,height:16,boxSizing:"content-box"},className:"jsx-fba29814d32d7d5f "+(i()("thumbnail br-100 pa1 mid-gray ml2 bg-near-white highlight-blue flex-shrink-0",l&&"gold")||""),children:(0,n.jsx)(u,{style:{width:16,height:16},className:"jsx-fba29814d32d7d5f"})})]}):(0,n.jsxs)("div",{className:"jsx-fba29814d32d7d5f flex justify-between items-center ph1 pv2 br2",children:[(0,n.jsxs)("div",{className:"jsx-fba29814d32d7d5f flex-auto",children:[(0,n.jsxs)("div",{className:"jsx-fba29814d32d7d5f mb1 fw5 flex",children:[(0,n.jsx)("div",{className:"jsx-fba29814d32d7d5f",children:r&&o?(0,n.jsx)(Te.q,{text:c,matcher:r}):c}),h&&h>new Date&&(0,n.jsx)(vt,{newUntil:h})]}),(0,n.jsx)("div",{className:"jsx-fba29814d32d7d5f f7 gray highlight-inherit truncate pb1 nb1",children:!!t.description&&(a&&o?(0,n.jsx)(Te.q,{text:t.description,matcher:a}):t.description)})]}),(0,n.jsx)(u,{style:{width:50,height:30},className:"jsx-fba29814d32d7d5f thumbnail mid-gray ml2 br2 bg-near-white highlight-blue flex-shrink-0"})]}),(0,n.jsx)(z(),{id:"fba29814d32d7d5f",children:".combobox-option:hover .thumbnail{background-color:var(--silver)}"})]})};var jt=e=>{let{previousId:t,nextId:s,focusId:r,hoverId:l,insertingId:o,dispatch:c}=e;var d;const h=null!==r&&(r===t||r===s),u=null!==l&&(l===t||l===s),m=null!==t&&null!==s,{0:p,1:x}=(0,a.useState)(!1),{open:f,openMenu:g,closeMenu:v,triggerRef:b,uiRef:y}=(0,Ue.O)(),C=(0,a.useRef)(null),k=(0,a.useRef)(null),N=(0,a.useRef)(f),Z=(0,a.useRef)(),{0:L,1:M}=(0,a.useState)(""),S=(0,I.v9)((e=>{let{currentUser:t}=e;return null!==t})),R=(0,he.GS)(he.hs),E=S&&R,F=(0,I.v9)((e=>{let{currentUser:t,notebook:s}=e;return(0,V.Yb)(t)&&(0,j.j5)(t,s)})),T=(0,I.v9)((e=>{let{notebook:t}=e;return(0,w.cE)(t)})),P=(0,I.v9)((e=>{let{currentUser:t}=e;return(0,w.Sx)(t)})),{suggestions:A,previousNode:O,previousMode:U,previousName:B}=(0,I.v9)((e=>{let{notebook:s}=e;var n;if(null===t)return{};const r=(0,W.DY)(s.model,t);return r?{suggestions:null===(n=s.workerStatus.get(t))||void 0===n?void 0:n.suggestions,previousMode:r.mode,previousNode:r,previousName:(0,G.u2)(r)||"cell ".concat(t)}:{}})),q=(0,a.useMemo)((()=>L.length?(0,qe.v)(L,{allowAcronyms:!0}):null),[L]),K=(0,a.useMemo)((()=>L.length?(0,qe.v)(L,{allowAcronyms:!1}):null),[L]),Y=(0,a.useMemo)((()=>{const e={allowFileAttachments:F,allowPrivateData:T,suggestions:A||[],previousMode:U},t=q&&K?t=>(q.test(t.label)||K.test(function(e){const t=[e.label];return e.category&&t.push(e.category),e.description&&t.push(e.description),t.join("\n")}(t)))&&(!t.filter||t.filter(e)):t=>!t.filter||t.filter(e);return dt.map((e=>{var{items:s}=e,n=(0,ie.Z)(e,["items"]);return(0,_.Z)((0,H.Z)({},n),{items:s.filter(t)})})).filter((e=>e.items.length>0))}),[F,T,A,U,q,K]),$=!!(null===(d=Y.find((e=>{let{title:t}=e;return"Suggestions"===t})))||void 0===d?void 0:d.items.length),X=$&&(r===t||f),J=(0,ze.a)(k);function Q(e){requestAnimationFrame((()=>{var t,s;let n=null===(t=k.current)||void 0===t?void 0:t.querySelector("[data-highlighted]");null!==(null===n||void 0===n?void 0:n.previousSibling)&&(ft(e),n=null===(s=k.current)||void 0===s?void 0:s.querySelector("[data-highlighted]"),n||ft(e))}))}function ee(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"keypress";const r=Y.length?Y.flatMap((e=>e.items)).find((t=>t.label===e)):ht.find((t=>t.label===e));r&&(c({type:"closeInsertMenu",trigger:n,filter:L,selectedItem:e}),r.action(c,{nextId:s,previousId:t,trigger:n,filter:L,previousNode:O}))}function te(e,t){e.preventDefault(),ee(t,"click")}(0,a.useEffect)((()=>{const e=o===s;N.current!==e&&(N.current=e,e?g():(M(""),v()))}),[g,v,o,s,f]),(0,a.useEffect)((()=>{N.current!==f&&(N.current=f,f||(M(""),c({type:"closeInsertMenu",trigger:"Implicit",filter:L})))}),[c,f,L]),(0,a.useEffect)((()=>{if(!m)return;const e=e=>x(e.shiftKey),t=()=>x(!1);return addEventListener("keydown",e),addEventListener("keyup",e),addEventListener("blur",t),()=>{removeEventListener("keydown",e),removeEventListener("keyup",e),removeEventListener("blur",t)}}),[m]);const se=(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:i()("pa2",L?"bb b--light-gray":"absolute o-0"),children:(0,n.jsx)(Ie.gA,{ref:C,placeholder:"Filter",autocomplete:!1,spellCheck:!1,onChange:function(e){M(e.target.value),Q(e.target)},onKeyDown:J,onPaste:function(e){e.preventDefault();const s=e.clipboardData.getData("text");c({type:"insertSnippet",apply:pt(L+s),label:"Insert",mode:"js",afterId:t})},onFocus:function(e){Q(e.target)},className:"w-100 border-box",type:"search",value:L,autoFocus:!0})}),(0,n.jsx)(Ie.Gk,{ref:k,className:"relative",style:{maxHeight:"25em",overflowY:"scroll"},children:Y.length?Y.map(((e,t)=>{let{title:s,items:r}=e;return(0,n.jsxs)("div",{className:i()("pt2 mb2",t?"bt b--light-gray":""),children:[s&&(0,n.jsx)("div",{className:"gray f7 ph2 pv1",children:"Suggestions"===s?(0,n.jsxs)(n.Fragment,{children:["Suggestions for"," ",(0,n.jsx)("span",{className:"fw5",children:B})]}):K?(0,n.jsx)(Te.q,{text:s,matcher:K}):s}),r.map(((e,t)=>(0,n.jsx)(bt,{item:e,labelMatcher:q,descriptionMatcher:K,onClick:te,isSuggestion:"Suggestions"===e.category,fuzzyMatch:!0},t)))]},t)})):(0,n.jsx)("div",{className:"pt2 mb2",children:ht.map(((e,t)=>(0,n.jsx)(bt,{item:e,labelMatcher:q,descriptionMatcher:K,isSuggestion:!1,onClick:te},t)))})},L)]});return(0,n.jsxs)("div",{className:"absolute dn-print",style:{marginTop:1-D.KI,left:-D.KI-D.re/2-5},children:[(0,n.jsxs)("div",{ref:b,className:"jsx-7869de80898f8af0 absolute",children:[(0,n.jsx)("svg",{width:D.KI,height:D.KI-2,viewBox:"-8.5 -7.5 17 15",style:{overflow:"visible"},role:"button","aria-label":"Click to insert or merge cells",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",fill:"none",onClick:function(e){e.preventDefault(),window.matchMedia(he.ro).matches?Z.current&&(clearTimeout(Z.current),Z.current=void 0,c({type:"insertBefore",id:s,node:{mode:P},trigger:"click",source:"nodeInserter"})):m&&e.shiftKey?c({type:"merge",beforeId:t,afterId:s}):c(f?{type:"closeInsertMenu",trigger:"click",filter:L}:{type:"openInsertMenu",id:s,before:!0,trigger:"click",source:"nodeInserter"})},onPointerDown:function(){!N.current&&window.matchMedia(he.ro).matches&&(Z.current=setTimeout((()=>{c({type:"openInsertMenu",id:s,before:!0,trigger:"click",source:"nodeInserter"}),Z.current=void 0}),500))},onPointerCancel:function(){Z.current&&(clearTimeout(Z.current),Z.current=void 0)},onDoubleClick:function(e){e.shiftKey||(e.preventDefault(),c({type:"insertBefore",id:s,node:{mode:P},trigger:"click",source:"nodeInserter"}))},onMouseDown:Be.P,className:"jsx-7869de80898f8af0 "+(i()(f?"light-blue":h||u?"moon-gray":"transparent")||""),children:p?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("title",{className:"jsx-7869de80898f8af0",children:"Merge cells"}),(0,n.jsx)("path",{d:"M-3,4L0,1.5L3,4M0,1.5V6.5",className:"jsx-7869de80898f8af0"}),(0,n.jsx)("path",{d:"M-3,4L0,1.5L3,4M0,1.5V6.5",transform:"rotate(180)",className:"jsx-7869de80898f8af0"})]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("title",{className:"jsx-7869de80898f8af0",children:null!==r&&r===s?"Insert cell before (".concat((0,De.Z)("Shift-Mod-Enter"),")"):null!==r&&r===t?"Insert cell after (".concat((0,De.Z)("Mod-Enter"),")"):"Insert cell"}),(0,n.jsx)("path",{d:"M0,-4.5V4.5M-4.5,0H4.5",className:"jsx-7869de80898f8af0 "+((X?"gold":"")||"")}),f&&($?(0,n.jsx)("path",{d:"M31.5,0h14M-11.5,0h-14",style:{stroke:"var(--gold)"},opacity:"0.2",className:"jsx-7869de80898f8af0"}):(0,n.jsx)("path",{d:"M8.5,0h23M-8.5,0h-23",style:{stroke:"var(--faint-blue)"},className:"jsx-7869de80898f8af0"})),X?(0,n.jsxs)("g",{fill:"currentColor",stroke:"none",className:"jsx-7869de80898f8af0 gold",children:[(0,n.jsx)("circle",{r:"2",cx:"11",className:"jsx-7869de80898f8af0"}),(0,n.jsx)("circle",{r:"2",cx:"17",className:"jsx-7869de80898f8af0"}),(0,n.jsx)("circle",{r:"2",cx:"23",className:"jsx-7869de80898f8af0"}),(0,n.jsx)("rect",{x:"-8",y:"-7",height:"14",width:"36",rx:"7",opacity:"0.1",className:"jsx-7869de80898f8af0 pea pill"})]}):null]})}),(0,n.jsx)(z(),{id:"7869de80898f8af0",children:"svg.jsx-7869de80898f8af0{overflow:visible;will-change:transform}svg.jsx-7869de80898f8af0:not(.black):hover{color:var(--mid-gray)}svg.jsx-7869de80898f8af0:not(.black):active{color:var(--black)}.cursor.jsx-7869de80898f8af0{width:0;-webkit-transition:width.2s;-moz-transition:width.2s;-o-transition:width.2s;transition:width.2s;border-top-width:0;border-top-style:solid}.cursor.active.jsx-7869de80898f8af0{width:-webkit-calc(14rem - 17px);width:-moz-calc(14rem - 17px);width:calc(14rem - 17px);border-top-width:2px}.pill.jsx-7869de80898f8af0{visibility:hidden}.pill.jsx-7869de80898f8af0:hover{visibility:visible}.pill.jsx-7869de80898f8af0:active{opacity:.2}"})]}),f&&(0,n.jsx)(Pe.J,{extraStyle:{right:"auto",left:-2,top:10,width:"18rem",marginTop:"0.5rem"},ref:y,children:(0,n.jsx)(Ie.hQ,{"aria-label":"custom option demo",role:"dialog",onSelect:ee,onBlur:function(e){e.currentTarget.contains(e.relatedTarget)||v()},openOnFocus:!0,children:E?(0,n.jsx)(Ae.y,{type:"insertmenu",right:-3,top:24,children:se}):se})})]})},yt=s(84269),Vt=s(2334),wt=s(1864),Ct=s(730),kt=s(71675),Nt=s(75872),Zt=s(46802),Lt=s(86057),Mt=s(3338);const St=e=>(0,n.jsxs)("svg",(0,_.Z)((0,H.Z)({width:"16",height:"16",viewBox:"0 0 16 16",fill:"none"},e),{children:[(0,n.jsx)("mask",{id:"path-1-inside-1_528:41919",fill:"white",children:(0,n.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M5 1C2.79086 1 1 2.79086 1 5V11C1 13.2091 2.79086 15 5 15H11C13.2091 15 15 13.2091 15 11V5C15 2.79086 13.2091 1 11 1H5ZM11.868 6.94597L12.5639 6.22791L11.1278 4.83596L10.4318 5.55403L7.149 8.94108L5.67569 7.67824L4.91644 7.02745L3.61485 8.54597L4.37411 9.19676L6.56161 11.0718L7.2758 11.6839L7.93047 11.0085L11.868 6.94597Z"})}),(0,n.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M5 1C2.79086 1 1 2.79086 1 5V11C1 13.2091 2.79086 15 5 15H11C13.2091 15 15 13.2091 15 11V5C15 2.79086 13.2091 1 11 1H5ZM11.868 6.94597L12.5639 6.22791L11.1278 4.83596L10.4318 5.55403L7.149 8.94108L5.67569 7.67824L4.91644 7.02745L3.61485 8.54597L4.37411 9.19676L6.56161 11.0718L7.2758 11.6839L7.93047 11.0085L11.868 6.94597Z",fill:"currentColor"}),(0,n.jsx)("path",{d:"M12.5639 6.22791L14.0001 7.61985L15.392 6.18372L13.9559 4.79177L12.5639 6.22791ZM11.868 6.94597L10.4318 5.55403L10.4318 5.55403L11.868 6.94597ZM11.1278 4.83596L12.5198 3.39982L11.0836 2.00788L9.69167 3.44401L11.1278 4.83596ZM10.4318 5.55403L11.868 6.94597L11.868 6.94597L10.4318 5.55403ZM7.149 8.94108L5.84742 10.4596L7.2758 11.6839L8.58514 10.333L7.149 8.94108ZM5.67569 7.67824L6.97728 6.15973L6.97728 6.15973L5.67569 7.67824ZM4.91644 7.02745L6.21802 5.50894L4.69951 4.20736L3.39792 5.72587L4.91644 7.02745ZM3.61485 8.54597L2.09634 7.24438L0.794758 8.7629L2.31327 10.0645L3.61485 8.54597ZM4.37411 9.19676L5.67569 7.67824L5.67569 7.67824L4.37411 9.19676ZM6.56161 11.0718L5.26003 12.5903L5.26003 12.5903L6.56161 11.0718ZM7.2758 11.6839L5.97422 13.2024L7.40261 14.4268L8.71194 13.0759L7.2758 11.6839ZM7.93047 11.0085L9.3666 12.4004L9.3666 12.4004L7.93047 11.0085ZM3 5C3 3.89543 3.89543 3 5 3V-1C1.68629 -1 -1 1.68629 -1 5H3ZM3 11V5H-1V11H3ZM5 13C3.89543 13 3 12.1046 3 11H-1C-1 14.3137 1.68629 17 5 17V13ZM11 13H5V17H11V13ZM13 11C13 12.1046 12.1046 13 11 13V17C14.3137 17 17 14.3137 17 11H13ZM13 5V11H17V5H13ZM11 3C12.1046 3 13 3.89543 13 5H17C17 1.68629 14.3137 -1 11 -1V3ZM5 3H11V-1H5V3ZM11.1278 4.83596L10.4318 5.55403L13.3041 8.33792L14.0001 7.61985L11.1278 4.83596ZM9.73586 6.27209L11.172 7.66404L13.9559 4.79177L12.5198 3.39982L9.73586 6.27209ZM11.868 6.94597L12.5639 6.2279L9.69167 3.44401L8.9957 4.16208L11.868 6.94597ZM8.58514 10.333L11.868 6.94597L8.9957 4.16208L5.71286 7.54913L8.58514 10.333ZM4.37411 9.19676L5.84742 10.4596L8.45058 7.42257L6.97728 6.15973L4.37411 9.19676ZM3.61485 8.54597L4.37411 9.19676L6.97728 6.15973L6.21802 5.50894L3.61485 8.54597ZM5.13337 9.84755L6.43495 8.32904L3.39792 5.72587L2.09634 7.24438L5.13337 9.84755ZM5.67569 7.67824L4.91644 7.02745L2.31327 10.0645L3.07253 10.7153L5.67569 7.67824ZM7.86319 9.55324L5.67569 7.67824L3.07253 10.7153L5.26003 12.5903L7.86319 9.55324ZM8.57739 10.1654L7.86319 9.55324L5.26003 12.5903L5.97422 13.2024L8.57739 10.1654ZM6.49433 9.61653L5.83967 10.292L8.71194 13.0759L9.3666 12.4004L6.49433 9.61653ZM10.4318 5.55403L6.49433 9.61653L9.3666 12.4004L13.3041 8.33792L10.4318 5.55403Z",fill:"currentColor",mask:"url(#path-1-inside-1_528:41919)"})]}));var Ht=s(21142),_t=s(31115),Rt=s(99223);var Et=function(e){let{model:t,selection:s,selectionFocusId:r,dispatch:l}=e;const o=(0,Rt.dZ)({selection:s,selectionFocusId:r}),c=(0,_t.G)(o,(e=>!(0,W.DY)(t,e).pinned)),d=(0,_t.G)(o,(e=>(0,$.qU)((0,W.DY)(t,e)))),u=(0,_t.G)(o,(e=>{const s=(0,W.t$)(t,e);return null!==s&&!o.has(s)})),p=(0,_t.G)(o,(e=>{const s=(0,W.o4)(t,e);return null!==s&&!o.has(s)})),{0:x,1:f}=(0,a.useState)(0);return(0,n.jsx)(xe.h,{children:(0,n.jsx)("div",{className:"fixed left-0 right-0 bottom-0 pv2 z-1 bg-white b--silver bt near-black",children:(0,n.jsx)(Ht.Z,{className:"w-100",children:(0,n.jsxs)("div",{className:"flex relative",style:{marginLeft:-14,marginRight:-14},children:[(0,n.jsxs)("div",{className:"absolute h-100 nowrap flex items-center fw6 pr2",style:{right:"100%"},children:[o.size.toLocaleString("en")," ",1===o.size?"cell":"cells"]}),(0,n.jsx)(m.hA,{icon:Mt.Z,title:"Run cells ".concat((0,De.Z)("Shift-Enter")),onClick:()=>l({type:"selectionRun"})}),(0,n.jsx)(m.hA,{icon:Ve.Z,title:"".concat(c?"Pin cells":"Unpin cells"," ").concat((0,De.Z)("P")),className:c?"ml2":"blue ml2",joinRight:!0,onClick:()=>l({type:"selectionPin"})}),(0,n.jsx)(m.hA,{icon:d?Lt.Z:Zt.Z,title:"".concat(d?"Hide":"Show"," output ").concat((0,De.Z)(",")),className:"ml2",joinLeft:!0,onClick:()=>l({type:"selectionHide"})}),(0,n.jsx)(m.hA,{icon:s.size?St:fe.Z,title:null===r||s.size?"Clear selection ".concat((0,De.Z)("Escape")):"Toggle selection ".concat((0,De.Z)("X")),className:i()("ml2",s.size?"blue":""),onClick:()=>{null===r||s.size?l({type:"selectionBlur"}):l({type:"selectionToggle",id:r})}}),(0,n.jsx)(m.hA,{icon:Nt.Z,title:"Move cells up ".concat((0,De.Z)("Alt-Up")),className:"ml2",disabled:!u,joinRight:!0,onClick:()=>l({type:"selectionMoveUp"})}),(0,n.jsx)(m.hA,{icon:kt.Z,title:"Move cells down ".concat((0,De.Z)("Alt-Down")),className:"ml2",disabled:!p,joinLeft:!0,onClick:()=>l({type:"selectionMoveDown"})}),(0,n.jsx)(m.hA,{icon:ye.Z,title:"Duplicate cells ".concat((0,De.Z)("Shift-Alt-Down")),className:"ml2",onClick:e=>l({type:"selectionDuplicate",before:e.shiftKey})}),(0,n.jsx)(m.hA,{icon:h.Z,title:"Delete cells ".concat((0,De.Z)("D")),className:"ml2",destructive:0!==x,text:x?"Delete?":"",onClick:()=>{x?(l({type:"selectionDelete"}),window.clearTimeout(x),f(0)):f(window.setTimeout((()=>f(0)),2500))}}),(0,n.jsx)("div",{className:"flex flex-grow-1"}),(0,n.jsx)(m.hA,{icon:we.Z,title:"Clear selection ".concat((0,De.Z)("Escape")),className:"ml2",transparent:!0,onClick:()=>l({type:"selectionClear"})})]})})})})};const Dt=e=>{let{notebook:t,dispatch:s,editors:r,currentUser:l,editorComponent:o,disablePointerEvents:c=!1,isNodeCommentable:d=(()=>!1),isEditorAlwaysOpen:h=(()=>!1),editable:u=!0}=e;const{model:m,safe:p,heights:x,focusId:f,selection:g,selectionFocusId:v,editorStates:b,dragId:j,dropId:y,hoverId:V}=t;!function(e,t,s,n){const{0:r,1:i}=(0,a.useState)(Ee.Qg&&!!location.hash),{0:l,1:o}=(0,a.useState)(!0),c=(0,a.useRef)();(0,a.useEffect)((()=>{if(r){const e=setTimeout((()=>o(!1)),3e3);return()=>clearTimeout(e)}}),[r]),(0,a.useEffect)((()=>{if(r){const r=location.hash.slice(1);let h=!1,u=201;if(r.startsWith("comment-")){const e=document.getElementById(r);if(e)u=e.getBoundingClientRect().top,h=!0;else{const e=r.slice(8);for(const[t,r]of s)if(r.some((t=>t.id===e))){n({type:"showComments",nodeId:t,trigger:"Implicit",source:"hash"});break}}}else for(const s of e){var a,d;if(l&&!(null===(a=t.get(s.id))||void 0===a?void 0:a.worker))break;if((0,G.u2)(s)===r||"cell-".concat(s.id)===r){h=!0;break}u+=((null===(d=t.get(s.id))||void 0===d?void 0:d.total)||0)+D.KI}if(h)if(l)c.current&&clearTimeout(c.current),c.current=setTimeout((()=>o(!1)),150);else{const e=u-D.MT-5;Math.abs(window.scrollY-e)>D.MT&&scrollTo(0,e),i(!1)}else l||i(!1)}return()=>{c.current&&clearTimeout(c.current)}}),[r,l,e,t,s,n])}(m.nodes,x,t.comments,s);const C=(0,w.os)(t);return(0,n.jsxs)("div",{className:"relative notebook z-0 pb6",onMouseLeave:()=>s({type:"hover",id:null}),children:[!p&&(0,n.jsx)("div",{className:i()("absolute w-100",null!==j||c?"pen":""),style:{top:-D.KI,overflowAnchor:"none"},children:(0,n.jsx)(yt.Z,{state:t,dispatch:s,currentUser:l})}),u&&(0,n.jsx)(jt,{previousId:null,nextId:m.nodes[0].id,focusId:f,hoverId:V,insertingId:t.insertingId,dispatch:s}),m.nodes.map(((e,i,l)=>{var c,m;const{id:j,pinned:w}=e,k=b.get(j);if(!k)return null;const N=k.field(Vt.A),Z=k.field(wt.C),L=f===j,M=x.get(j),S=M?M.display+M.worker:0,H=(0,G.cS)(e),_=b.get(j).field(Ct.JN),R=u&&(h(j)||p||w||L||H||"none"===(null===(c=e.data)||void 0===c||null===(m=c.display)||void 0===m?void 0:m.mode)||!!_.length||!(0,G.QF)(e)||t.searchResultsVisible&&!!t.searchResults&&t.searchResults.has(e.id)),E=M?M.editor+S:0;return(0,n.jsxs)(a.Fragment,{children:[y===j&&(0,n.jsx)(re,{}),(0,n.jsx)(Fe,{node:e,height:E,outputHeight:S,focused:L,editorOpen:R,hovered:V===j,selecting:g.size>0,selected:g.has(j),selectionFocused:v===j,readOnly:C,mode:Z,commentable:d(j),editable:u}),(0,n.jsx)(ne,{node:e,editorState:k,focused:L,selected:g.has(j),selectionFocused:v===j,editorOpen:R,workerHeight:M?M.worker:0,editors:r,hovered:V===j,editorComponent:o,hasPrevious:i>0,hasNext:i<l.length-1}),u&&!C&&(0,n.jsx)(jt,{previousId:j,nextId:i<l.length-1?l[i+1].id:null,focusId:f,hoverId:V,insertingId:t.insertingId,dispatch:s})]},N)})),null===y&&(0,n.jsx)(re,{}),(g.size||null!==v)&&(0,n.jsx)(Et,{model:m,selection:g,selectionFocusId:v,dispatch:s})]})}},21142:function(e,t,s){var n=s(41799),r=s(69396),i=s(99534),a=s(85893),l=s(60357),o=s.n(l),c=s(94184),d=s.n(c),h=(s(67294),s(52433)),u=s(12447),m=s(4242);t.Z=(0,m.$j)((e=>{let{page:t}=e;return{paddingRight:null!==t.pane&&(0,h.wo)(t.pane).width,paddingLeft:t.collectionsSidebarOpen?216:0}}))((e=>{var{className:t="",children:s,paddingRight:l,paddingLeft:c}=e,h=(0,i.Z)(e,["className","children","paddingRight","paddingLeft"]);return(0,a.jsxs)("div",(0,r.Z)((0,n.Z)({},h),{className:o().dynamic([["b9104e8a53b967b6",[u.hs,l?"calc(max(".concat(l,"px - max((100vw - var(--max-width-8))/2, 0px), var(--spacing-extra-large) - var(--spacing-large)) + var(--spacing-large))"):"var(--spacing-extra-large)",l?"calc(max(".concat(l,"px - max((100vw - var(--max-width-page))/2, 0px), 0px) + var(--spacing-large))"):"var(--spacing-large)",c?"calc(max(".concat(c,"px + var(--spacing-large) - max((100vw - var(--max-width-page))/2, 0px), 0px) + var(--spacing-large))"):"var(--spacing-large)"]]])+" "+(h&&null!=h.className&&h.className||d()(c?"mw-page":"mw8","mw-page-xl center ph4 pr5-l body",t)||""),children:[s,(0,a.jsx)(o(),{id:"b9104e8a53b967b6",dynamic:[u.hs,l?"calc(max(".concat(l,"px - max((100vw - var(--max-width-8))/2, 0px), var(--spacing-extra-large) - var(--spacing-large)) + var(--spacing-large))"):"var(--spacing-extra-large)",l?"calc(max(".concat(l,"px - max((100vw - var(--max-width-page))/2, 0px), 0px) + var(--spacing-large))"):"var(--spacing-large)",c?"calc(max(".concat(c,"px + var(--spacing-large) - max((100vw - var(--max-width-page))/2, 0px), 0px) + var(--spacing-large))"):"var(--spacing-large)"],children:"@media ".concat(u.hs,"{.body.__jsx-style-dynamic-selector{padding-right:").concat(l?"calc(max(".concat(l,"px - max((100vw - var(--max-width-8))/2, 0px), var(--spacing-extra-large) - var(--spacing-large)) + var(--spacing-large))"):"var(--spacing-extra-large)","}}@media screen and (min-width:90em){.body.__jsx-style-dynamic-selector{padding-right:").concat(l?"calc(max(".concat(l,"px - max((100vw - var(--max-width-page))/2, 0px), 0px) + var(--spacing-large))"):"var(--spacing-large)","}}@media screen and (min-width:60em){.body.__jsx-style-dynamic-selector{padding-left:").concat(c?"calc(max(".concat(c,"px + var(--spacing-large) - max((100vw - var(--max-width-page))/2, 0px), 0px) + var(--spacing-large))"):"var(--spacing-large)","}}")})]}))}))},1105:function(e,t,s){s.d(t,{H:function(){return n},r:function(){return r}});const n="The paused version is shown by default when others visit or import from this".concat("\u202f","notebook."),r="The paused version is shown and imported by".concat("\u202f","default.")},56367:function(e,t,s){s.d(t,{R:function(){return d}});var n=s(85893),r=s(68337),i=s.n(r),a=s(67294),l=s(84193),o=s(602);const c=i()().add("@",{validate(e,t,s){const n=e.slice(t);s.re.mention||(s.re.mention=new RegExp("^([a-zA-Z0-9_-]){1,39}(?!_)(?=$|".concat(s.re.src_ZPCc,")")));const r=s.re.mention.exec(n);var i;return r?!(t>=2&&!(null===(i=e[t-2].match(/(\s|^)/g))||void 0===i?void 0:i[0].length))&&r[0].length:0},normalize(e){e.url="/".concat(e.url)}}),d=e=>{let{content:t}=e;const s=[];let r=0,i=0;const d=t.split("\n"),h=c.match(t),u=new Map,m=h?h.filter((e=>"@"===e.schema)):[],{data:p}=(0,o.h_)(m.length?"/users-exist?".concat(m.map((e=>"login=".concat(e.text.substring(1).toLowerCase()))).sort().join("&")):null);if(p)for(const[n,a]of p)a&&"unavailable"!==a?u.set(n,!0):u.set(n,!1);for(const o of d){const e=c.match(o);if(e){let t=0;for(const{index:i,lastIndex:c,schema:d,text:h,url:m}of e)i>t&&s.push((0,n.jsx)(a.Fragment,{children:o.substring(t,i)},++r)),"@"===d?u.get(h.substring(1).toLowerCase())?s.push((0,n.jsx)(l.Z,{href:m.toLowerCase(),children:(0,n.jsx)("a",{rel:"noopener noreferrer ugc",className:"no-underline black hover-blue",children:h},++r)})):s.push((0,n.jsx)(n.Fragment,{children:h})):s.push((0,n.jsx)(l.Z,{href:m,children:(0,n.jsx)("a",{rel:"nofollow noopener noreferrer ugc",className:"no-underline black hover-blue",children:h},++r)})),t=c;o.length>t&&s.push((0,n.jsx)(a.Fragment,{children:o.substring(t)},++r))}else s.push((0,n.jsx)(a.Fragment,{children:o},++r));d.length>1&&++i<d.length&&s.push((0,n.jsx)("br",{},++r))}return(0,n.jsx)(n.Fragment,{children:s})}},78009:function(e,t,s){s.d(t,{l:function(){return m}});var n=s(41799),r=s(69396),i=s(99534),a=s(85893),l=s(94184),o=s.n(l),c=(s(67294),s(8385)),d=s(45578),h=s(730),u=s(27193);const m=(0,s(4242).$j)((e=>{let{notebook:{spotlightParticipant:t}}=e;return{spotlightParticipant:t}}),(e=>({dispatch:e})))((e=>{const{dispatch:t,participants:s,spotlightParticipant:l,size:m}=e,p=(0,i.Z)(e,["dispatch","participants","spotlightParticipant","size"]);return s.length?(0,a.jsx)("div",(0,r.Z)((0,n.Z)({className:"flex flex-row-reverse"},p),{children:s.map(((e,n)=>(0,a.jsx)("button",{className:o()(!e.self&&"pointer","bg-transparent pa0 ma0 bn tooltipped tooltipped-sw"),"aria-label":e.self?"You":l===e.id?"Stop spotlighting ".concat((0,u.KY)(e)):"Spotlight ".concat((0,u.KY)(e)),disabled:e.self,style:{marginLeft:(.6*-m*s.length-1)/s.length},children:(0,a.jsx)(d.Gz,{owner:e,containerStyle:"fit",children:(0,a.jsx)(c.q,{onClick:()=>{e.self||t({type:"spotlight",id:l===e.id?null:e.id})},user:e,size:m,style:{borderColor:(0,h.Zt)(n),boxShadow:l===e.id?"0 0 8px ".concat((0,h.Zt)(n)):"none"},className:"br-100 ba bw1"})})},n)))})):null}))},9172:function(e,t,s){s.d(t,{X:function(){return d},h:function(){return c}});var n=s(41799),r=s(69396),i=s(99534),a=s(85893),l=s(94184),o=s.n(l);const c=e=>{var{children:t,className:s=""}=e,l=(0,i.Z)(e,["children","className"]);return(0,a.jsx)("div",(0,r.Z)((0,n.Z)({className:o()("flex sticky z-3 top-0 bg-white justify-between items-center pa3 bb b--light-silver br3 br--top f5 fw6 lh-title near-black",s)},l),{children:t}))},d=e=>{var{children:t,className:s="",forceScrollable:l=!1}=e,c=(0,i.Z)(e,["children","className","forceScrollable"]);return(0,a.jsx)("div",(0,r.Z)((0,n.Z)({className:o()(l?"overflow-y-scroll":"overflow-y-auto ","w-100",s)},c),{children:t}))}},52433:function(e,t,s){s.d(t,{YE:function(){return Bt},wo:function(){return Ut}});var n=s(85893),r=s(60357),i=s.n(r),a=s(94184),l=s.n(a),o=s(5152),c=s.n(o),d=s(67294),h=s(89905),u=s(22027),m=s(9172),p=s(37497),x=s(30238),f=s(64804),g=s(3764),v=s(63231),b=s(28041),j=s(1099),y=s(26492),V=s(47311),w=s(98768),C=s(45532),k=s(22513),N=s(42568),Z=s(12627),L=s(48627),M=s(3961),S=s(602),H=s(3894),_=s(27193),R=s(66421),E=s(3142),D=s(84236),F=s(47692),I=s(36448),T=s(4242);const P=e=>{let{db:t,table:s,visible:r}=e;const a=(0,T.I0)(),{expandedTables:l,tableSchemas:o}=(0,T.v9)((e=>{let{page:t}=e;return{expandedTables:t.expandedTables,tableSchemas:t.tableSchemas}})),c=(0,H.hS)(t,s),h=l.has(c),m=o.get(c),p=h&&!m,x=(0,d.useRef)();return(0,d.useEffect)((()=>{if(p){const e=new L.n4(t,s,"sql");x.current=e,e.run(a).then((n=>{e===x.current&&a({type:"updateDatabasesPaneTableSchema",db:t,table:s,columns:n})}),(()=>{e===x.current&&a({type:"updateDatabasesPaneTableSchema",db:t,table:s,columns:null})}))}}),[t,s,p,a]),r?(0,n.jsxs)("div",{className:"jsx-97de0a3c7c913c4e ml2 mr1",children:[(0,n.jsxs)("div",{className:"jsx-97de0a3c7c913c4e copy-container hover-bg-near-white flex",children:[(0,n.jsx)("button",{onClick:()=>a({type:"toggleDatabasesPaneTable",db:t,table:s}),className:"jsx-97de0a3c7c913c4e bn br2 mw-90 overflow-hidden bg-transparent pointer flex pa1 items-center",children:(0,n.jsxs)("div",{className:"jsx-97de0a3c7c913c4e overflow-hidden flex items-center",children:[(0,n.jsx)(C.s,{className:"pr1",style:{flexShrink:0}}),(0,n.jsx)("div",{className:"jsx-97de0a3c7c913c4e fw5 truncate dark-gray",children:(0,D.Vi)(s)})]})}),(0,n.jsx)("button",{title:"Copy name",onClick:e=>{e.stopPropagation(),navigator.clipboard.writeText(function(e){let{database:t,schema:s,table:n}=e;return(0,H.VS)({database:t&&z(t),schema:s&&z(s),table:z(n)})}(s))},className:"jsx-97de0a3c7c913c4e copy bg-transparent squishy pl0 pointer bn br2 gray flex items-center",children:(0,n.jsx)(f.Z,{})}),(0,n.jsx)("div",{className:"jsx-97de0a3c7c913c4e mt1",children:h&&(void 0===m?(0,n.jsx)(u.Z,{}):null===m?(0,n.jsx)(k.Z,{className:"red"}):null)})]}),h&&m&&(0,n.jsx)("div",{className:"jsx-97de0a3c7c913c4e pl1 pb2",children:Array.from(m,(e=>{let[t,s]=e;return(0,n.jsxs)("div",{className:"jsx-97de0a3c7c913c4e w-100 flex justify-between pv1 pl2 items-center copy-container",children:[(0,n.jsx)("span",{style:{maxWidth:"70%"},className:"jsx-97de0a3c7c913c4e truncate dark-gray",children:t}),(0,n.jsx)("button",{title:"Copy name",onClick:e=>{e.stopPropagation(),navigator.clipboard.writeText(function(e){return z(e)}(t))},className:"jsx-97de0a3c7c913c4e copy mr-auto bg-transparent nt1 nb1 squishy pointer bn gray flex items-center br2",children:(0,n.jsx)(f.Z,{})}),(0,n.jsx)("span",{style:{maxWidth:"30%"},title:s.databaseType,className:"jsx-97de0a3c7c913c4e gray br2",children:s.type})]},t)}))}),(0,n.jsx)(i(),{id:"97de0a3c7c913c4e",children:".copy.jsx-97de0a3c7c913c4e{visibility:hidden}.copy-container.jsx-97de0a3c7c913c4e:hover .copy.jsx-97de0a3c7c913c4e{visibility:visible}"})]}):null},A=e=>{let{db:t,owner:s,readOnly:r}=e;const i=(0,T.I0)(),{expandedDatabases:a,databaseSchemas:l}=(0,T.v9)((e=>{let{page:t}=e;return{expandedDatabases:t.expandedDatabases,databaseSchemas:t.databaseSchemas}})),o=(0,T.v9)((e=>{let{currentUser:t}=e;return t})),c=(0,H.x2)(t),h=a.has(c),m=l.get(c),g=h&&!m,b=(0,d.useRef)(),y=(0,R.Vu)(o,s);return(0,d.useEffect)((()=>{if(g){const e=new L.Y2(t);b.current=e,e.run(i).then((s=>{e===b.current&&i({type:"updateDatabasesPaneDatabaseSchema",db:t,tables:s})}),(()=>{e===b.current&&i({type:"updateDatabasesPaneDatabaseSchema",db:t,tables:null})}))}}),[t,g,i]),(0,n.jsxs)("div",{className:"ma3 f7",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsx)("button",{onClick:()=>i({type:"toggleDatabasesPaneDatabase",db:t}),className:"w-100 bn br2 bg-transparent hover-bg-near-white pointer",children:(0,n.jsxs)("div",{className:"flex items-center ",children:[(0,n.jsxs)("div",{className:"tl",children:[(0,n.jsx)("div",{className:"pb1 fw6 near-black",children:t.name}),(0,n.jsxs)("div",{className:"gray",children:[(0,H.w4)(t.dialect)||"Unknown","DatabaseClient"===t.type&&"team"===s.type&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("span",{className:"light-gray",children:" \u2022 "}),(0,_.KY)(s)]})]})]}),(0,n.jsx)("div",{children:h&&(void 0===m?(0,n.jsx)(u.Z,{className:"ml2"}):null===m?(0,n.jsx)(k.Z,{className:"red ml2"}):null)})]})}),(0,n.jsxs)("div",{className:"flex flex-shrink-0 items-center",children:[(0,n.jsx)(p.hU,{icon:x.Z,onClick:()=>i({type:"insertDatabase",source:t}),title:"Insert into notebook"}),(0,n.jsxs)(N.v2,{children:[(0,n.jsx)(p.hU,{icon:j.v,title:"Database actions",colorless:!0,asMenuButton:!0,disabled:r}),(0,n.jsxs)(N.qy,{style:{width:200},children:[(0,n.jsxs)(N.sN,{onSelect:()=>i({type:"refreshDatabasesPaneSchema",db:t}),disabled:r,children:[(0,n.jsx)(w.Z,{className:"mr2"})," Refresh schema"]}),(0,n.jsxs)(N.sN,{onSelect:()=>i({type:"insertDatabase",source:t}),disabled:r,children:[(0,n.jsx)(x.Z,{className:"mr2"})," Insert into notebook"]}),"DatabaseClient"===t.type&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(N.sN,{onSelect:()=>i({type:"copyDatabaseCode",db:t}),children:[(0,n.jsx)(f.Z,{className:"mr2"})," Copy usage code"]}),y&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(N.R,{}),(0,n.jsxs)(N.Uk,{href:"".concat((0,I.rF)(s),"/databases?edit=").concat(encodeURIComponent(t.name)),className:"nowrap",children:[(0,n.jsx)(v.Z,{className:"mr2","aria-label":"Database actions"}),"Edit details"]})]})]})]})]})]})]}),null===m||void 0===m?void 0:m.map((e=>(0,n.jsx)(P,{visible:h,db:t,table:e},(0,H.VS)(e))))]})},O=()=>{const e=(0,T.I0)(),{nodes:t,owner:s,files:r,allowsConnections:i,teamNotebook:a,readOnly:o}=(0,T.v9)((e=>{let{notebook:t}=e;return{nodes:t.model.nodes,owner:t.owner,files:t.files,allowsConnections:(0,E.cE)(t),teamNotebook:(0,E.p0)(t),readOnly:(0,E.os)(t)}})),c=(0,d.useRef)(),{0:h,1:u}=(0,d.useState)([]);(0,d.useEffect)((()=>{const t=[],s=new M.S((async(e,n)=>{e({type:"request_data_sources",mode:"table"});try{for await(const e of n()){if(c.current!==s)return;const{name:n,dialect:r}=e,i={name:"".concat(n),type:"cell",dialect:(0,H.Ov)(r)};t.push(i),t.sort(H.zO),u(t.slice())}}catch(r){console.error("Error fetching database clients: ",r)}}));return c.current=s,s.run(e),()=>{c.current=void 0,u([])}}),[e]);const{databaseClients:x}=(0,F.Z)(t),{data:f}=(0,S.h_)(x.size>0&&i?"".concat(a?"/team/".concat(s.id):"/user","/data-connectors?detail=false"):null),v=(0,d.useMemo)((()=>f?f.map((e=>({name:e.name,type:"DatabaseClient",dialect:(0,H.h8)(e.type)}))):[]),[f]).filter((e=>{let{name:t}=e;return x.has(t)})),j=(0,d.useMemo)((()=>{const e=[];for(const[t,s]of r){const n=(0,Z.S5)(s);null===n||(0,E.Jw)(s)||e.push({name:t,type:"FileAttachment",dialect:n})}return e}),[r]);return(0,n.jsxs)(m.X,{children:[(0,n.jsx)(m.h,{children:"Databases"}),(0,n.jsxs)("div",{className:"mb3",children:[(0,n.jsxs)("div",{className:"ph3 pt3 f6 fw6 flex justify-between items-center",children:[(0,n.jsxs)("div",{className:l()("flex items-center",i?"near-black":"gray"),children:[(0,n.jsx)(g.Z,{className:l()("mr2 pa1 br2",i?"bg-near-white":"bg-white moon-gray")}),"Database connections"]}),(0,n.jsx)(p.hU,{onClick:()=>e({type:"showModal",modal:"addDatabase"}),icon:V.ZP,"aria-label":"Add database",colorless:!0,disabled:o||!i,className:"nt2 nb2"})]}),!i&&(0,n.jsx)("div",{className:"ph3 pt2 gray f7",children:"Only available in private notebooks"}),v.length>0&&v.map((e=>(0,n.jsx)(A,{db:e,owner:s,readOnly:o},(0,H.x2)(e)))),h.length>0&&(0,n.jsx)("div",{className:"ph3 pt3 mt3 f6 fw6 flex justify-between items-center bt b--light-silver",children:(0,n.jsxs)("div",{className:"flex items-center near-black",children:[(0,n.jsx)(y.Z,{className:"mr2 pa1 br2 bg-near-white"}),"Database cells"]})}),h.length>0&&h.map((e=>(0,n.jsx)(A,{db:e,owner:s,readOnly:o},(0,H.x2)(e)))),j.length>0&&(0,n.jsx)("div",{className:"ph3 pt3 mt3 f6 fw6 flex justify-between items-center bt b--light-silver",children:(0,n.jsxs)("div",{className:"flex items-center near-black",children:[(0,n.jsx)(b.Z,{className:"mr2 pa1 br2 bg-near-white"}),"Database files"]})}),j.length>0&&j.map((e=>(0,n.jsx)(A,{db:e,owner:s,readOnly:o},(0,H.x2)(e))))]})]})};function z(e){return/[^0-9A-Z$_]/i.test(e)?'"'.concat(e.replaceAll('"','""'),'"'):e}var U=s(34091),B=s(26959),q=s(84193),W=s(74080),G=s(56912),K=s(928);const Y=()=>{const e=(0,T.I0)(),t=(0,T.v9)((e=>{let{notebook:t}=e;return t})),s=(0,T.v9)((e=>{let{page:{dependenciesPaneSpecifier:t}}=e;return t}));(0,d.useEffect)((()=>{const t=setTimeout((()=>{s&&e({type:"removeDependenciesPaneSpecifier"})}),3e3);return()=>clearTimeout(t)}),[s,e]);const r=(0,G.uF)(t),i=(0,G.uF)(t,{ignoreResolutions:!0});return r&&i?(0,n.jsx)($,{dispatch:e,notebook:t,importData:r,latestImportData:i,selectedSpecifier:s}):(0,n.jsxs)(m.X,{children:[(0,n.jsx)(m.h,{children:"Dependencies"}),(0,n.jsx)("div",{className:"flex justify-center pa3",children:(0,n.jsx)(u.Z,{})})]})},$=e=>{let{dispatch:t,notebook:s,importData:r,latestImportData:a,selectedSpecifier:o}=e;const{directImports:c}=(0,d.useMemo)((()=>(0,G.$r)(r)),[r]),{0:h,1:u}=(0,d.useState)(new Map),x=(0,d.useRef)(!0);(0,d.useEffect)((()=>{const e=setTimeout((()=>{x.current=!1}),1e3);return()=>clearTimeout(e)}),[]);const f=(0,R.mG)(s),g=(0,E.os)(s)||!(f&&(0,W.QY)(s))||s.isCompare,v=s.trashed?" because the notebook is in the trash":f?s.isCompare?" while in compare mode":"aborted"===s.clientState?" because there was a connection error":s.autosave?s.isReverting?" because the notebook is reverting":(0,E.os)(s)?" because the notebook is read-only":null:" while viewing history":" because you don\u2019t have permission to edit this notebook",b=new Set(Array.from(c).flatMap((e=>{let[t,s]=e;return[t,...s.map((e=>{let[,t]=e;return t}))]}))),y=new Map(Object.entries(a.specifiers).slice(1).flatMap((e=>{let[t,s]=e;return(0,G.xT)(s)?[]:[[t,K.Z.parse(s.resolution)]]}))),V=new Set(Object.entries(r.specifiers).slice(1).filter((e=>{let[,t]=e;return(0,G.xT)(t)})).map((e=>{let[t]=e;return t}))),w=new Map([...y].filter((e=>{let[t]=e;var s;return!(null===(s=K.Z.parse(t))||void 0===s?void 0:s.version)}))),C=new Map(s.model.resolutions.filter((e=>"notebook"===e.type)).map((e=>[e.specifier,K.Z.parse(e.value)]))),k=new Map([...w].filter((e=>{let[t,s]=e;const n=C.get(t);return n&&void 0!==n.version&&n.version!==s.version}))),Z=[...k.keys()].filter((e=>b.has(e))).length;function L(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const s=new Map(h);if(e)for(const[t,r]of k)s.set(t,r.version);else for(const[t,r]of w){var n;(null===(n=C.get(t))||void 0===n?void 0:n.version)||s.set(t,r.version)}[...C].forEach((e=>{let[t]=e;y.has(t)||s.set(t,void 0)})),t({type:"toggleDependencyLock",locked:!0,bulk:!0}),u(s)}function M(e,t){if(!y.get(e))return;const s=C.has(e)?C.get(e).version:null,n=new Map(h);t==s?n.delete(e):n.set(e,t),u(n)}return(0,n.jsxs)(m.X,{children:[(0,n.jsx)(m.h,{children:"Dependencies"}),c.size>0?(0,n.jsxs)(n.Fragment,{children:[g?(0,n.jsxs)("div",{className:i().dynamic([["6f12096f9dcdc32a",[x.current?"0.25s":"0s"]]])+" f7 pa3 bb b--light-silver bg-washed-yellow",children:["Dependency changes cannot be made",v,"."]}):null,(0,n.jsxs)("div",{className:i().dynamic([["6f12096f9dcdc32a",[x.current?"0.25s":"0s"]]])+" pa3 flex items-center justify-between lh-copy f6 bb b--light-silver",children:[(0,n.jsx)("div",{className:i().dynamic([["6f12096f9dcdc32a",[x.current?"0.25s":"0s"]]])+" "+(l()("mr2",Z?"fw7":"")||""),children:Z?(0,E.YY)(Z,"update available","updates available"):"No updates available"}),(0,n.jsx)(p.KM,{disabled:g||!Z,onClick:()=>L(!0),text:"Update all",className:"nowrap nr2"}),(0,n.jsxs)(N.v2,{children:[(0,n.jsx)(p.hU,{icon:j.v,title:"Notebook import actions",colorless:!0,asMenuButton:!0}),(0,n.jsxs)(N.qy,{position:N.Ly.bottomLeft,children:[(0,n.jsx)(N.sN,{disabled:g,onSelect:L,children:"Lock all"}),(0,n.jsx)(N.sN,{disabled:g,onSelect:function(){t({type:"toggleDependencyLock",locked:!1,bulk:!0}),u(new Map([...C].map((e=>{let[t]=e;return[t,y.has(t)?null:void 0]}))))},children:"Unlock all"})]})]})]}),(0,n.jsxs)("div",{className:i().dynamic([["6f12096f9dcdc32a",[x.current?"0.25s":"0s"]]])+" pa3",children:[(0,n.jsx)("div",{className:i().dynamic([["6f12096f9dcdc32a",[x.current?"0.25s":"0s"]]])+" pv2 f6 fw6 lh-title near-black",children:"Direct imports"}),Array.from(b).filter((e=>c.has(e))).sort().map((e=>{var t,s;return(0,n.jsx)("div",{"data-cy":"notebook-import",className:i().dynamic([["6f12096f9dcdc32a",[x.current?"0.25s":"0s"]]])+" "+(l()("nl1 nr1 mv1",o===e?"blue-fade":"",V.has(e)?"error":"")||""),children:(0,n.jsx)(X,{specifier:e,resolvedVersion:h.has(e)?h.get(e):null===(t=C.get(e))||void 0===t?void 0:t.version,latestVersion:null===(s=y.get(e))||void 0===s?void 0:s.version,onLock:t=>M(e,t),isReadonly:g,isDirty:h.has(e)})},e)}))]}),b.size>c.size&&(0,n.jsxs)("div",{className:i().dynamic([["6f12096f9dcdc32a",[x.current?"0.25s":"0s"]]])+" pa3 pt0",children:[(0,n.jsx)("div",{className:i().dynamic([["6f12096f9dcdc32a",[x.current?"0.25s":"0s"]]])+" pv2 f6 fw6 lh-title near-black",children:"Indirect imports"}),Array.from(b).filter((e=>!c.has(e))).sort().map((e=>{var t,s,a;return(0,n.jsx)("div",{"data-cy":"notebook-import",className:i().dynamic([["6f12096f9dcdc32a",[x.current?"0.25s":"0s"]]])+" "+(l()("nl1 nr1 mv1",o&&(null===(t=c.get(o))||void 0===t?void 0:t.some((t=>{let[,s]=t;return s===e})))?"blue-fade":"",V.has(e)?"error":"")||""),children:(0,n.jsx)(X,{specifier:e,resolvedVersion:h.has(e)?h.get(e):null===(s=C.get(e))||void 0===s?void 0:s.version,latestVersion:null===(a=y.get(e))||void 0===a?void 0:a.version,onLock:t=>M(e,t),isReadonly:g,isDirty:h.has(e),importers:r.imports.filter((t=>{let[,s]=t;return s===e})).map((e=>{let[t]=e;return t}))})},e)}))]})]}):(0,n.jsx)("div",{className:i().dynamic([["6f12096f9dcdc32a",[x.current?"0.25s":"0s"]]])+" pa3 mid-gray",children:"This notebook has no dependencies"}),h.size?(0,n.jsxs)("div",{className:i().dynamic([["6f12096f9dcdc32a",[x.current?"0.25s":"0s"]]])+" pa2 sticky bottom-0 right-0 left-0 flex justify-end br3 br--bottom shadow-1-ns bg-white",children:[(0,n.jsx)(p.kq,{text:"Cancel",onClick:()=>u(new Map)}),(0,n.jsx)(p.KM,{text:"Save ".concat((0,E.YY)(h.size,"change")),onClick:function(){h.size&&(t({type:"resolveDependencies",source:"dependenciesPane",trigger:"click",resolutions:[...h].map((e=>{let[t,s]=e;return{type:"notebook",specifier:t,value:void 0===s?null:"".concat(y.get(t).id).concat(null===s?"":"@".concat(s))}}))}),u(new Map))}})]}):null,(0,n.jsx)(i(),{id:"6f12096f9dcdc32a",dynamic:[x.current?"0.25s":"0s"],children:".error.__jsx-style-dynamic-selector a{color:var(--red)}.blue-fade.__jsx-style-dynamic-selector{-webkit-border-radius:4px;-moz-border-radius:4px;border-radius:4px;-webkit-animation-name:flash;-moz-animation-name:flash;-o-animation-name:flash;animation-name:flash;-webkit-animation-duration:2s;-moz-animation-duration:2s;-o-animation-duration:2s;animation-duration:2s;-webkit-animation-iteration-count:1;-moz-animation-iteration-count:1;-o-animation-iteration-count:1;animation-iteration-count:1;-webkit-animation-timing-function:ease;-moz-animation-timing-function:ease;-o-animation-timing-function:ease;animation-timing-function:ease;-webkit-animation-delay:".concat(x.current?"0.25s":"0s",";-moz-animation-delay:").concat(x.current?"0.25s":"0s",";-o-animation-delay:").concat(x.current?"0.25s":"0s",";animation-delay:").concat(x.current?"0.25s":"0s","}@-webkit-keyframes flash{0%{background-color:var(--observable-focus-light-blue)}60%{background-color:var(--observable-focus-light-blue)}100%{background-color:#fefefe}}@-moz-keyframes flash{0%{background-color:var(--observable-focus-light-blue)}60%{background-color:var(--observable-focus-light-blue)}100%{background-color:#fefefe}}@-o-keyframes flash{0%{background-color:var(--observable-focus-light-blue)}60%{background-color:var(--observable-focus-light-blue)}100%{background-color:#fefefe}}@keyframes flash{0%{background-color:var(--observable-focus-light-blue)}60%{background-color:var(--observable-focus-light-blue)}100%{background-color:#fefefe}}")})]})},X=e=>{let{specifier:t,resolvedVersion:s,latestVersion:r,onLock:i,importers:a,isDirty:l,isReadonly:o}=e;const c=K.Z.parse(t);return null===c?(0,n.jsx)(J,{specifier:t,title:"URL import versions cannot be locked",buttonText:"N/A",locked:!1,rel:"ugc nofollow noreferrer",isReadonly:o,isDirty:l,importers:a,dim:!0}):void 0!==c.version?(0,n.jsx)(J,{specifier:c,title:'This dependency version is locked via the "@'.concat(c.version,'" in the import statement'),buttonText:"".concat(c.version),locked:!0,isReadonly:o,isDirty:l,importers:a}):void 0===s&&void 0===r?(0,n.jsx)(J,{specifier:c,title:"Error: specified notebook not found",buttonText:"\u26a0\ufe0e",locked:!1,isReadonly:o,isDirty:l,importers:a,dim:!0}):o?(0,n.jsx)(J,{specifier:c,title:s?"Version is locked":"Version is not locked",buttonText:"".concat(s||r),locked:!!s,isReadonly:o,isDirty:l,importers:a}):s||void 0===r?s!==r&&r?(0,n.jsx)(J,{specifier:c,title:"Update this dependency to ".concat(r),buttonText:"".concat(s," \u2192 ").concat(r),locked:!0,isReadonly:o,isDirty:l,importers:a,onLockClick:()=>i(null),onButtonClick:()=>i(r)}):(0,n.jsx)(J,{specifier:c,title:"This dependency version is the latest",buttonText:"".concat(s),locked:!0,isReadonly:o,isDirty:l,importers:a,onLockClick:()=>i(null)}):(0,n.jsx)(J,{specifier:c,title:"Lock at version ".concat(r),buttonText:"".concat(r),locked:!1,isReadonly:o,isDirty:l,importers:a,onLockClick:()=>i(r)})},J=e=>{let{specifier:t,title:s,buttonText:r,locked:i,isReadonly:a,isDirty:o,importers:c,onLockClick:d=null,onButtonClick:h=null,dim:u=!1,rel:m=""}=e;const x=(0,T.I0)();return(0,n.jsxs)("div",{className:l()("flex items-center justify-between pa1",u?"gray":""),children:[(0,n.jsx)(q.Z,{href:t instanceof K.Z?t.toNotebookURL():t,children:(0,n.jsx)("a",{rel:m,title:"".concat(t).concat(c?"\nImported by:\n".concat(c.join("\n")):""),className:"truncate overflow-hidden nowrap",children:"".concat(t)})}),(0,n.jsxs)("div",{className:"ml2 tr flex justify-end items-center nowrap",title:s,children:[a||null===h?(0,n.jsx)(p.sn,{disabled:!0,onClick:()=>{},style:{lineHeight:.5,color:"var(--".concat(u?"gray":"dark-gray",")")},className:"bn pr1",text:r}):(0,n.jsx)(p.KM,{onClick:()=>{h(),x({type:"upgradeDependency"})},style:{lineHeight:.5},className:"bn mr1",text:r}),(0,n.jsx)("button",{"data-cy":"".concat(i?"Locked":"Unlocked"," ").concat(t),disabled:!a&&null===d,style:{color:o?"var(--blue)":void 0,lineHeight:.5},onClick:d?()=>{x({type:"toggleDependencyLock",locked:!i}),d()}:()=>{},className:l()("ph0 flex items-center bn bg-transparent",null!==d?"hover-black pointer dark-gray":"gray"),children:i?(0,n.jsx)(U.Z,{}):(0,n.jsx)(B.Z,{})})]})]},"notebook-".concat(t))};var Q=s(26674),ee=s(41799),te=s(99534),se=s(40821),ne=s(26825),re=s(27919),ie=s(19868),ae=s(2845),le=s(8433),oe=s(18582),ce=s(47743),de=s(11342);const he=e=>{let{name:t,provider:s,dispatch:r,mimeType:i,size:a,downloadUrl:l}=e;return(0,n.jsx)("div",{className:"flex flex-shrink-0 items-center",children:(0,n.jsxs)(N.v2,{children:[(0,n.jsx)(p.hU,{icon:j.v,title:"File actions",colorless:!0,asMenuButton:!0}),(0,n.jsxs)(N.qy,{style:{width:200},children:[(0,n.jsxs)(N.sN,{onSelect:()=>r({type:"cloudFileSnippet",name:t,provider:s,mimeType:i,size:a}),children:[(0,n.jsx)(x.Z,{className:"mr2"})," Insert into notebook"]}),l?(0,n.jsxs)(N.Uk,{onClick:()=>r({type:"downloadCloudFile",provider:s,mimeType:i,size:a}),href:l,children:[(0,n.jsx)(ne.Z,{className:"mr2"})," Download"]}):null,(0,n.jsxs)(N.sN,{onSelect:()=>r({type:"removeCloudFile",name:t,provider:s,mimeType:i,size:a}),className:"hover-dark-red hover-bg-washed-red",children:[(0,n.jsx)(le.Z,{className:"mr2"})," Delete"]})]})]})})},ue=e=>{let{name:t,path:s,used:r,hasToken:i,dispatch:a}=e;const l=(0,de.Xk)(s),{data:o,error:c}=(0,se.ZP)(i?"/user/token?provider=microsoftData":null,S.a8,{revalidateOnFocus:!1}),{data:d,error:h=c}=(0,se.ZP)((()=>!c&&o&&l?(0,de.g4)(s,o.access_token):null),oe.r,{revalidateOnFocus:!1});var u;return(0,n.jsxs)("div",{className:"ma3 flex justify-between items-center",children:[(0,n.jsxs)("div",{className:"flex items-center truncate",children:[(0,n.jsx)(ae.ZP,{className:"flex-shrink-0 mr2",style:{width:24,height:24}}),(0,n.jsxs)("div",{className:"f7 truncate",children:[(0,n.jsx)("div",{className:"fw6 dark-gray flex items-center truncate",children:!h&&i&&l?(0,n.jsx)("div",{className:"truncate",children:(0,n.jsx)("a",{href:null!==(u=null===d||void 0===d?void 0:d.webUrl)&&void 0!==u?u:void 0,className:"hover-blue no-underline",target:"_blank",rel:"noreferrer",children:t})}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(re.Z,{className:"flex-shrink-0",style:{width:12,height:12},children:(0,n.jsx)("title",{children:null===h||void 0===h?void 0:h.message})}),(0,n.jsx)("div",{className:"ml2 dark-red truncate",children:t})]})}),(0,n.jsxs)("div",{className:"pt1 gray truncate",children:[r?(0,n.jsx)("span",{className:"f7 fw6 blue",children:"In use"}):(0,n.jsx)("span",{className:"f7 gray",children:"Unused"})," \u2022 ",(null===o||void 0===o?void 0:o.provider_username)||"No account connected"]})]})]}),(0,n.jsx)(he,{name:t,mimeType:(0,de.bh)(d,t),size:(0,de.ap)(d),downloadUrl:d?d["@microsoft.graph.downloadUrl"]:void 0,provider:"microsoftData",dispatch:a})]})},me=e=>{let{name:t,path:s,used:r,hasToken:i,dispatch:a}=e;const l=(0,ce.ty)(s),{data:o,error:c}=(0,se.ZP)(i?"/user/token?provider=googleData":null,S.a8,{revalidateOnFocus:!1}),{data:d,error:h=c}=(0,se.ZP)((()=>!c&&o&&l?(0,ce.wA)("".concat(s,"?fields=mimeType,size,webContentLink,webViewLink&supportsAllDrives=true"),o.access_token):null),oe.r,{revalidateOnFocus:!1});var u,m;return(0,n.jsxs)("div",{className:"ma3 flex justify-between items-center",children:[(0,n.jsxs)("div",{className:"flex items-center truncate",children:[(0,n.jsx)(ie.Z,{className:"flex-shrink-0 mr2",style:{width:24,height:24}}),(0,n.jsxs)("div",{className:"f7 truncate",children:[(0,n.jsx)("div",{className:"fw6 dark-gray flex items-center truncate",children:!h&&i&&l?(0,n.jsx)("div",{className:"truncate",children:(0,n.jsx)("a",{href:null===d||void 0===d?void 0:d.webViewLink,className:"hover-blue no-underline",target:"_blank",rel:"noreferrer",children:t})}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(re.Z,{className:"flex-shrink-0",style:{width:12,height:12},children:(0,n.jsx)("title",{children:null===h||void 0===h?void 0:h.message})}),(0,n.jsx)("div",{className:"ml2 dark-red truncate",children:t})]})}),(0,n.jsxs)("div",{className:"pt1 gray truncate",children:[r?(0,n.jsx)("span",{className:"f7 fw6 blue",children:"In use"}):(0,n.jsx)("span",{className:"f7 gray",children:"Unused"})," \u2022 ",(null===o||void 0===o?void 0:o.provider_username)||"No account connected"]})]})]}),(0,n.jsx)(he,{name:t,mimeType:null!==(u=null===d||void 0===d?void 0:d.mimeType)&&void 0!==u?u:"",size:+(null!==(m=null===d||void 0===d?void 0:d.size)&&void 0!==m?m:0),downloadUrl:null===d||void 0===d?void 0:d.webContentLink,provider:"googleData",dispatch:a})]})},pe=e=>{var{specifier:t}=e,s=(0,te.Z)(e,["specifier"]);switch(t.provider){case"microsoftData":return(0,n.jsx)(ue,(0,ee.Z)({},t,s));case"googleData":return(0,n.jsx)(me,(0,ee.Z)({},t,s))}};var xe=s(69396),fe=s(58127),ge=s(88725);const ve=e=>{let{children:t,onDrop:s,dispatch:r,fileSource:i,loginSource:a,currentUser:l,readOnly:o,disabled:c}=e;const{isDraggingOver:d,dragAndDropEvents:h}=(0,fe.Y)((e=>{let{dataTransfer:{files:t}}=e;(0,R.Yb)(l)?((e=>{r({type:"attachLocalFiles",files:e,source:i,trigger:"dragAndDrop"})})(Array.from(t)),s&&s(Array.from(t))):l||r({type:"showModal",modal:"login",modalProps:{loginReason:"files"},trigger:"dragAndDrop",source:a})}));return(0,n.jsxs)("div",(0,xe.Z)((0,ee.Z)({className:"relative mb3","data-cy":"drop-target"},o||c?null:h),{children:[t,d&&(0,n.jsxs)("div",{className:"flex absolute nb3 right-0 bottom-0 top-0 left-0 tc bg-near-white b--light-silver o-90 b--dashed justify-center flex-column z-max bw1",children:[(0,n.jsx)("div",{className:"f6 fw6 near-black",children:"Upload files"}),(0,n.jsxs)("div",{className:"f7 fw5 dark-gray mt2",children:[(0,_.BU)(ge.D_)," maximum per file"]})]})]}))};var be=e=>(0,n.jsxs)("svg",(0,xe.Z)((0,ee.Z)({width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",stroke:"currentColor",strokeWidth:"2"},e),{children:[(0,n.jsx)("path",{d:"M4 9L4 3C4 2.44771 4.44772 2 5 2L11.0001 2C11.5523 2 12 2.44768 12 2.99992V2.99992"}),(0,n.jsx)("path",{d:"M12 7L12 13C12 13.5523 11.5523 14 11 14L5 14C4.44771 14 4 13.5523 4 13V13"}),(0,n.jsx)("path",{d:"M1 6L4 9L7 6"}),(0,n.jsx)("path",{d:"M15 10L12 7L9 10"})]}));const je=e=>{let{file:t,dispatch:s,used:r,currentUser:i,isFileDeletable:a,canDeleteFile:l,pane:o,readOnly:c}=e;function d(e){s({type:"insertFile",file:e})}function h(e,t,n){(0,R.Yb)(i)?s({type:"showModal",modal:"replaceFile",modalProps:{fileToReplace:e}}):i||s({type:"showModal",modal:"login",modalProps:{loginReason:"files"},trigger:t,source:n})}return(0,n.jsxs)("div",{className:"flex items-center justify-between ma3","data-cy":"file-item",children:[(0,n.jsx)("div",{className:"overflow-x-hidden",children:(0,n.jsx)(Q.J,{file:t,used:r})}),(0,n.jsxs)("div",{className:"flex flex-shrink-0 items-center",children:[(0,n.jsx)(p.hU,{icon:r?be:x.Z,onClick:r?()=>h(t,"click","".concat(o,"PaneReplaceFileButton")):()=>d(t),title:r?"Replace file":"Insert into notebook"}),(0,n.jsxs)(N.v2,{children:[(0,n.jsx)(p.hU,{icon:j.v,title:"File actions",colorless:!0,asMenuButton:!0}),(0,n.jsxs)(N.qy,{style:{width:200},children:[(0,n.jsxs)(N.sN,{onSelect:()=>d(t),disabled:c,children:[(0,n.jsx)(x.Z,{className:"mr2"})," Insert into notebook"]}),(0,n.jsxs)(N.sN,{onSelect:()=>s({type:"copyFileCode",file:t}),children:[(0,n.jsx)(f.Z,{className:"mr2"})," Copy usage code"]}),(0,n.jsx)(N.R,{}),"downloadUrl"in t&&(0,n.jsxs)(N.Uk,{onClick:()=>s({type:"downloadFile",file:t}),href:t.downloadUrl,children:[(0,n.jsx)(ne.Z,{className:"mr2"})," Download"]}),(0,n.jsxs)(N.sN,{onSelect:()=>h(t,"click","".concat(o,"PaneMenuReplace")),disabled:!r||c,children:[(0,n.jsx)(be,{className:"mr2"})," Replace file"]}),l&&!c?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(N.R,{}),(0,n.jsxs)(N.sN,{disabled:!a,onSelect:()=>s({type:"showModal",modal:"deleteFile",modalProps:{name:t.name}}),className:"hover-dark-red hover-bg-washed-red",children:[(0,n.jsx)(le.Z,{className:"mr2"})," Delete"]})]}):null]})]})]})]})};var ye=s(27565),Ve=s(92946),we=s(19671),Ce=s(2741),ke=s(48873),Ne=s(11222),Ze=s(4598);const Le=e=>{let{title:t,icon:s,"aria-label":r,onAdd:a,disabled:o,allowsPrivate:c=!0}=e;return(0,n.jsxs)("div",{className:"jsx-335f9f217f61bc08 "+(l()("ph3 pt3 f6 fw6 lh-title flex items-center justify-between section-header",c?"near-black":"gray")||""),children:[(0,n.jsxs)("span",{className:"jsx-335f9f217f61bc08 flex items-center",children:[d.createElement(s,{className:l()("mr2 pa1 br2 border-box",c?"bg-near-white":"bg-white moon-gray"),style:{width:24,height:24}}),t]}),(0,n.jsx)(p.hU,{onClick:a,icon:V.ZP,"aria-label":r,colorless:!0,disabled:o,className:"nt2 nb2"}),(0,n.jsx)(i(),{id:"335f9f217f61bc08",children:".section-header.jsx-335f9f217f61bc08{border-top:1px solid var(--light-silver);margin-top:var(--spacing-medium)}.section-header.jsx-335f9f217f61bc08:first-of-type{border:none;margin-top:0}"})]})},Me=e=>{let{files:t,used:s,currentUser:r,notebook:i,dispatch:a}=e;t=[...t].sort(((e,t)=>e.name<t.name?-1:1));const l=t.filter((e=>s.has(e.name))),o=t.filter((e=>!s.has(e.name))),c=e=>e.privateBucketId&&(0,E.HW)(i)?(0,n.jsx)("div",{className:"ma3","data-cy":"file-item",children:(0,n.jsx)(Q.J,{file:e,used:!0,isPrivateInPublic:!0})}):(0,n.jsx)(je,{isFileDeletable:(0,W.cn)(e,i),canDeleteFile:(0,R.uP)(e,i),file:e,dispatch:a,used:s.has(e.name),currentUser:r,pane:"files",readOnly:(0,E.os)(i)},e.name),d=t.filter((e=>"pending"!==e.status&&"local"!==e.status)).reduce(((e,t)=>e+(t.size||0)),0),h=(0,n.jsxs)(n.Fragment,{children:["File attachments"," ",d>0&&(0,n.jsxs)("span",{className:"ml1 gray",children:["(",(0,_.BU)(d),")"]})]}),u=!(0,W.j5)(r,i);return 0===t.length&&u?null:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(Le,{title:h,icon:b.Z,"aria-label":"Upload files",disabled:(0,E.os)(i)||u,onAdd:()=>{(0,R.Yb)(r)?(a({type:"notebookFilePickerOpened",source:"filesPane",trigger:"click"}),(0,Ce.Z)().then((e=>a({type:"attachLocalFiles",files:e,source:"filesPane",trigger:"click"})))):r||a({type:"showModal",modal:"login",modalProps:{loginReason:"files"},trigger:"click",source:"filesPaneAttachFileButton"})}}),l.map(c),o.length?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(Se,{children:"Unused"}),o.map(c)]}):null]})},Se=e=>{let{children:t}=e;return(0,n.jsxs)("div",{className:"flex ma3",children:[(0,n.jsx)("span",{className:"gray mr1",children:t}),(0,n.jsx)("span",{className:"flex-grow-1 bb b--light-silver",style:{height:9}})]})},He=e=>{let{cloudFiles:t,notebook:s,currentUser:r,used:i,dispatch:a}=e;const l=t.map((e=>(0,ke.a)(e))).filter(Ne.K),{data:o}=(0,S.h_)(r&&(0,E.cE)(s)&&l.length>0&&"/user/tokens");function c(e,t){(0,we.MR)((0,we.ym)({type:"notebook:manage:cloudFileAuth",notebook:s,currentUser:r,data:{provider:e,alreadyAuthenticated:t},eventVersion:1}))}return(0,E.cE)(s)?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(Le,{icon:Ve.ZP,title:"Cloud files","aria-label":"Add cloud file",onAdd:()=>a({type:"showModal",modal:"addCloudFile"}),disabled:(0,E.os)(s)}),(0,E.vi)(s).map((e=>(0,n.jsx)(ye.E,{provider:e,alreadyAuthenticated:!!o&&o.some((t=>t.provider===e)),onAuth:c,children:(0,n.jsxs)("div",{className:"ph3 mt2 f7 flex items-center",children:[(0,n.jsx)(re.Z,{className:"mr2 flex-shrink-0"}),(0,n.jsxs)("div",{children:[(0,n.jsxs)("span",{className:"mr1 mid-gray",children:["This notebook encountered an error importing"," ",Ze.c[e].name," files. Please"]}),(0,n.jsx)("button",{type:"submit",className:"blue pointer underline-hover bg-transparent pa0 bn",children:"connect your account"}),"."]})]})},e))),o&&l.length?(0,n.jsxs)(n.Fragment,{children:[Object.entries(Ze.c).map((e=>{let[t,s]=e;return l.some((e=>e.provider===t))&&(0,n.jsx)(ye.E,{provider:t,alreadyAuthenticated:o.some((e=>e.provider===t)),onAuth:c,children:(0,n.jsxs)("div",{className:"ph3 mt2 f7",children:[(0,n.jsxs)("span",{className:"mr1 mid-gray",children:["This notebook uses ",s.name," files."]}),(0,n.jsx)("button",{className:"blue pointer underline-hover bg-transparent pa0 bn",type:"submit",children:o.some((e=>e.provider===t))?"Switch account":"Connect account"})]})},t)})),l.map((e=>(0,n.jsx)(pe,{specifier:e,used:i.has(e.specifier),dispatch:a,hasToken:o.some((t=>t.provider===e.provider))},e.specifier)))]}):null]}):(0,I.Hw)(s)?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(Le,{icon:Ve.ZP,title:"Cloud files",disabled:!0,allowsPrivate:!1,onAdd:()=>{}}),(0,n.jsx)("div",{className:"ph3 pt2 gray f7",children:"Only available in private notebooks"})]}):null},_e=(0,T.$j)((e=>{let{notebook:t,currentUser:s}=e;return{notebook:t,currentUser:s}}),(e=>({dispatch:e})))((e=>{let{notebook:t,currentUser:s,dispatch:r}=e;const{model:{nodes:i,resolutions:a},files:l}=t,{fileAttachments:o}=(0,F.Z)(i),c=a.filter(E.HC),d=(0,E.Pu)(l);return(0,n.jsxs)(m.X,{children:[(0,n.jsx)(m.h,{children:"Files"}),(0,n.jsxs)(ve,{dispatch:r,currentUser:s,fileSource:"filesPane",loginSource:"filesPaneDragAndDrop",readOnly:(0,E.os)(t),disabled:!(0,W.j5)(s,t),children:[(0,n.jsx)(Me,{files:d,used:o,currentUser:s,dispatch:r,notebook:t}),(0,n.jsx)(He,{dispatch:r,notebook:t,currentUser:s,cloudFiles:c,used:o})]})]})}));var Re=s(11233),Ee=s(60803),De=s(60138),Fe=s(51289),Ie=s(63527),Te=s(40178),Pe=s(19170);const Ae=(0,Ie.V)([["Enter",e=>{let{dispatch:t}=e;return t({type:"selectNextSearchResult"}),!0}],["Shift-Enter",e=>{let{dispatch:t}=e;return t({type:"selectPreviousSearchResult"}),!0}],["Escape",e=>{let{dispatch:t}=e;return t({type:"dismissPane"}),!0}]]),Oe=(0,T.$j)((e=>{let{notebook:t}=e;return{regexSearch:t.regexSearch,searchTerm:t.searchTerm,searchResults:t.searchResults,selectedSearchResult:t.selectedSearchResult}}),(e=>({dispatch:e})))((e=>{let{regexSearch:t,searchTerm:s,searchResults:r,selectedSearchResult:i,dispatch:a}=e;function l(e){a({type:"setSearchTerm",searchTerm:e})}const o=(0,Pe._)(r,i),c=r&&void 0!==o,u=function(){if(s&&t)try{new RegExp(s,"gu")}catch(e){return e.message||"invalid regex"}}(),m=(0,d.useRef)(null);return(0,d.useEffect)((()=>{m.current&&m.current!==document.activeElement&&m.current.select()}),[]),(0,n.jsxs)("div",{className:"mh3",children:[(0,n.jsxs)("div",{className:"flex",children:[(0,n.jsx)(Re.x,{type:"text",placeholder:"Find",value:s,ref:m,onChange:e=>{let{target:{value:t}}=e;return l(t)},className:"flex-auto",hasError:u,onKeyDown:function(e){Ae({dispatch:a},e)&&(e.preventDefault(),e.stopPropagation())},leftElement:(0,n.jsx)("div",{children:(0,n.jsx)(De.Z,{className:"db moon-gray"})}),rightElement:(0,n.jsx)(p.hU,{icon:h.Z,onClick:()=>l(""),style:{width:28,height:28,marginRight:2},colorless:!0,disabled:!s})}),(0,n.jsxs)("div",{className:"flex ml2",children:[(0,n.jsx)(p.hA,{icon:()=>(0,n.jsx)(Ee.Z,{className:c?"":"moon-gray",style:{transform:"rotate(-180deg)"}}),title:"Previous search result ".concat((0,Te.Z)(Fe.Mq?"Shift-Mod-G":"Shift-F3")),onClick:()=>a({type:"selectPreviousSearchResult"}),disabled:!c,style:{borderRadius:"4px 0 0 4px",width:32,height:32},colorless:!0}),(0,n.jsx)(p.hA,{icon:()=>(0,n.jsx)(Ee.Z,{className:c?"":"moon-gray"}),title:"Next search result ".concat((0,Te.Z)(Fe.Mq?"Mod-G":"F3")),onClick:()=>a({type:"selectNextSearchResult"}),disabled:!c,style:{borderRadius:"0 4px 4px 0",width:32,height:32,marginLeft:1},colorless:!0})]})]}),u&&(0,n.jsx)("div",{className:"red mt2",children:u})]})}));var ze=s(17764),Ue=s(40287),Be=s(95024),qe=s(75063);const We=(0,Ie.V)([["Enter",e=>{let{dispatch:t}=e;return t({type:"replaceCurrent",trigger:"keypress",source:"findPane"}),!0}],["Mod-Enter",e=>{let{dispatch:t}=e;return t({type:"replaceAll",trigger:"keypress",source:"findPane"}),!0}]]),Ge=(0,T.$j)((e=>{let{page:t,notebook:s}=e;var n;return{replaceInputExpanded:t.replaceInputExpanded,replaceTerm:s.replaceTerm,canReplace:!!s.selectedSearchResult&&!!(null===(n=s.searchResults)||void 0===n?void 0:n.size)&&!(0,E.os)(s)}}),(e=>({dispatch:e})))((e=>{let{canReplace:t,replaceInputExpanded:s,replaceTerm:r,dispatch:i}=e;return(0,n.jsxs)("div",{className:"flex flex-column mt3 pa3 bt b--light-silver",children:[(0,n.jsxs)("button",{className:"f6 fw6 bn flex items-center bg-transparent b--transparent relative pointer pa0",onClick:()=>i({type:"toggleReplaceInputExpanded"}),children:[s?(0,n.jsx)(ze.Z,{className:"mr1"}):(0,n.jsx)(Ue.Z,{className:"mr1"}),"Replace"]}),s&&(0,n.jsxs)("div",{className:"flex mt2",children:[(0,n.jsx)(Re.x,{type:"text",placeholder:"Replace",value:r,onChange:e=>{let{target:{value:t}}=e;return i({type:"setReplaceTerm",replaceTerm:t})},className:"flex-auto",leftElement:(0,n.jsx)(be,{className:"moon-gray"}),onKeyDown:function(e){We({dispatch:i},e)&&(e.preventDefault(),e.stopPropagation())},rightElement:(0,n.jsx)(p.hU,{icon:h.Z,onClick:()=>i({type:"setReplaceTerm",replaceTerm:""}),style:{width:28,height:28,marginRight:2},colorless:!0,disabled:!r})}),(0,n.jsxs)("div",{className:"flex ml2",children:[(0,n.jsx)(p.hA,{icon:()=>(0,n.jsx)(qe.x,{className:t?"":"moon-gray"}),title:"Replace current ".concat((0,Te.Z)("Enter")),onClick:()=>i({type:"replaceCurrent",trigger:"click",source:"findPane"}),disabled:!t,style:{borderRadius:"4px 0 0 4px",width:32,height:32},colorless:!0}),(0,n.jsx)(p.hA,{icon:()=>(0,n.jsx)(Be.E,{className:t?"":"moon-gray"}),title:"Replace all ".concat((0,Te.Z)("Mod-Enter")),onClick:()=>i({type:"replaceAll",trigger:"click",source:"findPane"}),disabled:!t,style:{borderRadius:"0 4px 4px 0",width:32,height:32,marginLeft:1},colorless:!0})]})]})]})}));var Ke=s(33494),Ye=s(40076),$e=s(72760);const Xe=e=>{let{selectedSearchResult:t,node:s,searchResults:r,dispatch:i}=e;const a=Ye.qz[s.mode].icon,o=(0,$e.u2)(s),c=(0,d.useRef)(null);return(0,d.useEffect)((()=>{c.current&&t&&(0,Ke.zT)(c.current)}),[t]),(0,n.jsxs)("div",{className:"ma3",children:[(0,n.jsxs)("div",{className:"mt3 mb1 flex items-center dark-gray monospace-bold",children:[(0,n.jsx)(a,{className:"mr1"}),o||(0,n.jsxs)("span",{className:"i",children:["unnamed (#",s.id,")"]})]}),r.map(((e,r)=>{const a=(null===t||void 0===t?void 0:t.nodeResultIndex)===r&&t.nodeId===s.id;return(0,n.jsx)("div",{className:"mh3",ref:a?c:null,"data-cy":"find-result-row",children:(0,n.jsxs)("button",{className:l()("w-100 pa1 tl bn br2 monospace",a?"bg-blue white":"bg-transparent hover-bg-light-silver"),onClick:()=>i({type:"selectSearchResult",selectedSearchResult:{nodeId:s.id,nodeResultIndex:r}}),children:[(0,n.jsx)("span",{className:a?"o-70":"o-50",children:e.beforeText}),(0,n.jsx)("span",{className:l()("br1",a?"bg-observable-orange black":"bg-observable-yellow"),children:e.termText}),(0,n.jsx)("span",{className:a?"o-70":"o-50",children:e.afterText})]})},r)}))]})},Je=(0,T.$j)((e=>{let{notebook:t}=e;return{model:t.model,selectedSearchResult:t.selectedSearchResult,searchResults:t.searchResults}}),(e=>({dispatch:e})))((e=>{let{model:t,selectedSearchResult:s,searchResults:r,dispatch:i}=e;if(!r)return null;if(!(0,Pe.n)(r))return(0,n.jsx)("div",{className:"pa3",children:"No results"});const a=[];for(const l of t.nodes){const e=r.get(l.id);e&&a.push((0,n.jsx)(Xe,{node:l,selectedSearchResult:s,searchResults:e,dispatch:i},l.id))}return(0,n.jsx)("div",{className:"overflow-y-auto flex-auto bt b--light-silver",children:(0,n.jsx)("div",{children:a})})}));var Qe=s(16691);const et=(0,T.$j)((e=>{let{page:t,notebook:s}=e;return{findOptionsInputExpanded:t.findOptionsInputExpanded,caseSensitiveSearch:s.caseSensitiveSearch,wholeWordSearch:s.wholeWordSearch,regexSearch:s.regexSearch}}),(e=>({dispatch:e})))((e=>{let{findOptionsInputExpanded:t,caseSensitiveSearch:s,wholeWordSearch:r,regexSearch:i,dispatch:a}=e;return(0,n.jsxs)("div",{className:"flex flex-column pa3 bt b--light-silver",children:[(0,n.jsxs)("button",{className:"f6 fw6 bn flex items-center bg-transparent b--transparent relative pointer pa0",onClick:()=>a({type:"toggleFindOptionsExpanded"}),children:[t?(0,n.jsx)(ze.Z,{className:"mr1"}):(0,n.jsx)(Ue.Z,{className:"mr1"}),"Settings"]}),t&&(0,n.jsxs)("div",{className:"mt2",children:[(0,n.jsx)(Qe.X,{checked:s,onChange:()=>a({type:"toggleCaseSensitiveSearch"}),label:"Case sensitive"}),(0,n.jsx)(Qe.X,{checked:r,onChange:()=>a({type:"toggleWholeWordSearch"}),label:"Whole word"}),(0,n.jsx)(Qe.X,{checked:i,onChange:()=>a({type:"toggleRegexSearch"}),label:"Regular expression"})]})]})}));var tt=s(12447);const st=(0,T.$j)((e=>{let{notebook:t}=e;return{searchResults:t.searchResults,selectedSearchResult:t.selectedSearchResult}}),null)((e=>{let{searchResults:t,selectedSearchResult:s}=e;const r=(0,tt.GS)("(max-width: 960px)",!1),i=(0,Pe._)(t,s),a=(0,Pe.n)(t);return(0,n.jsxs)("div",{className:l()("flex align-items pa3",r?"mr3 pr4":""),children:[(0,n.jsx)("div",{className:"f5 fw6 near-black flex-auto lh-title",children:"Find and replace"}),(0,n.jsx)("div",{className:"f6 dark-gray",children:t?void 0===s?(0,n.jsx)(n.Fragment,{children:a}):(0,n.jsxs)(n.Fragment,{children:[i+1,(0,n.jsx)("span",{className:"gray",children:" of "}),a]}):null})]})})),nt=(0,Ie.V)([["ArrowDown","Shift-ArrowDown",e=>{let{dispatch:t}=e;return t({type:"selectNextSearchResult"}),!0}],["ArrowUp","Shift-ArrowUp",e=>{let{dispatch:t}=e;return t({type:"selectPreviousSearchResult"}),!0}]]),rt=(0,T.$j)(null,(e=>({dispatch:e})))((e=>{let{dispatch:t}=e;return(0,n.jsxs)(m.X,{className:"flex flex-column",onKeyDown:function(e){nt({dispatch:t},e)&&(e.preventDefault(),e.stopPropagation())},children:[(0,n.jsxs)("div",{className:"flex flex-column",children:[(0,n.jsx)(st,{}),(0,n.jsx)(Oe,{}),(0,n.jsx)(Ge,{}),(0,n.jsx)(et,{})]}),(0,n.jsx)(Je,{})]})}));var it=s(8385),at=s(51517),lt=s(87769),ot=s(93797),ct=s(99414),dt=s(86466),ht=s(71066),ut=s(1105),mt=s(45578),pt=s(89642),xt=s(62990);function ft(e){const{node_id:t,mode:s}=e,{node_name:n,node_value_start:r}=e,i=n||r||"table"===s?"":" empty cell";switch(e.type){case"insert_node":return"Added".concat(i);case"modify_node":return e.is_new?"Added".concat(i):e.node_old_name?"Renamed":"Edited".concat(i);case"remove_node":return"Removed".concat(i);case"move_node":return"Moved".concat(i);case"pin_node":return"Pinned".concat(i);case"unpin_node":return"Unpinned".concat(i);case"modify_title":return"Titled \u201c".concat(e.title,"\u201d");case"modify_license":return null===e.license?"Removed license":"Licensed ".concat((0,pt.ax)(e.license));case"modify_copyright":return""!==e.copyright?"Copyright".concat(e.copyright.replace(/^copyright\b/i,"")):"Removed copyright notice";case"revert":return"Reverted to ".concat(t);case"create":return e.fork?"Forked from \u201c".concat(e.fork.title,"\u201d"):"Created";case"mode_node":{const{label:t}=Ye.qz[e.mode]||{label:""};return"Mode ".concat(t)}case"resolve_dependency":{var a,l;const{specifier_type:t,specifier:s,value:n}=e;if("notebook"!==t)return"";if(!n||!(null===(a=K.Z.parse(n))||void 0===a?void 0:a.version))return"Version lock for ".concat(s," was removed");const r=null===(l=K.Z.parse(n))||void 0===l?void 0:l.version;return"Locked ".concat(s," to version ").concat(r)}case"modify_data":return"Edited".concat(i);case"modify_name":return e.node_old_name?"Renamed":"Named";default:return""}}function gt(e){const{merge:t}=e;if(t){const e="Merged \u201c".concat(t.document.title,"\u201d");return(0,n.jsx)("span",{title:e,children:e})}const{node_old_name:s,node_name:r,node_value_start:i,node_id:a}=e,l=ft(e);return(0,n.jsxs)("span",{title:"".concat(l," ").concat("Renamed"===l?"".concat(s," to "):"").concat(r||i||""),children:[l," ","Renamed"===l&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("span",{style:{fontSize:"0.8rem"},className:"code",children:s})," ","to"," "]}),r||i||a?(0,n.jsxs)("span",{style:{fontSize:"0.8rem"},className:"code",children:[r||i||"cell ".concat(a)," "]}):null]})}const vt=e=>{let{events:t,isVersioned:s,currentVersion:r,dispatch:a,focusId:o,id:c}=e;const[,...h]=t,u=!!h.length,m=!t.slice(1).some((e=>e.version===r)),{0:x,1:f}=(0,d.useState)(!m),g=(0,tt.GS)(tt.ro),b=g?{width:"2em",height:"2em"}:{width:"1.5em",height:"1.5em"},j=g?"3em":"2em",y=(0,T.v9)((e=>({roles:e.notebook.roles})));return(0,n.jsx)(n.Fragment,{children:t.map(((e,t)=>{if(m&&!x&&t>0)return null;const d=function(e){if(e.publish_time&&!e.paused_version)return lt.Z;switch(e.type){case"create":return ct.Z;case"modify_license":case"modify_copyright":return ot.Z;case"pin_node":case"unpin_node":return ht.Z;case"resolve_dependency":{var t;const{specifier_type:s,value:n}=e;return"notebook"!==s||n&&(null===(t=K.Z.parse(n))||void 0===t?void 0:t.version)?U.Z:B.Z}case"revert":return w.Z;default:return v.Z}}(e),h=0===t,V=e.version===r,C=s&&V,k=null!==o&&e.node_id===o&&!C,N=e.paused_version,Z=C?"bg-light-blue":"bg-transparent",L=C?"white":h?"black":"gray",M=m?C?"white":"near-black":"moon-gray",S=m?C?"hover-light-silver":"hover-dark-gray":"",H=C?"white":"gray",_=C?"white":N?"gray":"moon-gray",{user:E}=e.merge?e.merge:e;function D(){a({type:"loadVersion",version:e.version})}return(0,n.jsxs)("div",{style:{display:"contents"},className:i().dynamic([["5dee8b5464a935d5",[j]]])+" hide-child show-children",children:[(0,n.jsx)("div",{className:i().dynamic([["5dee8b5464a935d5",[j]]])+" "+(l()("cell cellStart",Z)||""),children:h&&u&&(0,n.jsx)("button",{onClick:e=>{e.stopPropagation(),f(!x)},disabled:!m,style:{width:g?j:"auto"},title:x?"Collapse history range":"Expand history range",className:i().dynamic([["5dee8b5464a935d5",[j]]])+" "+(l()("flex items-center justify-center pointer f7 lh-solid fw6 bg-transparent b--transparent br2 bn pa0 h-100",M,S)||""),children:x?(0,n.jsx)(ze.Z,(0,ee.Z)({},b)):(0,n.jsx)(Ue.Z,(0,ee.Z)({},b))})}),(0,n.jsx)("div",{title:e.time&&(0,xt.Dh)(e.time),onClick:D,className:i().dynamic([["5dee8b5464a935d5",[j]]])+" "+(l()("cell fw5 tr nowrap",Z,L)||""),children:e.time&&(0,xt.jD)(e.time)}),(0,n.jsx)("div",{title:(0,I.RX)(E),onClick:D,className:i().dynamic([["5dee8b5464a935d5",[j]]])+" "+(l()("cell",Z)||""),children:(0,n.jsx)(mt.Gz,{owner:E,children:(0,n.jsx)(it.q,{user:E,size:16,className:"v-top br-pill"})})}),(0,n.jsx)("div",{onClick:D,className:i().dynamic([["5dee8b5464a935d5",[j]]])+" "+(l()("cell",Z)||""),children:(0,n.jsx)(d,{className:i().dynamic([["5dee8b5464a935d5",[j]]])+" "+(H||"")})}),(0,n.jsx)("button",{onClick:D,tabIndex:0,className:i().dynamic([["5dee8b5464a935d5",[j]]])+" "+(l()("cell br0 bn",Z,k?"mid-gray fw7":H)||""),children:e.publish_time&&!N?(0,n.jsx)("span",{title:"Published. ".concat(ft(e)),className:i().dynamic([["5dee8b5464a935d5",[j]]])+" truncate",children:"Published"}):(0,n.jsx)("span",{className:i().dynamic([["5dee8b5464a935d5",[j]]])+" truncate",children:gt(e)})}),(0,n.jsxs)("div",{onClick:D,className:i().dynamic([["5dee8b5464a935d5",[j]]])+" "+(l()("cell cellEnd flex justify-end relative",Z,_)||""),children:[N&&(0,n.jsx)("span",{title:(0,R.mG)(y)?ut.H:ut.r,className:i().dynamic([["5dee8b5464a935d5",[j]]])+" pr1",children:(0,n.jsx)(dt.Z,{})}),(0,n.jsxs)("span",{style:{minWidth:"var(--spacing-medium)"},className:i().dynamic([["5dee8b5464a935d5",[j]]])+" "+(l()("tr",_,!V&&"show-child")||""),children:["v",e.version]}),(0,n.jsx)("div",{className:i().dynamic([["5dee8b5464a935d5",[j]]])+" absolute",children:!V&&(0,n.jsx)(p.I_,{className:"child",icon:at.Z,href:"/compare/".concat(c,"@").concat(Math.min(e.version,r),"...").concat(c,"@").concat(Math.max(e.version,r)),onClick:e=>e.stopPropagation(),style:{borderRadius:"var(--border-radius-2)",padding:"0.125rem",right:-3},title:"Compare v".concat(Math.max(e.version,r)," to v").concat(Math.min(e.version,r))})})]}),(0,n.jsx)(i(),{id:"5dee8b5464a935d5",dynamic:[j],children:".cell.__jsx-style-dynamic-selector{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;padding:4px;height:".concat(j,";max-width:100%;overflow:hidden;cursor:pointer}button.cell.__jsx-style-dynamic-selector{padding:4px 2px}.cellStart.__jsx-style-dynamic-selector{-webkit-border-top-left-radius:4px;-moz-border-radius-topleft:4px;border-top-left-radius:4px;-webkit-border-bottom-left-radius:4px;-moz-border-radius-bottomleft:4px;border-bottom-left-radius:4px;margin-left:var(--spacing-small)}.cellEnd.__jsx-style-dynamic-selector{-webkit-border-top-right-radius:4px;-moz-border-radius-topright:4px;border-top-right-radius:4px;-webkit-border-bottom-right-radius:4px;-moz-border-radius-bottomright:4px;border-bottom-right-radius:4px;margin-right:var(--spacing-small);padding-right:var(--spacing-small)}")})]},t)}))})},bt=e=>{let{range:{folds:t,events:s,title:r},isVersioned:a,currentVersion:l,dispatch:o,isFirst:c,focusId:h,id:u}=e;return s.length?(0,n.jsxs)(n.Fragment,{children:[!c&&(0,n.jsx)("div",{style:{height:1},className:"jsx-6c50030ed6403049 span-grid flex-auto mt3 bg-light-silver"}),(0,n.jsx)("div",{className:"jsx-6c50030ed6403049 span-grid pt3 pb2 ph3 flex",children:(0,n.jsx)("span",{className:"jsx-6c50030ed6403049 mr1 f6 fw6 near-black",children:r})}),t.map(((e,t)=>{const i=s.slice(e[0],e[1]+1);return(0,n.jsxs)(d.Fragment,{children:[(0,n.jsx)(vt,{events:i,isVersioned:a,dispatch:o,currentVersion:l,focusId:h,id:u}),i.some((e=>e.first_public_version&&!e.oldest_version))&&(0,n.jsxs)("div",{className:"jsx-6c50030ed6403049 span-grid flex items-center mh3",children:[(0,n.jsx)("div",{className:"jsx-6c50030ed6403049 w-100 bt mr2 b--lightest-green"}),(0,n.jsx)("div",{className:"jsx-6c50030ed6403049 nowrap f7 lh-f7 fw5 bg-washed-green dark-green pa1 br2",children:"Made public"})]})]},"".concat(r).concat(t))})),(0,n.jsx)(i(),{id:"6c50030ed6403049",children:".span-grid.jsx-6c50030ed6403049{grid-column-start:1;grid-column-end:7}"})]}):null},jt=(0,T.$j)((e=>{let{notebook:t,currentUser:s}=e;return{notebook:t,currentUser:s}}))((e=>{let{notebook:t,currentUser:s}=e;const{suggestionsTo:r}=t;if(!r.length)return null;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"jsx-448bdbec10f793c0 pt3 pb1 ph3 flex suggestionsEntry",children:[(0,n.jsx)("span",{className:"jsx-448bdbec10f793c0 mr1 f6 fw6 near-black",children:"Suggestions"}),(0,n.jsx)("hr",{style:{height:1,marginTop:"0.65em"},className:"jsx-448bdbec10f793c0 flex-auto mt2 bn bg-light-gray v-base"})]}),r.map(((e,r)=>{const{creator:i,description:a,from_id:l,to_id:o}=e;return(0,n.jsx)("div",{title:"View suggestion",className:"jsx-448bdbec10f793c0 br2 pa2 mt2 mh3 bg-washed-yellow suggestionsEntry",children:(0,n.jsx)(q.Z,{href:"/compare/".concat(o,"...").concat(l),children:(0,n.jsxs)("a",{onClick:()=>function(e){let{to_id:n,to_owner:r,from_id:i,from_owner:a}=e;(0,we.MR)((0,we.ym)({type:"notebook:view:suggestion",data:{base:(0,we.tb)({id:n,owner:r},s),target:(0,we.tb)({id:i,owner:a},s),trigger:"click",source:"historyPane"},eventVersion:1,notebook:t,currentUser:s}))}(e),className:"jsx-448bdbec10f793c0 no-underline",children:[(0,n.jsxs)("div",{className:"jsx-448bdbec10f793c0 flex items-center",children:[(0,n.jsx)(it.q,{user:i,className:"br-100 mr2",size:16}),(0,I.RX)(i)]}),(0,n.jsxs)("div",{className:"jsx-448bdbec10f793c0 mid-gray f7 pt2",children:["\u201c",a,"\u201d"]})]})})},r)})),(0,n.jsx)(i(),{id:"448bdbec10f793c0",children:".suggestionsEntry.jsx-448bdbec10f793c0{grid-column-start:1;grid-column-end:7}"})]})})),yt=new Set(["revert"]),Vt=new Set(["pin","unpin"]);function wt(e,t){if(!e.length)return;const s=[];let n;for(let r=0;r<e.length;r++)Ct(r,e)?(n&&s.push(n),s.push([r,r]),n=void 0):n?n[1]=r:n=[r,r];return n&&s.push(n),{folds:s,events:e,title:t}}function Ct(e,t){const s=t.at(e),n=t.at(e-1);return s&&!Vt.has(s.type)&&!!(yt.has(s.type)||0===e||s.merge||s.paused_version||s.first_public_version&&!s.oldest_version||s.publish_time||"create"===s.type&&s.fork||(null===n||void 0===n?void 0:n.time)&&s.time&&n.time.getTime()-s.time.getTime()>6e5)}const kt=d.memo((function(e){let{history:t,forkOf:s,autosave:r,version:a,dispatch:l,focusId:o,id:c,isPausedLoad:d,modes:h}=e;const u=function(e){let{history:{events:t,first_public_version:s,identifiers:n,merges:r,paused_version:i,users:a},forkOf:l,modes:o,now:c=new Date}=e;const d=new Map;for(const V of a)d.set(V.id,V);for(const V of r)d.set(V.user.id,V.user);const h=d.size;t=t.slice().reverse().filter((e=>"noop"!==e.type));const u=[];for(let V=0;V<t.length;V++){const e=t[V],{user_id:n,publish_user_id:a,time:c,publish_time:h}=e,m=(0,te.Z)(e,["user_id","publish_user_id","time","publish_time"]),p=r.find((t=>e.version===t.to_end_version));u.push((0,xe.Z)((0,ee.Z)({},m),{user:d.get(n),publish_user:d.get(a),time:c,publish_time:h,fork:l&&l.version===e.version?l:null,merge:p,paused_version:i===m.version,first_public_version:s===m.version,latest_version:0===V,mode:e.node_id?o.get(e.node_id):void 0}))}const m=new Map,p=new Map,x=new Map,f=new Map(n);for(let V=u.length-1;V>=0;V--){const e=u[V];switch(e.type){case"modify_node":case"insert_node":{const t=m.get(e.node_id);t&&e.node_name&&t!==e.node_name&&(e.node_old_name=t),m.set(e.node_id,e.node_name),p.set(e.node_id,e.node_value_start);break}case"modify_data":case"move_node":case"pin_node":case"unpin_node":case"remove_node":m.get(e.node_id)?e.node_name=m.get(e.node_id):p.get(e.node_id)?e.node_value_start=p.get(e.node_id):f.has(e.node_id)&&Object.assign(e,f.get(e.node_id));break;case"modify_name":{const t=m.get(e.node_id);t&&e.node_name&&t!==e.node_name&&(e.node_old_name=t),m.set(e.node_id,e.node_name);break}case"revert":x.set(e.version,e.node_id)}}const g=u.findIndex((e=>"create"===e.type));g>=0&&u.splice(g+1,u.length);let v,b=0;for(const[V,w]of u.entries()){const e=+w.publish_time;if(e&&e>b&&(b=e,v=w),"revert"===w.type){let e=w.node_id;for(;x.has(e);)e=x.get(e);w.node_id=e}w.oldest_version=V===u.length-1}v&&(v.latest_publish=!0);const j=new Map;for(const V of u){let e;e=V.time?(0,xt.gE)(V.time,c)?(0,xt.vm)(V.time):(0,xt.um)(V.time,c)?(0,xt.mr)(V.time,{month:"short",day:"numeric"}):(0,xt.mr)(V.time,{month:"short",day:"numeric",year:"numeric"}):"Earlier";let t=j.get(e);t?t.push(V):(t=[V],j.set(e,t))}const y=[];for(const[V,w]of j){const e=wt(w,V);e&&y.push(e)}return{ranges:y,events:u,userCount:h}}({history:t,forkOf:s,modes:h});return(0,n.jsx)("div",{className:"overflow-y-auto",children:(0,n.jsxs)("div",{className:"jsx-d511b6cc9924123c history pb3",children:[(0,n.jsx)(jt,{}),u.ranges.map(((e,t)=>(0,n.jsx)(bt,{range:e,dispatch:l,isVersioned:!r&&!d,currentVersion:a,isFirst:0===t,focusId:o,id:c},t))),(0,n.jsx)(i(),{id:"d511b6cc9924123c",children:".history.jsx-d511b6cc9924123c{display:grid;grid-template-columns:auto auto auto auto 1fr auto;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center}"})]})})})),Nt=(0,T.$j)((e=>{let{notebook:t}=e;return{notebook:t}}),(e=>({dispatch:e})))((e=>{let{notebook:{autosave:t,id:s,forkOf:r,saveVersion:i,model:{version:a,nodes:l},focusId:o,isPausedLoad:c},dispatch:d}=e;const{data:h}=(0,S.h_)("/document/".concat(s,"/history")),p=new Map(l.map((e=>{let{id:t,mode:s}=e;return[t,s]}))),x=t?a:i;return(0,n.jsxs)(m.X,{children:[(0,n.jsx)(m.h,{children:"Version history"}),h?(0,n.jsx)(kt,{history:h,forkOf:r,autosave:t,version:x,dispatch:d,id:s,focusId:o,isPausedLoad:c,modes:p}):(0,n.jsx)("div",{className:"flex justify-center pa4",children:(0,n.jsx)(u.Z,{})})]})})),Zt=c()((()=>Promise.all([s.e(5725),s.e(8850)]).then(s.bind(s,58850))),{loadableGenerated:{webpack:()=>[58850]}});var Lt=s(78009),Mt=s(54667),St=s(35053),Ht=s(96386),_t=s(33042);const Rt=14,Et="var(--moon-gray)",Dt=e=>{let{from:t,to:s,sign:r,yScale:i}=e;const a="circular"===(0,Ht.Do)(t,s);return(0,n.jsx)("path",{d:"M ".concat(3*r," 0 H ").concat(r*Rt/2," v ").concat(i(t.node,s.node)," h ").concat(r*(a?-1:1)*4),fill:"none",strokeWidth:"2",stroke:"currentColor"})},Ft=e=>{let{node:t,nameClassName:s}=e;const r=(0,$e.Qc)(t);let i=(0,$e.u2)(t);!i&&(0,Ye.hN)(t)&&(i="cell ".concat(t.id));const a=r.id;let l=t.value;return a&&(l="".concat(l.slice(0,a.start)," ").concat(l.slice(a.end))),l=l.trim(),l.length>255&&(l="".concat(l.slice(0,255),"\u2026")),(0,n.jsxs)("div",{className:"truncate code f7",title:"".concat(i?"".concat(i," "):"").concat(l),children:[i&&(0,n.jsxs)("span",{className:s,children:[i," "]}),l]})},It=d.memo((function(e){let{node:t,connections:s,focusedNode:r,participants:a,selected:o,error:c,yScale:h,dispatch:u,onSelect:m,readOnly:p}=e;const{id:x}=t,f=s.get(t),{up:g,down:v,isIsland:b}=f,j=(0,d.useRef)(null);(0,St._)(x,j,void 0,!0,p,u,"minimap-cell","minimap-cells");const y=r?(0,Ht.Do)(f,s.get(r)):"none",V="none"===y,w="same"===y,C="direct downstream"===y||"indirect downstream"===y,k="direct upstream"===y||"indirect upstream"===y,N="direct downstream"===y||"direct upstream"===y;return(0,n.jsxs)("button",{ref:j,"data-cy":y,"data-node-id":x,style:{height:21,fontFamily:"inherit",color:c?"var(--red)":w||N?"var(--blue)":b||r?Et:"black",paddingLeft:45,paddingTop:1,paddingBottom:1},onClick:e=>{e[Fe.Ao]?u({type:"selectionToggle",id:x}):m({type:w?"blur":"focus",id:x},{focused:w,downstream:C,upstream:k,direct:N})},className:"jsx-5b348d2ff6ad01ac bg-white minimap-cell br2 bn pv0 pr0 bg-transparent tl w-100 flex relative pointer justify-between items-center",children:[(0,n.jsxs)("div",{style:{boxShadow:o?"inset 0 0 0 1.5px var(--washed-blue)":void 0},className:"jsx-5b348d2ff6ad01ac "+(l()("flex minimap-cell-label h-100 w-100 ph1 items-center moon-gray br2",w?"bg-blue white focused":"")||""),children:[(0,n.jsx)(Ft,{node:t,nameClassName:w?"fw6":N?"blue":r?"":"black"}),a&&(0,n.jsx)("span",{className:"jsx-5b348d2ff6ad01ac ml3",children:(0,n.jsx)(Lt.l,{size:14,link:!1,participants:a})})]}),(0,n.jsxs)("svg",{style:{overflow:"visible",top:10.5,left:"calc(var( --spacing-extra-small ) + ".concat(17,"px)"),width:30,height:30},className:"jsx-5b348d2ff6ad01ac "+(l()("absolute","z-".concat(w?2:1))||""),children:[(0,n.jsxs)("g",{transform:"translate(".concat(r?C?Rt:k?-14:0:0,", 0)"),className:"jsx-5b348d2ff6ad01ac",children:[!(r&&V)&&(0,n.jsxs)("g",{className:"jsx-5b348d2ff6ad01ac",children:[g.length&&(0,n.jsx)("path",{d:"M 0 0 h ".concat(-8),fill:"none",strokeWidth:"2",stroke:"currentColor",className:"jsx-5b348d2ff6ad01ac"}),v.length&&(0,n.jsx)("path",{d:"M 0 0 h ".concat(8),fill:"none",strokeWidth:"2",stroke:"currentColor",className:"jsx-5b348d2ff6ad01ac"})]}),(0,n.jsx)("circle",{r:b?1.5:3,fill:"currentColor",className:"jsx-5b348d2ff6ad01ac"})]}),w&&(0,n.jsxs)("g",{className:"jsx-5b348d2ff6ad01ac pen",children:[v.map(((e,t)=>(0,n.jsx)(Dt,{from:f,to:s.get(e),sign:1,yScale:h},t))),g.map(((e,t)=>(0,n.jsx)(Dt,{from:f,to:s.get(e),sign:-1,yScale:h},t)))]})]}),(0,n.jsx)(i(),{id:"5b348d2ff6ad01ac",children:".minimap-cell.jsx-5b348d2ff6ad01ac:hover .minimap-cell-label.jsx-5b348d2ff6ad01ac:not(.focused){background-color:var(--near-white)}"})]})})),Tt=(0,T.$j)((e=>{let{notebook:t,currentUser:s}=e;return{notebook:t,currentUser:s}}),(e=>({dispatch:e})))((e=>{let{notebook:t,currentUser:s,dispatch:r}=e;const{model:i,editorStates:a,participants:l,focusId:o,selectionFocusId:c,selection:h,dropId:u}=t,{nodes:p}=i,x=(0,E.os)(t),f=(0,d.useMemo)((()=>function(e){const t=new Map;for(const s of e){const{node_ids:e}=s;for(const n of e)t.has(n)?t.get(n).push(s):t.set(n,[s])}return t}(l)),[l]),g=(0,d.useMemo)((()=>(0,Ht.E6)(p)),[p]),v=(0,d.useMemo)((()=>(e,t)=>21*(p.indexOf(t)-p.indexOf(e))),[p]),b=(0,tt.GS)(tt.ro),{0:j,1:y}=(0,d.useState)(null),V="focus"===(null===j||void 0===j?void 0:j.type)?(0,_t.DY)(i,j.id):"blur"===(null===j||void 0===j?void 0:j.type)?void 0:null!==o?(0,_t.DY)(i,o):null!==c?(0,_t.DY)(i,c):void 0;function w(e,n){b?y(e):r(e),(0,we.MR)((0,we.ym)({type:"notebook:view:minimapClick",data:n,eventVersion:2,notebook:t,currentUser:s}))}const C=(0,d.useRef)(!1);return(0,d.useEffect)((()=>(C.current=!0,()=>{C.current=!1})),[]),(0,d.useEffect)((()=>()=>{j&&!C.current&&r(j)}),[r,j]),(0,n.jsxs)(m.X,{children:[(0,n.jsx)(m.h,{children:"Minimap"}),(0,n.jsx)("div",{className:"pa3 mb1 relative minimap-cells",children:p.map((e=>{var t;return(0,n.jsxs)(d.Fragment,{children:[u===e.id&&(0,n.jsx)("div",{className:"absolute bt b--blue",style:{marginTop:-.5,width:"calc(100% - 2 * var( --spacing-medium ))"}}),(0,n.jsx)(It,{node:e,connections:g,focusedNode:V,selected:h.has(e.id),participants:f.get(e.id),error:!!(null===(t=a.get(e.id))||void 0===t?void 0:t.field(Mt.ei).length),yScale:v,onSelect:w,dispatch:r,readOnly:x})]},e.id)}))})]})}));var Pt=s(586),At=s(69150);const Ot=c()((()=>Promise.all([s.e(637),s.e(2828)]).then(s.bind(s,62828))),{loadableGenerated:{webpack:()=>[62828]}}),zt=c()((()=>Promise.all([s.e(637),s.e(559)]).then(s.bind(s,10559))),{loadableGenerated:{webpack:()=>[10559]}});function Ut(e){const t=At.j;switch(e){case"help":return{pane:(0,n.jsx)(Ot,{}),closeLabel:"help",width:t};case"files":return{pane:(0,n.jsx)(_e,{}),closeLabel:"files",width:t};case"history":return{pane:(0,n.jsx)(Nt,{}),closeLabel:"history",width:t};case"guide":return{pane:(0,n.jsx)(zt,{}),closeLabel:"guide",width:t};case"minimap":return{pane:(0,n.jsx)(Tt,{}),closeLabel:"minimap",width:At.l6};case"dependencies":return{pane:(0,n.jsx)(Y,{}),closeLabel:"dependencies",width:t};case"insights":return{pane:(0,n.jsx)(Zt,{}),closeLabel:"insights",width:t};case"find":return{pane:(0,n.jsx)(rt,{}),closeLabel:"find",width:t};case"databases":return{pane:(0,n.jsx)(O,{}),closeLabel:"databases",width:t};default:return{pane:null,closeLabel:"",width:0}}}const Bt=(0,T.$j)((e=>{let{page:t}=e;return{paneType:t.pane,helpArticlesOpen:t.helpArticlesOpen}}),(e=>({dispatch:e})))((e=>{let{dispatch:t,paneType:s,helpArticlesOpen:r,panes:a}=e;const o=(0,tt.GS)(tt.ro),{pane:c,closeLabel:d,width:u}=Ut(s);return(0,n.jsxs)("div",{className:i().dynamic([["d611e22a80e7db2f",[At.Lv,tt.hs,tt.pp,At.Lv,At.Sf,u]]])+" flex fixed z-1",children:[o&&"guide"===s?null:c&&(0,n.jsxs)("div",{className:i().dynamic([["d611e22a80e7db2f",[At.Lv,tt.hs,tt.pp,At.Lv,At.Sf,u]]])+" mt3-l shadow-1-ns br3 self-start bg-white flex pane",children:[(0,n.jsx)("button",{style:{top:"2px"},onClick:()=>t({type:"dismissPane"}),className:i().dynamic([["d611e22a80e7db2f",[At.Lv,tt.hs,tt.pp,At.Lv,At.Sf,u]]])+" absolute dn-l dismiss-button pointer pa3 bn bg-transparent z-4",children:(0,n.jsx)(h.Z,{className:l()({white:"guide"===s}),"aria-label":"Close ".concat(d," pane")})}),c]},[s,...r].join()),(0,n.jsx)("div",{className:i().dynamic([["d611e22a80e7db2f",[At.Lv,tt.hs,tt.pp,At.Lv,At.Sf,u]]])+" gray hover-black mt3 ml1 sidebar animate-all dn db-l",children:a.map((e=>{let{type:r,icon:i,label:a,count:l,signpost:o,badgeStyle:d,unimplemented:h,disabled:u}=e;const m=!(h||u),x=(0,n.jsx)(p.Ct,{count:l,badgeStyle:d,disabled:!m,colorless:!0,selected:s===r,children:(0,n.jsx)(p.hU,{icon:i,onClick:m?()=>t({type:"togglePane",pane:r}):void 0,onKeyDown:m?e=>"Escape"===e.key&&t({type:"dismissPane"}):void 0,disabled:!m,selected:s===r,className:"ma2",colorless:!0,solidBackground:!0,title:(0,_.fm)(h?"".concat(a," is not yet implemented"):"".concat(s===r?"Close":"Open"," ").concat(a))})},r);return o&&!c?(0,n.jsx)(Pt.y,{type:o,top:16,left:8,children:x},r):x}))}),(0,n.jsx)(i(),{id:"d611e22a80e7db2f",dynamic:[At.Lv,tt.hs,tt.pp,At.Lv,At.Sf,u],children:".fixed.__jsx-style-dynamic-selector{top:".concat(At.Lv,"px;right:var(--spacing-medium);bottom:0}@media ").concat(tt.hs,"{.fixed.__jsx-style-dynamic-selector{right:0}}.pane.__jsx-style-dynamic-selector{position:fixed;top:0;right:0;bottom:0;left:0}@media ").concat(tt.pp,"{.pane.__jsx-style-dynamic-selector{position:static;max-height:-webkit-calc(\n              100vh - ").concat(At.Lv,"px - ").concat(At.Sf,"px - 38px\n            );max-height:-moz-calc(\n              100vh - ").concat(At.Lv,"px - ").concat(At.Sf,"px - 38px\n            );max-height:calc(\n              100vh - ").concat(At.Lv,"px - ").concat(At.Sf,"px - 38px\n            );width:-webkit-calc(\n              ").concat(u,"px - 2 * var(--spacing-small) - var(--spacing-extra-small) -\n                var(--width-2) \n            );width:-moz-calc(\n              ").concat(u,"px - 2 * var(--spacing-small) - var(--spacing-extra-small) -\n                var(--width-2) \n            );width:calc(\n              ").concat(u,"px - 2 * var(--spacing-small) - var(--spacing-extra-small) -\n                var(--width-2) \n            )}}.dismiss-button.__jsx-style-dynamic-selector{top:0;right:0}")})]})}))},12627:function(e,t,s){s.d(t,{aN:function(){return I},S5:function(){return P}});var n=s(85893),r=s(90793),i=s(94184),a=s.n(i),l=s(67294),o=s(60486),c=s(37497),d=s(76522),h=s(49516),u=s(3764),m=s(47311),p=s(22513),x=s(84193),f=s(70975),g=s(41799),v=s(69396),b=s(22027),j=s(48627),y=s(12447),V=s(3894),w=s(40076),C=s(3142),k=s(84236),N=s(4242);const Z=e=>{let{node:t}=e;const{id:s,data:r,mode:i}=t,{operations:{from:{table:o}}}=r,c=(0,V.M7)(r),h=(0,N.I0)(),{disabled:u}=(0,N.v9)((e=>{let{notebook:t}=e;return{disabled:t.safe||(0,C.os)(t)}})),m=(0,y.GS)(y.pp),{0:p,1:x}=(0,l.useState)(),b=(0,l.useRef)();async function Z(e){h({type:"setDataOperations",id:s,operations:(0,g.Z)((0,v.Z)((0,g.Z)({},w.Zu.defaultNode.data.operations),{from:{table:e}}),"sqlite"!==(null===p||void 0===p?void 0:p.dialect)&&"duckdb"!==(null===p||void 0===p?void 0:p.dialect)&&{select:{columns:await new j.n4(c,e,i).run(h).then((e=>Array.from(e.keys())),(()=>null))},slice:{from:0,to:1e3}})})}return(0,l.useEffect)((()=>{const e=new j.YG(c);b.current=e,e.run(h).then((t=>{e===b.current&&x(t)}),(()=>{e===b.current&&x(null)}))}),[h,c]),p?p.hasDescribeTables?(0,n.jsxs)(f.vz,{"data-cy":"table-selector",value:JSON.stringify(o)||"",className:"flex items-center dark-gray hover-black focus-black-05 br2 br--right mr1",disabled:u,onChange:e=>Z(JSON.parse(e)),children:[(0,n.jsx)(f.Y4,{children:(0,n.jsxs)("div",{className:a()("inline-flex items-center justify-between w-100",u&&"moon-gray"),children:[(0,n.jsx)("div",{className:"mr1 truncate",style:{maxWidth:m?200:75},children:o?(0,k.Vi)(o):"Select a table\u2026"}),(0,n.jsx)(f.r9,{className:"inline-flex items-center",children:(0,n.jsx)(d.Z,{})})]})}),(0,n.jsx)(L,{source:c,table:o})]}):(0,n.jsx)(M,{table:o,setTable:e=>Z(e),disabled:u}):null},L=e=>{let{source:t,table:s}=e;const i=(0,N.I0)(),a=(0,l.useRef)(),{0:o,1:c}=(0,l.useState)(),{isExpanded:d}=(0,r.kR)(),u=(0,y.GS)(y.pp);return(0,l.useEffect)((()=>c(void 0)),[t]),(0,l.useEffect)((()=>{if(d){const e=new j.Y2(t);a.current=e,e.run(i).then((t=>{e===a.current&&c(t.sort(k.Tf))}),(t=>{e===a.current&&console.error("Error fetching list of tables: ",t)}))}}),[i,d,t]),(0,n.jsx)(f.jI,{style:{marginLeft:-8,maxHeight:"40vh",minWidth:u?250:200,width:"auto"},children:(0,n.jsx)(f.uf,{style:{padding:0,margin:0},children:(0,n.jsxs)("div",{className:"pv12",children:[(0,n.jsx)("div",{className:"gray f7 ph12 pb12",children:"Tables"}),o?o.length?o.map(((e,t)=>(0,n.jsx)(f.wt,{className:"flex items-center justify-between nowrap",style:{padding:"2px 12px",margin:0},value:JSON.stringify(e),children:(0,n.jsxs)("span",{className:"flex items-center",title:(0,k.Vi)(e),style:{maxWidth:u?400:150},children:[(0,n.jsx)("span",{className:"truncate",children:(0,k.Vi)(e)}),(0,k.YY)(s,e)&&(0,n.jsx)(h.Z,{className:"ml2 near-black flex-shrink-0"})]})},t))):(0,n.jsx)("div",{className:"ph12 gray","data-cy":"no-tables",children:"No tables found"}):(0,n.jsx)("div",{className:"ph12 dark-gray",children:(0,n.jsx)(b.Z,{})})]})})})},M=e=>{let{table:t,setTable:s,disabled:r}=e;const i=(0,y.GS)(y.hs)?340:110,{0:a,1:o}=(0,l.useState)(t?(0,k.Vi)(t):"");return(0,n.jsx)("input",{name:"tablename",type:"text","data-cy":"table-input-selector",className:"ba b--light-gray br2 br--right ph2 flex items-center",placeholder:"Enter a table\u2026",value:a,onChange:e=>o(e.target.value.replace(/\s/g,"")),onBlur:()=>s(function(e){let t="",s="";const n=[];for(let r=0;r<e.length;r++){const i=e[r];if("."===i){n.push(s),s="";continue}if(0===s.length){if("`"===i||'"'===i||"'"===i){t=i;continue}s+=i;continue}const a=r+1<e.length?e[r+1]:"";i!==t||a!==t?"\\"!==i||a!==t?i!==t?s+=i:t="":(s+=a,r++):(s+=i,r++)}s&&n.push(s);if(0===n.length)return null;if(n.length>2)return{database:n[0],schema:n[1],table:n[2]};return n.length>1?{schema:n[0],table:n[1]}:n.length>0?{table:n[0]}:null}(a)),title:a,disabled:r,onKeyDown:e=>{"Enter"===e.key&&(e.preventDefault(),e.target.blur())},spellCheck:!1,style:{width:i,marginLeft:-2}})};var S=s(3961),H=s(602),_=s(74080),R=s(2741),E=s(8802),D=s(66421),F=s(36448);const I=e=>{let{node:t}=e;const{mode:s,data:{source:r}}=t,i=(0,N.I0)(),{0:a,1:c}=(0,l.useState)(),d=(0,l.useRef)();(0,l.useEffect)((()=>{if(null===r.name)d.current=void 0,c(null);else{const e=new j.FJ(r);d.current=e,e.run(i).then((t=>{e===d.current&&c(t)}),(()=>{e===d.current&&c(null)}))}}),[i,r]);const h="table"===s&&null!==r.name&&!!a&&!(0,o.yD)(a.dialect);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(T,{node:t,right:h}),h&&(0,n.jsx)(Z,{node:t}),(0,n.jsx)("button",{className:"flex items-center bn bg-transparent pointer dark-gray hover-black",title:"Show databases",onClick:()=>i({type:"togglePane",pane:"databases"}),children:(0,n.jsx)(u.Z,{})})]})},T=e=>{let{node:t,right:s}=e;const{id:r,data:{source:i}}=t,l=(0,N.I0)(),{disabled:o}=(0,N.v9)((e=>{let{notebook:t}=e;return{disabled:t.safe||(0,C.os)(t)}})),c=(0,N.v9)((e=>{let{currentUser:t}=e;return t})),h=(0,y.GS)(y.pp);var u;return(0,n.jsxs)(f.vz,{"data-cy":"data-source-selector",value:JSON.stringify(i),className:a()("flex items-center mr-tiny ml1 focus-black-05 dark-gray hover-black",s&&"br--left"),disabled:o,onKeyDown:e=>{"Space"!==e.key&&"Enter"!==e.key||e.metaKey||e.ctrlKey||e.preventDefault()},onChange:e=>{const t=JSON.parse(e);(0,V.U_)(i,t)||l({type:"setDataSource",id:r,source:t})},children:[(0,n.jsx)(f.Y4,{className:"flex items-center",children:(0,n.jsxs)("div",{className:a()("inline-flex items-center justify-between",o&&"moon-gray"),children:[(0,n.jsx)("div",{className:"mr1 truncate",style:{maxWidth:h?200:75},children:null!==(u=i.name)&&void 0!==u?u:"Select a data source\u2026"}),(0,n.jsx)(f.r9,{className:"inline-flex items-center",children:(0,n.jsx)(d.Z,{})})]})}),(0,n.jsx)(A,{node:t,currentUser:c})]})};function P(e){let{name:t,mimeType:s}=e;switch(s){case"application/x-sqlite3":return"sqlite";case"text/csv":return"csv";case"text/tab-separated-values":return"tsv";case"application/json":return"json";default:if(/\.arrow$/i.test(t))return"arrow";if(/\.parquet$/i.test(t))return"parquet"}return null}const A=e=>{let{node:t,currentUser:s}=e;const{id:i,mode:a,data:{source:o},name:c}=t,d=(0,N.I0)(),h=(0,y.GS)(y.pp),{isExpanded:u}=(0,r.kR)(),m=(0,l.useRef)(),{allowPrivateData:p,allowAddDatabase:x,allowAddAttachments:g,readOnly:v,owner:b,files:j}=(0,N.v9)((e=>{let{notebook:t}=e;const n=(0,C.cE)(t);return{allowPrivateData:n,allowAddDatabase:n&&(0,F.NF)(t),allowAddAttachments:(0,_.j5)(s,t),readOnly:(0,C.os)(t),owner:t.owner,files:t.files}})),{data:k}=(0,H.h_)(p&&u&&(0,w.KO)(a)?"".concat("team"===b.type?"/team/".concat(b.id):"/user","/data-connectors?detail=false"):null),{0:Z,1:L}=(0,l.useState)([]),M="cell"===o.type&&!Z.some((e=>e.name===o.name)),I=("database"===o.type||"DatabaseClient"===o.type)&&!(null===k||void 0===k?void 0:k.some((e=>e.name===o.name))),T="FileAttachment"===o.type&&!j.has(o.name),A=(0,l.useMemo)((()=>{const e=[];for(const[s,n]of j){const r=P(n);null===r||(0,C.Jw)(n)||("chart"===a?("csv"===(t=r)||"tsv"===t||"json"===t)&&e.push({name:s,type:"FileAttachment",dialect:r,fileType:r}):e.push({name:s,type:"FileAttachment",dialect:r}))}var t;return e}),[j,a]);return(0,l.useEffect)((()=>{if(!u)return;const e=[],t=new S.S((async(s,n)=>{s({type:"request_data_sources",mode:a});try{for await(const s of n()){if(m.current!==t)return;const{name:n,dialect:r}=s;if(n===c)continue;const i={name:"".concat(n),type:"cell",dialect:(0,V.Ov)(r)};e.push(i),e.sort(V.zO),L(e.slice())}}catch(r){console.error("Error fetching database clients: ",r)}}));return m.current=t,t.run(d).catch((e=>{console.error("Error fetching database clients: ",e),L([])})),()=>{m.current=void 0,L([])}}),[a,d,u,c]),(0,n.jsx)(f.jI,{style:{minWidth:h?"10vw":"40vw",width:"auto",marginLeft:-8,maxHeight:"40vh"},"aria-label":"List of data sources",children:(0,n.jsxs)(f.uf,{style:{padding:0,margin:0},children:[(Z.length>0||M||!(0,w.KO)(a))&&(0,n.jsx)("div",{className:"bb b--light-silver pv12",children:(0,n.jsx)(O,{sources:Z,stale:!!M,sectionTitle:"Cells",source:o,mode:a})}),(!v&&g||A.length>0)&&(0,n.jsx)("div",{className:"bb b--light-silver pv12",children:(0,n.jsx)(O,{sources:A,stale:!!T,sectionTitle:"File attachments",source:o,mode:a,addDisabled:v||!g,onAdd:()=>{(0,D.Yb)(s)?(d({type:"notebookFilePickerOpened",source:"filesPane",trigger:"click"}),(0,R.Z)({multiple:!1}).then((e=>{if(d({type:"attachLocalFiles",files:e,source:"filesPane",trigger:"click"}),e.length>0){const t=e[0],s=P({name:t.name,mimeType:t.type,createTime:new Date(t.lastModified),status:"pending"});if(s){const e={name:t.name,type:"FileAttachment",dialect:s};d({type:"setDataSource",id:i,source:e})}}}))):s||d({type:"showModal",modal:"login",modalProps:{loginReason:"files"},trigger:"click",source:"filesPaneAttachFileButton"})}})}),(0,w.KO)(a)&&(0,n.jsx)("div",{className:"pv12",children:(0,n.jsx)(O,{sources:k?k.map((e=>{let{name:t,type:s}=e;return{name:t,type:"DatabaseClient",dialect:s}})):[],stale:!!I,sectionTitle:"Databases",source:o,mode:a,link:"/".concat("team"===b.type?"team/@".concat(b.login,"/"):"","settings/databases"),onAdd:()=>d({type:"addedDatabase",id:i}),addDisabled:!x})})]},[(0,E.Z)(Z),(0,E.Z)(j),k&&(0,E.Z)(k)].join())})},O=e=>{let{sources:t,stale:s,source:r,sectionTitle:i,link:a="",onAdd:l=(()=>{}),addDisabled:o=!0}=e;const d={maxWidth:(0,y.GS)(y.pp)?350:150};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"dark-gray f7 ph12 flex justify-between items-center",style:{marginBottom:t.length>0?10:0},children:[i,"Databases"===i&&!o&&(0,n.jsx)("button",{className:"bn bg-transparent pa0 ma0",onClick:l,children:(0,n.jsx)(x.Z,{href:a,children:(0,n.jsx)("div",{className:"pointer pa2 nt2 nb2 f6 fw6 br-100 flex items-center ba b--transparent hover-bg-black-05",children:(0,n.jsx)(m.ZP,{})})})}),"File attachments"===i&&!o&&(0,n.jsx)(c.hU,{onClick:l,icon:m.ZP,"aria-label":"Upload file",colorless:!0,className:"nt2 nb2"})]}),t.map(((e,t)=>(0,n.jsxs)(f.wt,{className:"flex items-center justify-between nowrap",style:{padding:"2px 12px",margin:0},value:JSON.stringify(e),children:[(0,n.jsxs)("span",{className:"flex items-center overflow-x-hidden",title:e.name,style:d,children:[(0,n.jsx)("span",{className:"truncate",children:e.name}),(0,V.U_)(r,e)&&(0,n.jsx)(h.Z,{className:"ml1 near-black flex-shrink-0"})]}),(0,n.jsx)("span",{className:"mid-gray fw4 ml4",children:(0,V.w4)(e.dialect)})]},t))),s?(0,n.jsx)(z,{source:r,style:d}):t.length||"Cells"!==i?null:(0,n.jsx)("div",{className:"i gray ph3 pt2",children:"Add data to a cell in your notebook"})]})},z=e=>{let{source:t,style:s}=e;return(0,n.jsx)(f.wt,{className:"flex items-center justify-between nowrap gray",style:{padding:"2px 12px",margin:0},value:JSON.stringify(t),children:(0,n.jsxs)("span",{className:"flex items-center overflow-x-hidden",title:t.name,style:s,children:[(0,n.jsx)("span",{className:"truncate",children:t.name}),(0,n.jsx)(h.Z,{className:"ml1 flex-shrink-0"}),(0,n.jsx)(p.Z,{className:"ml1 flex-shrink-0"})]})})}},3683:function(e,t,s){s.d(t,{q:function(){return h}});var n=s(41799),r=s(69396),i=s(99534),a=s(85893),l=s(67294),o=s(14151),c=s(93939),d=s(62990);const h=e=>{var{time:t,absolute:s,numeric:h,precision:u}=e,m=(0,i.Z)(e,["time","absolute","numeric","precision"]);const p=(0,c.L)(t),x=(0,o.d)((0,l.useCallback)((()=>t.toLocaleString("en")),[t]));return(0,a.jsx)("span",(0,r.Z)((0,n.Z)({title:x},m),{children:s?h?(0,d.WB)(t):(0,d.p6)(t):u?(0,d.aP)(t,p,u):(0,d.lY)(t,p)}))}},80548:function(e,t,s){s.d(t,{w:function(){return h}});var n=s(23545),r=s(69441),i=s(12447),a=s(51289),l=s(3142),o=s(76020),c=s(41799);class d{fileName(e){return"number"===typeof e?"/node-".concat(e,".ts"):e}async updateFile(e,t){try{return await this.updateFileStrict(e,t)}catch(s){if(s.errorMessage&&0===s.errorMessage.indexOf("Debug Failure"))return;throw s}}async updateFileStrict(e,t){if(this.contentByFileName.get(this.fileName(e))!==t){if(this.contentByFileName.set(this.fileName(e),t),this.workerError)throw this.workerError;return this.request({type:"updateFile",fileName:this.fileName(e),content:t})}}async deleteFile(e){if(this.contentByFileName.delete(this.fileName(e)),this.workerError)throw this.workerError;return this.request({type:"deleteFile",fileName:this.fileName(e)})}getCompletionsAtPosition(e,t){if(this.workerError)throw this.workerError;return this.request({type:"completions",fileName:this.fileName(e),pos:t})}getSignatureHelpItems(e,t,s){if(this.workerError)throw this.workerError;return this.request({type:"signatureHelp",fileName:this.fileName(e),content:s,pos:t})}request(e){const t=(0,c.Z)({id:++this.id},e);return new Promise(((e,s)=>{this.requests.set(t.id,[t=>{t&&"payload"in t?e(t.payload):e()},s]),this.send(t)}))}send(e){this.worker.postMessage(e)}messaged(e){if(!e.isTrusted)return;const t=e.data,{id:s}=t;if(!this.requests.has(s))return;const[n,r]=this.requests.get(s);if(this.requests.delete(s),"error"===t.type)t.errorMessage&&0===t.errorMessage.indexOf("Debug Failure")&&n(void 0),r(t);else n(t)}constructor(e){this.id=0,this.requests=new Map,this.contentByFileName=new Map,this.workerError=void 0,this.includePlot=!1,this.worker=new Worker(s.tu(new URL(s.p+s.u(7444),s.b))),this.worker.onerror=e=>{this.workerError=e.error instanceof Error?e.error:new Error(e.message||"TypeScript worker error")},this.worker.onmessage=e=>{this.messaged(e)},this.request({type:"set_current_user",user:e})}}function h(e){const t=a.Qg&&window.matchMedia(i.ro).matches,{notebook:s,currentUser:c}=e.getState();a.Qg&&(0,l.S1)(c)&&!n.R.loaded&&(0,n.W)(e.dispatch).then((()=>e.dispatch({type:"enableVimKeys"})));const h=new r.Z(e.dispatch,function(e,t,s){let n=null;if(!t){try{n=new d(s)}catch(r){return null}for(const t of e.model.nodes)n.updateFile(t.id,t.value)}return n}(s,t,c));return h.setState(s),(0,o.x)(e,(()=>{const t=e.getState(),{transactions:s}=t.notebook;delete t.notebook.transactions,h.setState(t.notebook,s)})),h}},35053:function(e,t,s){s.d(t,{_:function(){return d}});var n=s(67294);let r=0,i=null;function a(){i=requestAnimationFrame(a),scrollBy(0,r)}function l(e){r=Math.min(0,e-20)||Math.max(0,e-innerHeight+20),r&&!i?i=requestAnimationFrame(a):i&&!r&&(cancelAnimationFrame(i),i=null)}var o=s(61107);function c(e,t,s){for(s=s?s.nextElementSibling:t.firstElementChild;s&&!s.classList.contains(e);)s=s.nextElementSibling;return s||null}function d(e,t,s,r,i,a,d,h){const{0:u,1:m}=(0,n.useState)(!1);return(0,n.useEffect)((()=>{const n=t.current,u=navigator.maxTouchPoints||"ontouchstart"in n;let p,x=!1,f=!1,g=NaN,v=NaN;function b(e){e.ctrlKey||e.button||!e.isPrimary||!r||i||(p=e.target,p.setPointerCapture(e.pointerId),n.style.cursor="grabbing",f=void 0,x=!0,g=e.clientX,v=e.clientY)}function j(r){if(!x||!r.isPrimary)return;const{clientX:i,clientY:o}=r;if(void 0===f){if(i-g>20)return n.style.cursor="",p.releasePointerCapture(r.pointerId),p=void 0,void(f=!1);Math.abs(o-v)>20&&(f=!0,a({type:"dragStarted",id:e}),m(!0),(null===s||void 0===s?void 0:s.current)&&t.current&&t.current.dispatchEvent(new MouseEvent("mousedown",{bubbles:!0})))}if(!f)return;const u=n.closest(".".concat(h));let b;for(;b=c(d,u,b);){const e=b.getBoundingClientRect();if((e.top+e.bottom)/2>o)break}a({type:"dragged",id:b?+b.dataset.nodeId:null}),l(o)}function y(e){e.isPrimary&&(p&&(p.releasePointerCapture(e.pointerId),p=void 0,n.style.cursor=""),f&&(a({type:"dragEnded"}),m(!1)),l(NaN),f=!1,x=!1)}return u&&n.addEventListener("touchmove",o.P),n.addEventListener("pointerdown",b),n.addEventListener("pointermove",j),n.addEventListener("pointerup",y),n.addEventListener("pointercancel",y),n.addEventListener("lostpointercapture",y),()=>{u&&n.removeEventListener("touchmove",o.P),n.removeEventListener("pointerdown",b),n.removeEventListener("pointermove",j),n.removeEventListener("pointerup",y),n.removeEventListener("pointercancel",y),n.removeEventListener("lostpointercapture",y)}}),[a,r,i,t,m,s,h,d,e]),[u,m]}},18582:function(e,t,s){s.d(t,{r:function(){return r}});var n=s(31343);async function r(e,t){const s=await fetch(e,{headers:{authorization:"Bearer ".concat(t),"content-Type":"application/json"}});if(!s.ok){const e=s.headers.get("content-type");if(null===e||void 0===e?void 0:e.startsWith("application/json")){const{error:e}=await s.json();throw new Error(e.message)}throw new n.ZP(s.status,s.url)}return s.json()}},40873:function(e,t,s){s.d(t,{v:function(){return o}});const n={test:()=>!1,matches:()=>[]};class r{test(e){if(!e)return!1;let t=0;for(const s of this.terms){if(s.lastIndex=t,!s.test(e))return this.fallback.test(e);t=s.lastIndex}return!0}matches(e){const t=this.fallback.matches(e);if(!e)return t;let s=0;for(const n of this.terms){n.lastIndex=s;const r=n.exec(e);if(!r)continue;const i=r.index+r[1].length,a=i+r[2].length;t.push([i,a]),s=n.lastIndex}return t}constructor({terms:e=[],strict:t=!1,fallback:s=n}){this.terms=e,this.strict=t,this.fallback=s}}function i(e,t){return String(e).split(/\s+/g).filter((e=>e)).map((e=>l(e,t)))}function a(e,t){return Array.from(String(e).replace(/\s+/g,""),(e=>l(e,t)))}function l(e,t){return new RegExp("(^|[^\\p{L}])(".concat(e.replace(/[\\^$.*+?()[\]{}|]/g,"\\$&"),")"),t)}function o(e){let{allowAcronyms:t=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const s=i(e,"iu");return new r({terms:s,fallback:1===s.length&&t?new r({terms:a(e,"iug"),strict:!0}):void 0})}},47743:function(e,t,s){function n(e){return!!/drive\/v3\/files\/.*/.test(e)}s.d(t,{N6:function(){return i},SW:function(){return o},__:function(){return d},eJ:function(){return r},ty:function(){return n},wA:function(){return l}});const r="614404957759",i="AIzaSyAjxeAzLAiTpmClMsnQ6OuZMg5BC7AckCA",a=new Map([["application/vnd.google-apps.document","text/html"],["application/vnd.google-apps.drawing","image/svg+xml"],["application/vnd.google-apps.form","text/html"],["application/vnd.google-apps.map","text/html"],["application/vnd.google-apps.photo","image/jpeg"],["application/vnd.google-apps.presentation","application/pdf"],["application/vnd.google-apps.script","text/plain"],["application/vnd.google-apps.site","text/html"],["application/vnd.google-apps.spreadsheet","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"]]);function l(e,t){return["".concat("https://www.googleapis.com").concat(e),t]}function o(e){return a.get(e)}let c;async function d(){return c||(c=new Promise((e=>{const t="gapiLoaded".concat(Math.random()),s=document.createElement("script");s.src="https://apis.google.com/js/api.js?onload=".concat(t),window[t]=function(){e(window.gapi),delete window[t]},document.head.appendChild(s)}))),c}},11222:function(e,t,s){function n(e){return null!==e}s.d(t,{K:function(){return n}})},31115:function(e,t,s){function n(e,t){for(const s of e)if(t(s))return!0;return!1}function r(e,t){return e.length===t.length&&e.every((e=>t.includes(e)))&&t.every((t=>e.includes(t)))}s.d(t,{G:function(){return n},u:function(){return r}})},63527:function(e,t,s){s.d(t,{V:function(){return r}});var n=s(51289);function r(e){const t=new Map;for(const s of e){const e=s.length-1,n=s[e];for(let r=0;r<e;++r){const e=s[r],a=i(e);if(t.has(a))throw new Error("Duplicate entry: ".concat(e));t.set(a,n)}}return(e,s)=>{const n=t.get(a(s));return!!n&&n(e,s)}}function i(e){const t=e.split(/-(?!$)/);let s=t.pop();if(!s)throw new Error("Missing key: ".concat(e));s=s.toLowerCase(),"space"===s&&(s=" ");let r=!1,i=!1,l=!1,o=!1;for(const a of t)switch(a.toLowerCase()){case"meta":r=!0;break;case"alt":i=!0;break;case"ctrl":l=!0;break;case"shift":o=!0;break;case"mod":n.Mq?r=!0:l=!0;break;default:throw new Error("Unrecognized modifier: ".concat(a))}return a({key:s,ctrlKey:l,altKey:i,shiftKey:o,metaKey:r})}function a(e){const t=[];return e.ctrlKey&&t.push("Control"),e.altKey&&t.push("Alt"),e.shiftKey&&t.push("Shift"),e.metaKey&&t.push("Meta"),t.push(e.key.toLowerCase()),t.join("-")}},89642:function(e,t,s){s.d(t,{B5:function(){return i},ax:function(){return a},nm:function(){return l}});var n=s(36448);const r=new Map(Object.entries({"agpl-3.0":{short:"GNU AGPLv3",long:"GNU Affero General Public License v3.0"},"apache-2.0":{short:"Apache 2.0",long:"Apache License "},"bsd-3-clause":{short:"BSD 3-Clause",long:"BSD 3-Clause \u201cNew\u201d or \u201cRevised\u201d License"},"cc-by-4.0":{short:"CC BY 4.0",long:"Creative Commons Attribution 4.0 International"},"cc-by-sa-4.0":{short:"CC BY-SA 4.0",long:"Creative Commons Attribution Share Alike 4.0 International"},"gpl-3.0":{short:"GNU GPLv3",long:"GNU General Public License v3.0"},isc:{short:"ISC",long:"ISC License"},"lgpl-3.0":{short:"GNU LGPLv3",long:"GNU Lesser General Public License v3.0"},mit:{short:"MIT",long:"MIT License"},other:{short:"Other",long:"Other"}})),i=Array.from(r.keys());function a(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"short";if(!e)return"None";const s=r.get(e);if(!s)throw new Error("Unknown license identifier: ".concat(e));return s[t]}function l(e){return"Copyright ".concat((new Date).getFullYear()," ").concat((0,n.RX)(e))}},11342:function(e,t,s){s.d(t,{Le:function(){return o},Xk:function(){return u},Z8:function(){return c},ap:function(){return h},bh:function(){return d},g4:function(){return a},mL:function(){return l},sZ:function(){return m}});var n=s(51289),r=s(18582),i=s(11222);function a(e,t){return["".concat("https://graph.microsoft.com","/v1.0").concat(e),t]}function l(e,t){return(s,n)=>t?n&&!n["@odata.nextLink"]?null:n&&0!==s?[n["@odata.nextLink"],t]:a(e,t):null}function o(e){if(e){if(e.endsWith(".xlsx"))return"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet";if(e.endsWith(".pptx"))return"application/vnd.openxmlformats-officedocument.presentationml.presentation";if(e.endsWith(".docx"))return"application/vnd.openxmlformats-officedocument.wordprocessingml.document"}return"application/octet-stream"}async function c(e,t,s){const n=s?await(0,r.r)(...a("/me/memberOf/microsoft.graph.group",t)):{value:[]};return(await Promise.all([(0,r.r)(...a("/me/drives",t)).catch((()=>null)),...n.value.map((e=>(0,r.r)(...a("/groups/".concat(e.id,"/drives"),t)).catch((()=>null))))])).filter(i.K).flatMap((e=>e.value))}function d(e,t){var s,n;return((null===e||void 0===e?void 0:e.remoteItem)?null===(s=e.remoteItem.file)||void 0===s?void 0:s.mimeType:null===e||void 0===e||null===(n=e.file)||void 0===n?void 0:n.mimeType)||o(t)}function h(e){return(null===e||void 0===e?void 0:e.remoteItem)?e.remoteItem.size:null===e||void 0===e?void 0:e.size}function u(e){return!!/\/drives\/[!a-zA-Z0-9-_]+\/items\/([!a-zA-Z0-9-_]+)/.test(e)}function m(e){n.Qg&&s.e(2303).then(s.t.bind(s,52303,23)).then((t=>e(t)))}},56912:function(e,t,s){s.d(t,{$r:function(){return d},ng:function(){return u},uF:function(){return m},xT:function(){return c}});var n=s(33083),r=s(67294),i=s(33042),a=s(72760),l=s(928),o=s(602);function c(e){return!!e&&"error"in e}function d(e){let{imports:t}=e;const[[s]=[]]=t;if(!s)return{mainSpecifier:s,directImports:new Map};const n=[...new Set(t.flat())].map((e=>({specifier:e,children:[],childrenSet:new Set}))),r=new Map(n.map((e=>[e.specifier,e]))),i=new Map;for(const[a,l]of t){a===s&&i.set(l,[]);const e=r.get(a),t=r.get(l);e.childrenSet.has(l)||(e.childrenSet.add(l),e.children.push(t))}for(const a of i.keys())i.set(a,h(r.get(a),s));return{mainSpecifier:s,directImports:i}}function h(e,t){let{specifier:s,children:n}=e,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Set;return r.has(s)?[]:(r.add(s),[[t,s],...n.flatMap((e=>h(e,s,r)))])}function u(e,t,s){const n=new Map(s.filter((e=>"notebook"===e.type)).map((e=>{let{specifier:t,value:s}=e;return[t,l.Z.parse(s)]}))),r=new Map(Object.entries(e).map((e=>{let[t,s]=e;var r;const i=n.has(t)?n.get(t).version:void 0,a=c(s)||null===(r=l.Z.parse(s.resolution))||void 0===r?void 0:r.version;return[t,{lockStatus:void 0!==i?"locked":"unlocked",version:i,latestVersion:a,updatesAvailable:void 0!==i&&i!==a}]})));for(const[i,a]of t){let e=0,t=!1;for(const[,n]of a){const s=r.get(n);e+="locked"===(null===s||void 0===s?void 0:s.lockStatus)?1:0,t||(t=!!(null===s||void 0===s?void 0:s.updatesAvailable))}const s=r.get(i);s&&(s.lockStatus=e===a.length?"locked":0===e?"unlocked":"mixed",s.updatesAvailable=t)}return r}function m(e){let{id:t,saveVersion:s,model:l}=e,{ignoreResolutions:c}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const d=(0,r.useRef)(s),h=(0,r.useRef)(l.history.length),u=(0,r.useRef)(),m=(0,r.useRef)(new Set(l.nodes.map((e=>(0,n.oo)((0,a.Qc)(e))?e.id:void 0)).filter((e=>e)))),p=l.history.slice(h.current);for(const r of p){const{type:e,version:t}=r;switch(e){case"insert_node":case"modify_node":{const{node_id:e}=r,s=(0,i.DY)(l,e);if(!s)break;(0,n.oo)((0,a.Qc)(s))&&(m.current.add(e),d.current=t);break}case"remove_node":{const{node_id:e}=r;m.current.has(e)&&(m.current.delete(e),d.current=t);break}case"resolve_dependency":d.current=t}}h.current=l.history.length;const x="".concat(t,"@").concat(Math.min(s,d.current)),f="/document/".concat(x,"/imports").concat(c?"":"?resolutions=".concat(x)),{data:g,error:v}=(0,o.h_)(f);return v?(console.error("notebook import resolutions failed to load."),u.current):(g&&(u.current=g),u.current)}},76020:function(e,t,s){s.d(t,{Q:function(){return i},x:function(){return a}});var n=s(73935);const r=new WeakMap;function i(e){let t=r.get(e);if(t)return t;const s=[];return t=t=>{s.push(t),1===s.length&&Promise.resolve().then((()=>{(0,n.unstable_batchedUpdates)((()=>{s.splice(0,s.length).forEach(e.dispatch)}))}))},r.set(e,t),t}function a(e,t){let s=e.getState();return e.subscribe((()=>{const n=e.getState();n!==s&&(s=n,t())}))}}}]);