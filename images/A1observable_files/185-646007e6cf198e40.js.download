(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[185],{54397:function(e,t,n){"use strict";n.d(t,{W:function(){return g}});var r=n(85893),s=n(67294),a=n(14921),i=n(80026),o=n(41664),c=n.n(o),u=n(11163),l=n(37497),d=n(89905),m=n(97058),f=n(97559),h=n(19671);const p=e=>{let{onClose:t,announcement:{fields:n},currentUser:o}=e;const p=(0,u.useRouter)(),{0:v}=(0,s.useState)((()=>new Date)),{content:b,image:x,buttonText:g,buttonLink:j}=n,k=(0,s.useMemo)((()=>j?new URL(j,"https://observablehq.com"):void 0),[j]),y=(0,s.useMemo)((()=>{try{return(null===k||void 0===k?void 0:k.pathname)!==p.asPath&&(!(n.startDate&&new Date(n.startDate)>v)&&!(n.endDate&&new Date(n.endDate)<v))}catch(e){return(0,i.Tb)(e),!1}}),[v,n,p.asPath,k]);(0,s.useEffect)((()=>{(null===k||void 0===k?void 0:k.pathname)===p.asPath&&t()}),[t,k,p.asPath]);const w=(0,s.useCallback)((()=>{t(),(0,h.MR)((0,h.a$)({type:"marketing:view:productAnnouncementEngageClick",currentUser:o,data:{name:n.name,buttonText:n.buttonText,buttonLink:n.buttonLink},eventVersion:1}))}),[t,o,n]),C=(0,s.useCallback)((()=>{t(),(0,h.MR)((0,h.a$)({type:"marketing:view:productAnnouncementDismissClick",currentUser:o,data:{name:n.name},eventVersion:1}))}),[t,o,n]);return y?(0,r.jsx)(a.h,{children:(0,r.jsxs)("div",{className:"ba b--light-silver br2 shadow-5 relative bg-white z-2",style:{maxWidth:"315px",bottom:30,right:30,position:"fixed"},children:[(0,r.jsx)(l.hU,{colorless:!0,icon:d.Z,className:"absolute bg-white right-0 ma2",onClick:C,solidBackground:!0,"data-testid":"announcement-banner-close"}),(0,r.jsx)(m.Z,{image:x,alt:"Announcement image"}),(0,r.jsxs)("div",{className:"pa3","data-testid":"announcement-banner-div",children:[b&&(0,r.jsx)(f.Z,{className:"pb3",document:b}),k?(0,r.jsx)(c(),{href:k.toString(),className:"white bg-blue b--blue animate-all pointer primary-button-shadow hover-bg-dark-blue hover-b--dark-blue f6 fw6 br2 ba relative pa2 flex items-center justify-center no-underline",onClick:w,children:g}):(0,r.jsx)(l.KM,{className:"w-100",text:g||"Got it!",onClick:w})]})]})}):null};var v=n(40821);var b=n(40042);const x="announcement_entry_id",g=(0,b.$j)((e=>{let{currentUser:t,decorations:n}=e;return{currentUser:t,decorations:n}}),(e=>({dispatch:e})))((e=>{let{currentUser:t,dispatch:n}=e;const{0:a,1:i}=(0,s.useState)(!1),{data:o}=function(){let e,{skipFetch:t=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{data:n,error:r}=(0,v.ZP)(t?null:"/api/cms/entries?content_type=announcement&limit=1&order=-sys.createdAt",(async e=>{const t=await fetch(e);if(!t.ok)throw await t.json();return t.json()}),{revalidateOnFocus:!1});return n&&n.items.length>0&&(e=n.items[0]),{data:e,error:r}}({skipFetch:!t}),c=null===o||void 0===o?void 0:o.sys.id;(0,s.useEffect)((()=>{if(!t||!c)return;t.settings.announcement_entry_id!==c&&i(!0)}),[t,c,n]);const u=(0,s.useCallback)((()=>{i(!1),c&&n({type:"updateCurrentUserSetting",key:x,value:c})}),[n,c]);return o&&a?(0,r.jsx)(p,{announcement:o,onClose:u}):null}))},34049:function(e,t,n){"use strict";var r=n(85893),s=n(9008),a=n.n(s),i=n(64451);t.Z=e=>{let{content:t,disableSuffix:n=!1}=e;return(0,r.jsx)(a(),{children:(0,r.jsx)("title",{children:n?t:(0,i.q)(t)})})}},97058:function(e,t,n){"use strict";var r=n(41799),s=n(99534),a=n(85893),i=n(18943);t.Z=e=>{var{image:t,alt:n}=e,o=(0,s.Z)(e,["image","alt"]);if("undefined"===typeof t)return null;const{file:c,description:u}=t.fields;return(0,a.jsx)("img",(0,r.Z)({src:(0,i.GR)(c.url),alt:null!==n&&void 0!==n?n:u},o))}},97559:function(e,t,n){"use strict";var r=n(41799),s=n(85893),a=n(60357),i=n.n(a),o=n(74129),c=n(86437);t.Z=e=>{let{document:t,renderMark:n={},renderNode:a={},className:u}=e;if("undefined"===typeof t)return null;if("string"===typeof t)throw new Error("Document is not a RichText object and should be rendered directly");const l={renderMark:(0,r.Z)({},n),renderNode:(0,r.Z)({[c.BLOCKS.PARAGRAPH]:(e,t)=>(0,s.jsxs)("p",{style:{margin:0},className:"jsx-17502f83cc37dac7",children:[t,(0,s.jsx)(i(),{id:"17502f83cc37dac7",children:"p.jsx-17502f83cc37dac7:not(:last-of-type){padding-bottom:var(--spacing-medium)}"})]}),[c.BLOCKS.UL_LIST]:(e,t)=>(0,s.jsx)("ul",{className:"pl3",style:{listStyleType:"disc",margin:0},children:t}),[c.BLOCKS.LIST_ITEM]:(e,t)=>(0,s.jsxs)("li",{className:"jsx-1aac4797f0960583",children:[t,(0,s.jsx)(i(),{id:"1aac4797f0960583",children:"li.jsx-1aac4797f0960583:not(:last-of-type){padding-bottom:var(--spacing-medium)}"})]})},a)};return(0,s.jsx)("div",{className:u,children:(0,o.h)(t,l)})}},18943:function(e,t,n){"use strict";n.d(t,{GR:function(){return o},r_:function(){return c}});var r=n(41799),s=n(69396),a=(n(42474),n(10159),n(39593)),i=n.n(a);n(83454);new(i())({max:1e3,ttl:6e5});function o(e){if(!e.startsWith("/"))return e;return new URL(e,"https://observablehq.com").toString()}function c(e,t){const n=e.items.filter(t);return(0,s.Z)((0,r.Z)({},e),{items:n})}},64451:function(e,t,n){"use strict";n.d(t,{o:function(){return i},q:function(){return a}});var r=n(10198),s=n(72760);function a(e){const t=" | Observable";return e.endsWith(t)?e:"".concat(e.trim()).concat(t)}function i(e){const t=new Set(["Paragraph","ATXHeading2","ATXHeading3","ATXHeading4","ATXHeading5"]),n=new Set(["EmphasisMark","LinkMark","LinkLabel","URL","HeaderMark"]);function a(e){const t=r.E2.startParse(e);let n;for(;!(n=t.advance()););return n}function*i(e){if(!e)return;const n=a(e).cursor();for(;n.next();)t.has(n.name)&&(yield e.slice(n.from,n.to))}function o(e){let t=e;const r=a(e).cursor();for(r.lastChild();r.prev();)n.has(r.name)&&(t=t.slice(0,r.from)+t.slice(r.to));return t.trim()}let c="";for(const r of e){const{body:e,tag:t}=(0,s.Qc)(r);if(e){var u,l;const n="TemplateLiteral"===e.type&&"md"===(null===t||void 0===t?void 0:t.input)?e.quasis:"TaggedTemplateExpression"===e.type&&"md"===(null===(u=e.tag)||void 0===u?void 0:u.name)?null===(l=e.quasi)||void 0===l?void 0:l.quasis:null,r=null===n||void 0===n?void 0:n.map((e=>e.value.raw)).join(" ");for(const e of i(r))if(c+="".concat(o(e)," "),c.length>512)return c.slice(0,512).trim()}}return c.trim()||null}},51777:function(e,t,n){"use strict";n.d(t,{D:function(){return f},l:function(){return h}});var r=n(41799),s=n(85893),a=n(14416),i=n(98843),o=n(21252),c=n(54397),u=n(93452),l=n(39612),d=n(39736),m=n(65878);function f(e){let{component:t,store:n=i.f,modals:f=l.V,initialPropsToComponentProps:h=(e=>e)}=e;const p=t;return(0,m.Z)((e=>{const t=(0,u.zm)(f),i=h(e);return(0,s.jsxs)(a.zt,{store:(0,o.M)(n,e),children:[(0,s.jsx)(t,{}),(0,s.jsx)(d.F1,{}),(0,s.jsx)(c.W,{}),(0,s.jsx)(p,(0,r.Z)({},i))]})}))}function h(e){let{component:t}=e;const n=(0,u.zm)(l.V);return e=>(0,s.jsxs)(a.zt,{store:(0,o.M)(i.f,e),children:[(0,s.jsx)(n,{}),(0,s.jsx)(d.F1,{}),(0,s.jsx)(c.W,{}),(0,s.jsx)(t,(0,r.Z)({},e))]})}},24654:function(){}}]);