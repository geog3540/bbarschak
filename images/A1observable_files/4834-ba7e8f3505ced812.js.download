"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4834],{71922:function(e,n,t){var s=t(41799),r=t(69396),a=t(85893);t(67294);n.Z=e=>(0,a.jsx)("svg",(0,r.Z)((0,s.Z)({width:"16",height:"16",viewBox:"0 0 16 16",fill:"none"},e),{children:(0,a.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",fill:"currentColor",d:"M6.42383 5.48014L8.92383 8.48014L10.0762 7.51986L8.80837 5.9985L9.99667 5.99759C10.5499 5.99717 10.9984 6.44603 10.9974 6.99927L10.9933 9.44009C9.97251 9.84184 9.25 10.8365 9.25 12C9.25 13.5188 10.4812 14.75 12 14.75C13.5188 14.75 14.75 13.5188 14.75 12C14.75 10.8315 14.0212 9.83318 12.9933 9.43487L12.9974 7.00264C13.0002 5.34292 11.6549 3.99632 9.99514 3.99759L8.81087 3.9985L10.0762 2.48014L8.92383 1.51986L6.42383 4.51986L6.02372 5L6.42383 5.48014ZM7.99998 4.97156L8.00002 5.02849L7.97628 5L7.99998 4.97156ZM10.75 12C10.75 11.3096 11.3096 10.75 12 10.75C12.6904 10.75 13.25 11.3096 13.25 12C13.25 12.6904 12.6904 13.25 12 13.25C11.3096 13.25 10.75 12.6904 10.75 12ZM4 10.75C3.30964 10.75 2.75 11.3096 2.75 12C2.75 12.6904 3.30964 13.25 4 13.25C4.69036 13.25 5.25 12.6904 5.25 12C5.25 11.3096 4.69036 10.75 4 10.75ZM3 9.43747L3 3C3 2.44771 3.44772 2 4 2C4.55228 2 5 2.44771 5 3L5 9.43747C6.02434 9.8375 6.75 10.834 6.75 12C6.75 13.5188 5.51878 14.75 4 14.75C2.48122 14.75 1.25 13.5188 1.25 12C1.25 10.834 1.97566 9.8375 3 9.43747Z"})}))},88184:function(e,n,t){t.d(n,{b:function(){return Fn},R:function(){return Dn}});var s=t(41799),r=t(69396),a=t(93452),o=t(78111),i=t(85893),l=t(56424),c=t(41664),d=t.n(c),m=t(67294),u=t(37497),h=t(94184),p=t.n(h),f=t(40821),b=t(20958),x=t(27565),v=t(11233),g=t(33090),j=t(74878),y=t(19868),w=t(22027),k=t(2845),N=t(60138),C=t(22513),S=t(602),Z=t(44754),D=t(19671),F=t(18582),_=t(47743),I=t(11342),M=t(4598),R=t(4242);const L=e=>{let{title:n,className:t=""}=e;return(0,i.jsx)("div",{className:p()(t,"f6 fw4 mid-gray mt3 mb2"),children:n})},q=()=>(0,i.jsxs)("div",{className:"mv2 flex items-center mid-gray",children:[(0,i.jsx)(w.Z,{className:"blue mr2"}),"Loading\u2026"]}),U=()=>(0,i.jsx)("div",{className:"mv2 mid-gray fw4 f7",children:"\xa0\xa0No files found"}),A=e=>{let{type:n="files"}=e;return(0,i.jsxs)("div",{className:"mv2 flex items-center mid-gray",children:[(0,i.jsx)(C.Z,{className:"red mr2"}),"We encountered an error fetching your ",n,"."]})},E=e=>{let{id:n,name:t,file:s,folder:r,driveId:a,breadcrumb:o,parentReference:l,onFolderSelect:c}=e;const d=(null===s||void 0===s?void 0:s.mimeType)||(0,I.Le)(t);return s?(0,i.jsxs)("div",{className:"flex items-center fw6 near-black",children:["application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"===d?(0,i.jsx)(k.i6,{className:"mr2"}):"application/vnd.openxmlformats-officedocument.presentationml.presentation"===d?(0,i.jsx)(k.Ob,{className:"mr2"}):"application/vnd.openxmlformats-officedocument.wordprocessingml.document"===d?(0,i.jsx)(k.Bl,{className:"mr2"}):"application/msonenote"===d?(0,i.jsx)(k.hG,{className:"mr2"}):(0,i.jsx)(k.$B,{className:"mr2 mid-gray"}),(null===o||void 0===o?void 0:o.id)!==(null===l||void 0===l?void 0:l.id)&&(null===l||void 0===l?void 0:l.name)&&(0,i.jsxs)(i.Fragment,{children:[l.name,"\xa0/\xa0"]}),t||"File"]}):r?(0,i.jsxs)("button",{className:"flex justify-between items-center w-100 b--transparent bg-transparent pointer hover-bg-near-white",onClick:()=>c({id:n,driveId:a,name:t||"Folder"}),children:[(0,i.jsxs)("div",{className:"flex items-center fw6 near-black",children:[(0,i.jsx)(k.gt,{className:"mr2"}),t]}),(0,i.jsx)(j.Z,{})]}):null},T=e=>{let{accessToken:n,includeGroups:t,onSelect:s}=e;const{data:r,error:a}=(0,f.ZP)(n?["/microsoft/drives",n,t]:null,I.Z8,{revalidateOnFocus:!1});return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(L,{title:"Drives"}),a?(0,i.jsx)(A,{type:"drives"}):r?r.map((e=>{var n,t;const r=(null===(n=e.owner)||void 0===n?void 0:n.user)?"Personal":"Team";return e.id?(0,i.jsxs)("button",{className:"pv2 fw6 near-black flex items-center justify-between w-100 b--transparent bg-transparent pointer hover-bg-near-white",onClick:()=>s({id:e.id,name:e.name||r}),children:[(0,i.jsxs)("div",{className:"flex items-center",children:[(null===(t=e.owner)||void 0===t?void 0:t.user)?(0,i.jsx)(k.t3,{className:"mr2"}):(0,i.jsx)(k.pd,{className:"mr2"}),(0,i.jsx)("span",{className:"mr1",children:e.name||"My files"}),(0,i.jsx)("span",{className:"gray",children:"\u2022"}),(0,i.jsx)("span",{className:"ml1 f45 gray",children:r})]}),(0,i.jsx)(j.Z,{})]},e.id):null})):(0,i.jsx)(q,{})]})},z=e=>{let{path:n,title:t,breadcrumbs:a,driveId:o,accessToken:l,onFolderSelect:c,onFileSelect:d,onLoadMore:h}=e;const{data:p,error:f,isValidating:x,size:v,setSize:j}=(0,b.ZP)((0,I.mL)(n,l),(e=>(0,F.r)(e,l)),{revalidateOnFocus:!1}),y=p&&1===p.length&&!p[0].value.length,w=a.length?a[a.length-1]:null;return(0,i.jsxs)(i.Fragment,{children:[a.length?(0,i.jsxs)("div",{className:"f7 gray mv2",children:[(0,i.jsx)("span",{children:"All drives"}),a.map((e=>(0,i.jsxs)(m.Fragment,{children:[(0,i.jsx)("span",{className:"mh1",children:"/"}),(0,i.jsx)("span",{children:e.name})]},e.id)))]}):null,o?null:(0,i.jsx)(L,{title:t}),f?(0,i.jsx)(A,{}):p?y?(0,i.jsx)(U,{}):(0,i.jsxs)(i.Fragment,{children:[p.map((e=>e.value.map((e=>{var n,t,a;const{id:l,file:u,folder:h}=e.remoteItem||e,p=o||(null===(n=e.remoteItem)||void 0===n||null===(t=n.parentReference)||void 0===t?void 0:t.driveId)||(null===(a=e.parentReference)||void 0===a?void 0:a.driveId);return u&&l&&p?(0,i.jsx)(g.E,{className:"pl2 mv3",name:"selected_file",onClick:()=>d({path:"/drives/".concat(p,"/items/").concat(l),name:e.name,mimeType:u.mimeType||(0,I.Le)(e.name),size:e.size}),label:(0,i.jsx)(E,(0,r.Z)((0,s.Z)({},e),{file:u,id:l,driveId:o,onFolderSelect:c,breadcrumb:w}))},"/".concat(p,"/").concat(l)):h&&l&&p?(0,i.jsx)("div",{className:"mv3",children:(0,m.createElement)(E,(0,r.Z)((0,s.Z)({},e),{key:"/".concat(p,"/").concat(l),folder:h,id:l,driveId:o,onFolderSelect:c,breadcrumb:w}))}):null})))),a.length&&p.length&&p[p.length-1]["@odata.nextLink"]?(0,i.jsx)(u.aX,{onClick:()=>{j(v+1),h()},text:"Load more",loading:v>1&&x,colorless:!0}):null]}):(0,i.jsx)(q,{})]})};function K(e){const n=e[e.length-1];return n.driveId?"/drives/".concat(n.driveId,"/items/").concat(n.id,"/children?$top=5"):"/drives/".concat(n.id,"/root/children?$top=5")}const O=(0,R.$j)((e=>{let{notebook:n,currentUser:t}=e;return{notebook:n,currentUser:t}}),(e=>({dispatch:e})))((e=>{let{dispatch:n,onDismiss:t,notebook:r,currentUser:o}=e;const{data:c}=(0,S.h_)("/user/token?provider=microsoftData"),{0:d,1:h}=(0,m.useState)(null),{0:p,1:f}=(0,m.useState)([]);function b(e){h(null),f([...p,e]),(0,D.MR)((0,D.ym)({type:"notebook:view:cloudFileFolder",notebook:r,currentUser:o,data:{provider:"microsoftData"},eventVersion:1}))}function x(){(0,D.MR)((0,D.ym)({type:"notebook:view:cloudFileLoadMore",notebook:r,currentUser:o,data:{provider:"microsoftData"},eventVersion:1}))}const[g,j,y]=(0,Z.G)(""),w=y.trim().replace(/[{}']/g,""),C=(0,m.useRef)(!1);return(0,m.useEffect)((()=>{y&&!C.current&&(C.current=!0,(0,D.MR)((0,D.ym)({type:"notebook:view:cloudFileSearch",data:{provider:"microsoftData"},notebook:r,currentUser:o,eventVersion:1})))}),[r,o,y]),(0,i.jsxs)(l.Vq,{onDismiss:t,"aria-labelledby":"modal-title",children:[(0,i.jsx)(a.xB,{title:"Connect Microsoft file",icon:k.ZP,onDismiss:t}),(0,i.jsxs)(a.fe,{maxHeight:475,children:[!p.length&&(0,i.jsxs)("div",{className:"relative",children:[(0,i.jsx)(N.Z,{className:"absolute gray mh1 mt2"}),(0,i.jsx)(v.Z,{autoComplete:"false",spellCheck:!1,onChange:e=>j(e.target.value),className:"ph4 pv2 border-box w-100",type:"search",placeholder:"Search",value:g,maxLength:128,size:0})]}),!p.length&&y?(0,i.jsx)(z,{title:"Search Results",accessToken:null===c||void 0===c?void 0:c.access_token,path:"/me/drive/search(q='{".concat(encodeURIComponent(w),"}')"),breadcrumbs:p,onFileSelect:h,onFolderSelect:b,onLoadMore:x}):p.length?(0,i.jsx)(z,{path:K(p),title:p[p.length-1].name,breadcrumbs:p,onFolderSelect:b,accessToken:null===c||void 0===c?void 0:c.access_token,onFileSelect:h,onLoadMore:x,driveId:p[p.length-1].driveId||p[p.length-1].id}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(T,{onSelect:b,accessToken:null===c||void 0===c?void 0:c.access_token,includeGroups:!!(null===c||void 0===c?void 0:c.provider_org)}),(0,i.jsx)(z,{path:"/me/drive/recent?$top=5",title:"Recently edited",breadcrumbs:p,onFolderSelect:b,onFileSelect:h,onLoadMore:x,accessToken:null===c||void 0===c?void 0:c.access_token}),(0,i.jsx)(z,{path:"/me/drive/sharedWithMe?$top=5",title:"Shared with me",breadcrumbs:p,onFolderSelect:b,onFileSelect:h,onLoadMore:x,accessToken:null===c||void 0===c?void 0:c.access_token})]})]}),(0,i.jsx)(a.mz,{children:(0,i.jsxs)("div",{className:"flex items-center justify-between",children:[(0,i.jsx)(u.aX,{text:"Back",onClick:function(){p.length?(h(null),f(p.slice(0,p.length-1))):n({type:"showModal",modal:"addCloudFile"})}}),(0,i.jsxs)(u.CQ,{children:[(0,i.jsx)(u.kq,{text:"Cancel",onClick:t}),(0,i.jsx)(u.KM,{text:"Connect",disabled:!d,onClick:()=>{t(),n((0,s.Z)({type:"insertCloudFile",provider:"microsoftData"},d))}})]})]})})]})}));let V=!1,P=!1;const B=(0,R.$j)(null,(e=>({dispatch:e})))((e=>{let{dispatch:n,onDismiss:t}=e;const{data:s}=(0,S.h_)("/user/token?provider=googleData"),r=s&&M.c.googleData.scopes.every((e=>s.scopes.includes(e))),{0:o,1:c}=(0,m.useState)(P);P||V||(V=!0,(0,_.__)().then((e=>e.load("picker",{callback:()=>(P=!0,c(P))}))));const d=(0,m.useCallback)((e=>{switch(e.action){case google.picker.Action.PICKED:{const s=e.docs[0].id;t(),n({type:"insertCloudFile",provider:"googleData",path:"/drive/v3/files/".concat(s),name:e.docs[0].name,mimeType:(0,_.SW)(e.docs[0].mimeType)||"text/plain"});break}case google.picker.Action.CANCEL:t()}}),[t,n]);return(0,m.useEffect)((()=>{if(!o||!s||!r)return;const e=(new google.picker.PickerBuilder).addView((new google.picker.DocsView).setOwnedByMe(!0)).addView(new google.picker.DocsView(google.picker.ViewId.SPREADSHEETS)).addView((new google.picker.DocsView).setIncludeFolders(!0)).enableFeature(google.picker.Feature.SUPPORT_DRIVES).setAppId(_.eJ).setCallback(d).setDeveloperKey(_.N6).setOAuthToken(s.access_token).build();return e.setVisible(!0),()=>e.dispose()}),[o,r,s,d]),s&&!r?(0,i.jsxs)(l.Vq,{onDismiss:t,"aria-labelledby":"modal-title",children:[(0,i.jsx)(a.xB,{title:"Grant additional access",icon:y.Z,onDismiss:t}),(0,i.jsxs)(a.fe,{children:["Observable still needs the following permission to access your files. Please grant access on the next page.",(0,i.jsx)("div",{className:"flex justify-center mv3",children:(0,i.jsxs)("div",{className:"ba b--light-gray bg-near-white br2 pa1 flex items-center",children:[(0,i.jsx)(y.v,{className:"mr2"}),"See and download all your Google Drive files"]})})]}),(0,i.jsx)(a.mz,{children:(0,i.jsx)(x.E,{provider:"googleData",alreadyAuthenticated:!!s.access_token,redirectToPicker:!0,children:(0,i.jsxs)(u.CQ,{children:[(0,i.jsx)(u.kq,{text:"Cancel",onClick:t}),(0,i.jsx)(u.KM,{text:"Continue",type:"submit"})]})})})]}):null}));var $=t(28041);const W=e=>{let{dispatch:n,provider:t,token:s,onAuth:r,info:{name:a,icon:o}}=e;return(0,i.jsx)(x.E,{provider:t,alreadyAuthenticated:!!s,onAuth:r,redirectToPicker:!0,children:(0,i.jsxs)("div",{className:"flex justify-between items-center mv2",children:[(0,i.jsxs)("div",{className:"near-black flex items-center",children:[(0,i.jsx)(o,{className:"mr2 w2 h2"}),(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{className:"fw6",children:a}),s?(0,i.jsxs)("div",{className:"f7",children:[(0,i.jsx)("span",{className:"mid-gray mr1",children:s.provider_username}),(0,i.jsx)("button",{className:"blue pointer underline-hover bg-transparent pa0 bn",type:"submit",children:"Switch account"})]}):null]})]}),s?(0,i.jsx)(u.aX,{text:"Continue",type:"button",colorless:!0,onClick:()=>n({type:"showModal",modal:"cloudFile",modalProps:{provider:t}})}):(0,i.jsx)(u.aX,{text:"Connect",colorless:!0,type:"submit"})]})})},X=(0,R.$j)((e=>{let{currentUser:n,notebook:t}=e;return{currentUser:n,notebook:t}}),(e=>({dispatch:e})))((e=>{let{onDismiss:n,dispatch:t,notebook:s,currentUser:r}=e;const{data:o}=(0,S.h_)("/user/tokens");function c(e){(0,D.MR)((0,D.ym)({type:"notebook:manage:cloudFileAuth",notebook:s,currentUser:r,data:{provider:e,alreadyAuthenticated:!1},eventVersion:1}))}return(0,i.jsxs)(l.Vq,{onDismiss:n,"aria-labelledby":"modal-title",children:[(0,i.jsx)(a.xB,{icon:$.Z,title:"Add cloud file",onDismiss:n}),(0,i.jsxs)(a.fe,{children:[(0,i.jsx)(L,{title:"Available integrations"}),Object.entries(M.c).map((e=>{let[n,s]=e;return(0,i.jsx)(W,{dispatch:t,token:o?o.find((e=>e.provider===n)):void 0,provider:n,info:s,onAuth:c},n)})),(0,i.jsxs)("div",{className:"mt4",children:["You can manage the apps you\u2018ve granted permission to in your"," ",(0,i.jsx)(d(),{href:"/settings/oauth-tokens",className:"blue",children:"settings"}),"."]})]}),(0,i.jsx)(a.mz,{children:(0,i.jsx)(u.CQ,{children:(0,i.jsx)(u.aX,{text:"Cancel",onClick:n})})})]})}));var Y=t(3764),G=t(84193),Q=t(27193),H=t(3142),J=t(47692),ee=t(36448);const ne=(0,R.$j)((e=>{let{notebook:n}=e;return{notebook:n}}),(e=>({dispatch:e})))((e=>{let{notebook:n,dispatch:t,onDismiss:s}=e;const{owner:r,model:{nodes:o}}=n,{data:c=[]}=(0,S.h_)("".concat((0,H.p0)(n)?"/team/".concat(r.id):"/user","/data-connectors?detail=false")),{databaseClients:d}=(0,J.Z)(o),h=c.filter((e=>!d.has(e.name))),{0:p,1:f}=(0,m.useState)(h.length?h[0].name:"");return(0,i.jsxs)(l.Vq,{onDismiss:s,"aria-labelledby":"modal-title",children:[(0,i.jsx)(a.xB,{title:"Add database connection",icon:Y.Z,onDismiss:s}),(0,i.jsxs)(a.fe,{children:[(0,i.jsxs)("div",{className:"mv3",children:["Select from"," ",(0,H.p0)(n)?"".concat((0,Q.KY)(r),"\u2019s"):"your"," ","databases below or"," ",(0,i.jsx)(G.Z,{href:"".concat((0,ee.rF)(r),"/databases?new"),children:(0,i.jsx)("a",{className:"blue",children:"configure a new database"})}),"."]}),c.length?c.map((e=>(0,i.jsx)(g.E,{name:"database",label:e.name,icon:Y.t,className:"f6 fw6 near-black mb2 items-center",description:(0,i.jsxs)(i.Fragment,{children:[d.has(e.name)?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("span",{className:"blue fw6",children:"In use"}),(0,i.jsx)("span",{className:"light-gray",children:" \u2022 "})]}):"",(0,Q.Zb)(e.type)]}),onChange:()=>f(e.name),checked:p===e.name,disabled:d.has(e.name)},e.name))):(0,i.jsxs)("div",{className:"mid-gray",children:[(0,H.p0)(n)?"".concat((0,Q.KY)(r)," doesn\u2019t"):"You don\u2019t"," ","have any database connections yet."]})]}),(0,i.jsx)(a.mz,{children:(0,i.jsxs)(u.CQ,{children:[(0,i.jsx)(u.kq,{onClick:s,text:"Cancel"}),(0,i.jsx)(u.KM,{onClick:function(){s();const e=c.find((e=>e.name===p));e&&requestAnimationFrame((()=>{t({type:"insertDatabase",source:{name:"".concat(e.name),type:"DatabaseClient"}})}))},text:"Confirm"})]})})]})}));var te=t(99534),se=t(75713),re=t(20042),ae=t(8385),oe=t(79209),ie=t(71675),le=t(75872),ce=t(1099),de=t(81685),me=t(8433),ue=t(42568);function he(e){const{approved:n,description:t}=e;return(0,te.Z)(e,["approved","description"])}const pe=e=>{let{notebook:n,dispatch:t,onDismiss:o,teamMemberIds:c,teamId:d}=e;const{authors:h,owner:f}=n,{0:b}=(0,m.useState)(h),{0:x,1:g}=(0,m.useState)(h),{0:j,1:y}=(0,m.useState)(null),w=b===x;function k(e,n){const t=x.findIndex((n=>n.id===e.id));if(t>-1&&t+n>=0&&t+n<x.length){const e=x.slice(0);e.splice(t,1),e.splice(t+n,0,x[t]),g(e)}}return(0,i.jsx)(l.Vq,{onDismiss:o,"aria-labelledby":"modal-title",children:(0,i.jsxs)(se.l,{className:"f6 lh-copy",onSubmit:e=>{o(),t({type:"setAuthors",authors:x}),e.preventDefault()},children:[(0,i.jsx)(a.xB,{title:"Authors",icon:de.Z,onDismiss:o}),(0,i.jsxs)(a.fe,{children:[(0,i.jsxs)("div",{children:["team"===f.type&&(0,i.jsxs)("div",{className:"flex items-center justify-between pb3 mb2 bb b--light-gray",children:[(0,i.jsxs)("div",{className:"flex items-center",children:[(0,i.jsx)(ae.q,{user:f,size:28,className:"br-100 mr2"}),(0,i.jsx)("span",{className:"fw6 mr2",children:(0,Q.KY)(f)}),(0,i.jsxs)("span",{className:"mid-gray",children:["@",f.login]})]}),(0,i.jsx)("span",{className:"fw5 mid-gray",children:"Team Owner"})]}),0===x.length&&(0,i.jsx)("div",{className:"mid-gray mb3",children:"No individual authors."}),x.map(((e,n)=>(0,i.jsxs)("div",{className:p()("flex items-start",n?"pt2 bt b--light-gray":""),children:[(0,i.jsxs)("div",{className:"flex pr2",children:[(0,i.jsx)(u.hU,{colorless:!0,icon:le.Z,disabled:!n,onClick:()=>k(e,-1)}),(0,i.jsx)(u.hU,{colorless:!0,icon:ie.Z,disabled:n===x.length-1,onClick:()=>k(e,1)})]}),(0,i.jsxs)("div",{className:"flex-auto",children:[(0,i.jsxs)("div",{className:"flex items-center justify-between pb2",children:[(0,i.jsxs)("div",{className:"flex items-center",children:[(0,i.jsx)(ae.q,{user:e,size:28,className:"br-100 mr2"}),(0,i.jsx)("span",{className:"fw6 mr2",children:(0,Q.KY)(e)}),(0,i.jsxs)("span",{className:"mid-gray",children:["@",e.login]})]}),e.id===f.id?(0,i.jsx)("span",{className:"fw5 mid-gray",children:"Owner"}):(0,i.jsxs)("div",{className:"flex items-center",children:[!e.approved&&(0,i.jsxs)("span",{className:"yellow fw5 flex items-center mr2 tooltipped tooltipped-n","aria-label":"".concat((null===c||void 0===c?void 0:c.size)?"Because they are outside your team, ":"").concat((0,Q.KY)(e)," ").concat(h.some((n=>n.id===e.id))?"has been":"will be"," invited to be an author by email"),children:[(0,i.jsx)(oe.Z,{className:"mr1"})," ",h.some((n=>n.id===e.id))?"Invited":"Invite"]}),(0,i.jsxs)(ue.v2,{children:[(0,i.jsx)(u.hU,{colorless:!0,asMenuButton:!0,icon:ce.v}),(0,i.jsx)(ue.qy,{children:(0,i.jsxs)(ue.sN,{onSelect:()=>function(e){const n=x.findIndex((n=>n.id===e.id));n>-1&&g([...x.slice(0,n),...x.slice(n+1)])}(e),children:[(0,i.jsx)(me.Z,{className:"mr1"})," Remove author"]})})]})]})]}),x.length>1&&(0,i.jsx)("div",{className:"pb3",children:(0,i.jsx)(v.Z,{placeholder:"Author role (optional)",value:e.description,maxLength:255,onChange:n=>function(e,n){const t=x.findIndex((n=>n.id===e.id));t>-1&&g([...x.slice(0,t),(0,r.Z)((0,s.Z)({},x[t]),{description:n}),...x.slice(t+1)])}(e,n.target.value),className:"w-100"})})]})]},e.id)))]}),(0,i.jsxs)("div",{className:p()("flex items-center pt3",x.length?"bt b--light-gray":""),children:[(0,i.jsx)(re.o,{value:j,type:"individual",className:"w-100 mr3",excluded:x.map(he),placeholder:"Author @username",onSelectUser:e=>y(e),teamId:d}),(0,i.jsx)(u.aX,{text:"Add",onClick:function(){if(null!==j&&!("invited"in j)){-1===x.findIndex((e=>e.id===j.id))&&g([...x,(e=j,n=(null===c||void 0===c?void 0:c.has(j.id))||!1,(0,r.Z)((0,s.Z)({},e),{approved:n,description:""}))]),y(null)}var e,n},disabled:!j})]})]}),(0,i.jsx)(a.mz,{children:(0,i.jsx)("div",{className:"flex justify-end",children:(0,i.jsxs)(u.CQ,{children:[(0,i.jsx)(u.kq,{text:"Cancel",onClick:o}),(0,i.jsx)(u.KM,{type:"submit",text:"Confirm",disabled:w})]})})})]})})},fe=(0,R.$j)((e=>{let{notebook:n,currentUser:t}=e;return{notebook:n,currentUser:t}}),(e=>({dispatch:e})))((e=>{const{notebook:n}=e,t="team"===n.owner.type,{data:a}=(0,S.h_)(t?"/team/".concat(n.owner.id,"/members"):null),o=(0,m.useMemo)((()=>new Set(null===a||void 0===a?void 0:a.map((e=>{let{id:n}=e;return n})))),[a]);return!t||a?(0,i.jsx)(pe,(0,r.Z)((0,s.Z)({},e),{teamMemberIds:o,teamId:t?n.owner.id:void 0})):null})),be=(0,R.$j)(null,(e=>({dispatch:e})))((e=>{let{dispatch:n,onDismiss:t,trigger:s,source:r}=e;return(0,i.jsx)(a.On,{title:"Close suggestion",icon:me.Z,description:"Are you sure you want to close this suggestion?",onCancel:t,onConfirm:()=>{t(),n({type:"closeSuggestion",trigger:s,source:r})},destructive:!0})})),xe=(0,R.$j)(null,(e=>({dispatch:e})))((e=>{let{comment:n,dispatch:t,onDismiss:s}=e;return(0,i.jsx)(a.On,{title:"Delete comment",icon:me.Z,description:"Are you sure you want to delete this comment? This action cannot be undone.",onCancel:s,onConfirm:()=>{s(),t({type:"commentDeleted",comment:n,trigger:"click",source:"commentIcon"})},destructive:!0})})),ve=(0,R.$j)(null,(e=>({dispatch:e})))((e=>{let{name:n,dispatch:t,onDismiss:s}=e;return(0,i.jsx)(a.On,{title:"Delete file",icon:me.Z,description:(0,i.jsxs)(i.Fragment,{children:["Are you sure you want to delete ",(0,i.jsxs)("b",{children:["\u201c",n,"\u201d"]}),"? Versions of this notebook which reference this file will no longer work."]}),onCancel:s,onConfirm:()=>{s(),t({type:"fileMarkedForDeletion",name:n})},destructive:!0})}));var ge=t(20637),je=t(23869),ye=t(64804);function we(e){return e?e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;"):""}function ke(e,n){return n?n>0?ke("  ".concat(e),n-1):ke(e.replace(/^ {2}/,""),n+1):e}function Ne(e,n){return e.split("\n").map((e=>ke(e,n))).join("\n")}function Ce(e){let{entire:n,names:t,notebookUrl:s,preview:r,uiOrigin:a,disableBanner:o,documentKey:i}=e;const l=new URLSearchParams,c=r?"/embedpreview":"/embed";n?l.append("cell","*"):t&&0!==t.length?l.append("cells",t.join(",")):l.append("cell","no-cells"),i&&l.append("api_key",i),o&&l.append("banner","false");const d=s.startsWith("/d")?s.slice(2):s;return"".concat(a).concat(c).concat(d,"?").concat(l)}function Se(e){let{entire:n,names:t,notebookUrl:s,height:r,uiOrigin:a,preview:o,disableBanner:i,documentKey:l}=e;const c=Ce({uiOrigin:a,preview:o,entire:n,names:t,notebookUrl:s,disableBanner:i,documentKey:l});return'<iframe width="100%" height="'.concat(r,'" frameborder="0"\n  src="').concat(c,'"></iframe>')}const Ze=e=>{let{title:n,owner:t,notebookUrl:s,uiOrigin:r}=e;return'<p>Credit: <a href="'.concat(r+s,'">').concat(we(n)," by ").concat(we("".concat(t)),"</a></p>")};function De(e){let n,t,{entire:s,names:r,notebookUrl:a,moduleUrl:o,title:i,owner:l,uiOrigin:c,runSelection:d,randomId:m,disableBanner:u,documentKey:h,includeStylesheet:p=!0}=e;return s?(n='<div id="observablehq-'.concat(m,'"></div>'),t='new Runtime().module(define, Inspector.into("#observablehq-'.concat(m,'"));')):(n=r.map((e=>'<div id="'.concat(Ie(e,m),'"></div>'))).join("\n"),t="new Runtime().module(define, name => {\n".concat(r.map((e=>'  if (name === "'.concat(e,'") return new Inspector(document.querySelector("#').concat(Ie(e,m),'"));\n'))).join("")).concat(d.length?"  return ".concat(JSON.stringify(d),".includes(name);\n"):"","});")),"".concat(n,"\n").concat(u?"":Ze({title:i,owner:l,notebookUrl:a,uiOrigin:c}),"\n\n").concat(p?'<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@observablehq/inspector@5/dist/inspector.css">\n':"",'<script type="module">\nimport {Runtime, Inspector} from "https://cdn.jsdelivr.net/npm/@observablehq/runtime@5/dist/runtime.js";\nimport define from "').concat(o).concat(h?"&api_key=".concat(h):"",'";\n').concat(t,"\n<\/script>")}function Fe(e){let{packageUrl:n,documentKey:t}=e;return'yarn add @observablehq/runtime@5\nyarn add "'.concat(n).concat(t?"&api_key=".concat(t):"",'"')}function _e(e){let{entire:n,slug:t,names:s,notebookPath:r,notebookUrl:a,runSelection:o,title:i,owner:l,uiOrigin:c}=e;const d=function(e){return e?e.replaceAll(/[^-a-zA-Z]/g,"").split("-").map((e=>e.charAt(0).toUpperCase()+e.slice(1))).join(""):"Notebook"}(t),m=function(e){const n=new Map([["useRef",""]]);for(const t of e){const e="".concat(Me(t),"Ref");let s=e,r=1;for(;n.has(s);)s="".concat(e,"$").concat(r++);n.set(s,t)}return Array.from(n).filter((e=>{let[,n]=e;return""!==n}))}(s),u=r.startsWith("/d")?r.slice(3):r.slice(1);let h,p,f;return n?(h="const ref = useRef();",p="runtime.module(notebook, Inspector.into(ref.current));",f="<div ref={ref} />"):(h=m.map((e=>{let[n]=e;return"const ".concat(n," = useRef();")})).join("\n"),p="runtime.module(notebook, name => {\n".concat(m.map((e=>{let[n,t]=e;return'  if (name === "'.concat(t,'") return new Inspector(').concat(n,".current);")})).join("\n"),"\n").concat(o.length?"  return ".concat(JSON.stringify(o),".includes(name);\n"):"","});"),f=m.map((e=>{let[n]=e;return"<div ref={".concat(n,"} />")})).join("\n")),'import React, {useRef, useEffect} from "react";\nimport {Runtime, Inspector} from "@observablehq/runtime";\nimport notebook from "'.concat(u,'";\n\nfunction ').concat(d,"() {\n").concat(Ne(h,1),"\n\n  useEffect(() => {\n    const runtime = new Runtime();\n").concat(Ne(p,2),"\n    return () => runtime.dispose();\n  }, []);\n\n  return (\n    <>\n").concat(Ne(f,3),"\n").concat(Ne(Ze({title:i,owner:l,notebookUrl:a,uiOrigin:c}),3),"\n    </>\n  );\n}\n\nexport default ").concat(d,";")}function Ie(e,n){return"observablehq-".concat(e.replace(/ /g,"-"),"-").concat(n)}function Me(e){return e.replace(/(?:^\w|[A-Z]|\b\w)/g,(function(e,n){return 0===n?e.toLowerCase():e.toUpperCase()})).replace(/\s+/g,"")}var Re=t(4778),Le=t(88725);const qe="https://anonymous.static.observableusercontent.com";const Ue="".concat(qe,"/next/").concat(Re.Bl),Ae=e=>{const{text:n,onCopy:t,url:s,language:r}=e,a=(0,m.useRef)(null),{0:o,1:l}=(0,m.useState)(!1),{0:c,1:d}=(0,m.useState)(!1),{0:h,1:f}=(0,m.useState)(!1);(0,m.useEffect)((()=>{if(!h)return;const e=setTimeout((()=>{f(!1)}),250);return()=>clearTimeout(e)}),[h,n]);const b=ge.Z.highlight(n,{language:r});return(0,i.jsxs)("div",{ref:a,children:[(0,i.jsx)("pre",{className:p()("hljs pa2 f7 form-default-clear form-custom-input",h?"bg-silver":"bg-near-white"),style:{resize:"none",overflowY:"hidden"},children:(0,i.jsx)("code",{dangerouslySetInnerHTML:{__html:b.value}})}),e.hasDocumentKey&&(0,i.jsxs)("p",{className:"mt2 f7 dark-gray lh-copy",children:["This ","jsx"===r?"URL":"embed code"," includes a"," ",(0,i.jsx)("b",{children:"notebook key"})," that will only work for this notebook."]}),(0,i.jsxs)(u.CQ,{className:"mt3",children:[s&&(0,i.jsx)(u.kq,{text:"Copy URL only",icon:c?je.Z:ye.Z,onClick:async()=>{await navigator.clipboard.writeText(s),d(!0),f(!0),t&&t()}}),(0,i.jsx)(u.KM,{text:"Copy",icon:o?je.Z:ye.Z,onClick:async()=>{await navigator.clipboard.writeText(n),l(!0),f(!0),t&&t()}})]})]})},Ee=e=>{var{onCopy:n}=e,t=(0,te.Z)(e,["onCopy"]);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{className:"mt2 mb1 f7 dark-gray lh-copy",children:"This HTML tag works almost anywhere and preserves the styles of your original notebook."}),(0,i.jsx)(Ae,{language:"html",text:Se(t),url:Ce(t),onCopy:()=>n("Iframe"),hasDocumentKey:!!t.documentKey})]})},Te=e=>{var{onCopy:n}=e,t=(0,te.Z)(e,["onCopy"]);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:"mt2 mb1 f7 dark-gray lh-copy",children:["This code uses the"," ",(0,i.jsx)("a",{className:"no-underline blue hover-dark-blue link",href:"/@observablehq/downloading-and-embedding-notebooks",target:"_blank",rel:"noopener noreferrer",children:"Runtime API"})," ","in plain JavaScript to make cells a native part of your website, where they can be rearranged and will inherit the surrounding styles."]}),(0,i.jsx)(Ae,{text:De(t),onCopy:()=>n("JavaScript"),language:"html",hasDocumentKey:!!t.documentKey})]})},ze=e=>{var{onCopy:n,hasFiles:t,packageUrl:s,documentKey:r}=e,a=(0,te.Z)(e,["onCopy","hasFiles","packageUrl","documentKey"]);return(0,i.jsxs)("div",{className:"mt2 mb1 f7 dark-gray lh-copy",children:["This code uses the"," ",(0,i.jsx)("a",{className:"no-underline blue hover-dark-blue link",href:"/@observablehq/downloading-and-embedding-notebooks",target:"_blank",rel:"noopener noreferrer",children:"Runtime API"})," ","to generate a React component. From the terminal, run:",(0,i.jsx)(Ae,{text:Fe({packageUrl:s,documentKey:r}),language:"jsx",hasDocumentKey:!!r}),(0,i.jsx)("div",{className:"mt2",children:"Then copy and paste the following component into your application:"}),(0,i.jsx)(Ae,{text:_e(a),onCopy:()=>n("React"),language:"jsx",hasDocumentKey:!!r}),t&&(0,i.jsxs)("div",{className:"mt2",children:["This notebook uses file attachments, which may require a workaround to work with a bundler like Babel; see"," ",(0,i.jsx)("a",{className:"no-underline blue hover-dark-blue link",href:"/@observablehq/troubleshooting-embedding",target:"_blank",rel:"noopener noreferrer",children:"Troubleshooting"}),"."]})]})},Ke=e=>{var{width:n,height:t}=e,s=(0,te.Z)(e,["width","height"]);return(0,i.jsx)("iframe",{title:"Embed preview",src:Ce(s),frameBorder:"0",className:"db bg-white shadow-4",style:{width:n,height:t}})},Oe=e=>{var{width:n,height:t}=e;t=t+34+16;const s=De((0,te.Z)(e,["width","height"]));return(0,i.jsx)("iframe",{title:"Embed preview",src:Ue,onLoad:e=>{e.target.contentWindow.postMessage(s,qe)},sandbox:Le.Ar,allow:Le.sq,frameBorder:"0",className:"db bg-white shadow-4",style:{width:n,height:t}},s)},Ve=[{id:"iframe",name:"Iframe",content:e=>({instructions:(0,i.jsx)(Ee,(0,s.Z)({},e)),preview:(0,i.jsx)(Ke,(0,s.Z)({},e))})},{id:"javascript",name:"Runtime with JavaScript",content:e=>({instructions:(0,i.jsx)(Te,(0,s.Z)({},e)),preview:(0,i.jsx)(Oe,(0,s.Z)({},e))})},{id:"react",name:"Runtime with React",content:e=>({instructions:(0,i.jsx)(ze,(0,s.Z)({},e)),preview:(0,i.jsx)(Oe,(0,r.Z)((0,s.Z)({},e),{includeStylesheet:!1}))})}];var Pe=t(72815),Be=t(16691),$e=t(58171),We=t(96386),Xe=t(72760),Ye=t(45219),Ge=t(40042);const Qe=[30,60,90,365,void 0];function He(e,n){const{autosave:t,isPausedLoad:s,saveVersion:r}=e;return"".concat("https://api.observablehq.com").concat((0,Le.UW)(e)).concat((0,H.z4)(e)&&t?"@latest":s?"@paused":(0,H.vS)(e)&&!(0,H.z4)(e)?"":"@".concat(r),".").concat(n)}function Je(e){const{heights:n,model:{nodes:t,events:s},saveVersion:r,publishVersion:a}=e,o=function(e,n,t){const s=new Map(e.map((e=>[e.id,!1])));for(const r of n.slice(t+1))r&&"modify_node"===r.type&&s.set(r.node_id,!0);return s}(t,s,r),i=t.map((t=>{const s=n.get(t.id);return{node:t,name:(0,Xe.nR)(t)||"",height:((null===s||void 0===s?void 0:s.display)||0)+((null===s||void 0===s?void 0:s.worker)||0),local:t.id>r,unpublished:!(0,H.fN)(e)&&(null===a||t.id>a),unsaved:!!o.get(t.id),downstream:new Set}}));return function(e,n){const t=new Map(e.map((e=>[e.node,e]))),s=(0,We._n)(n);for(const r of e)r.downstream=new Set([...(0,We.mD)(r.node,s)].map((e=>t.get(e))).filter((e=>e.name)))}(i,t),i}const en=(0,R.$j)((e=>{let{notebook:n}=e;return{notebook:n}}),(e=>({dispatch:e})))((e=>{let{dispatch:n,onDismiss:t,notebook:s,selectedNode:r}=e;const{documentKey:o}=s,c=(0,Ge.v9)((e=>{let{currentUser:n}=e;return n})),h=(0,H.ly)(s),f=(0,H.ws)(s)&&!(0,H.cg)(s),b=(0,m.useRef)(Je(s)),x=(0,m.useRef)(new Map(b.current.map((e=>[e.name,e])))),v=r&&(0,Xe.nR)(r)||"",g=s.model.resolutions.filter(H.HC),j=b.current.reduce(((e,n)=>{let{name:t,node:s}=n;return g.some((e=>s.value.includes(e.specifier)))&&t?e.add(t):e}),new Set),{0:y,1:w}=(0,m.useState)(function(e,n,t){if(t)return[t];const s=e.filter((e=>{let{name:t}=e;return t&&!n.has(t)}));return s.length?[s.reduce(((e,n)=>n.height>e.height?n:e)).name]:[]}(b.current,j,v)),k=function(e,n){const t=e.map((e=>n.current.get(e))),s=new Set(t);return[...t.reduce(((e,n)=>n?(n.downstream.forEach((n=>{s.has(n)||e.add(n)})),e):e),new Set)].map((e=>e.name))}(y,x),{0:N,1:S}=(0,m.useState)(!y.length),{0:Z,1:F}=(0,m.useState)(!1),{0:_,1:I}=(0,m.useState)(!1),{0:M,1:R}=(0,m.useState)(Ve[0]),{0:L,1:q}=(0,m.useState)(Qe[3]),{0:U}=(0,m.useState)((()=>(0,Ye.Z)(4))),A=b.current.filter((e=>{let{name:n}=e;return!n})).length,E=b.current.filter((e=>{let{name:n}=e;return n})),{0:T,1:z}=(0,m.useState)(660),{0:K,1:O}=(0,m.useState)(),V=He(s,"js?v=3"),P=He(s,"tgz?v=3"),B=b.current.reduce(((e,n)=>{let{name:t,unsaved:s}=n;return t&&s?e.add(t):e}),new Set),$=b.current.reduce(((e,n)=>{let{name:t,local:s}=n;return t&&s?e.add(t):e}),new Set),W=b.current.reduce(((e,n)=>{let{name:t,unpublished:s}=n;return t&&s?e.add(t):e}),new Set),X=h?"Republish your notebook to embed the latest changes":!(!$.size&&!B.size)&&"Fork this notebook to embed with your changes",Y=(0,H.qb)(s.owner),G=N||!y.length?500:59+y.reduce(((e,n)=>{var t;return e+17+((null===(t=x.current.get(n))||void 0===t?void 0:t.height)||0)}),0),J=(0,Le.Bi)(s,(0,H.z4)(s)&&s.autosave?"latest":s.isPausedLoad?"paused":(0,H.vS)(s)&&!(0,H.z4)(s)?void 0:s.saveVersion),{instructions:ee,preview:ne}=M.content({entire:N,height:G,width:T,names:y,runSelection:k,slug:s.slug,title:(0,Q.Ui)(s.model),owner:s.owner.name||s.owner.login,moduleUrl:V,packageUrl:P,notebookPath:(0,Le.UW)(s),notebookUrl:J,documentKey:null===o||void 0===o?void 0:o.key,uiOrigin:"https://observablehq.com",hasFiles:!!s.files.size,randomId:U,preview:!1,onCopy:function(e){n({type:"embedModalCopy",source:e})},disableBanner:Z});function te(){const e=new Date;e.setDate(e.getDate()+(L||0)),n({type:"createDocumentKey",documentId:s.id,expirationDate:L?e:null,firstVersion:s.saveVersion,lastVersion:_&&s.saveVersion||null}),(0,D.MR)((0,D.ym)({type:"notebook:manage:embedModalCreateDocumentKey",data:{source:"iframe"===M.id?"Iframe":"javascript"===M.id?"JavaScript":"React"},eventVersion:1,notebook:s,currentUser:c}))}(0,m.useEffect)((()=>{function e(){const e=window.innerWidth>1400?660:window.innerWidth>1e3?420:0;z(e),O(window.innerWidth>640?e+520:void 0)}return window.addEventListener("resize",e),e(),()=>{window.removeEventListener("resize",e)}}),[]);const se=e=>(0,i.jsx)("div",{style:{width:null!==e&&void 0!==e?e:"auto"},children:(0,i.jsxs)("div",{className:"center pa2 ba b--light-gray lh-copy ".concat(e?"mt5":"mv3"),style:{maxWidth:"24rem"},children:[(0,i.jsx)("strong",{children:"This notebook is still private and requires a key."}),o?(0,i.jsxs)("div",{className:"mt3 f7",children:["Use the updated instructions"," ",e?"on the left":"below"," to embed this private document."]}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:"mt3 f7",children:["Create a notebook key to securely embed this private notebook"," ",_?"only for ":"starting at ",(0,i.jsxs)("strong",{children:["version ",s.saveVersion]}),"."," ",(0,i.jsx)(d(),{href:"/@observablehq/api-keys",onClick:e=>e.stopPropagation(),className:"pa0 fw5 blue bn bg-transparent pointer",children:"Learn more\u2026"})]}),(0,i.jsxs)("div",{className:"mv2 flex items-center justify-center",children:[(0,i.jsx)("label",{htmlFor:"last-version",className:"f7 fw5 dark-gray hover-blue flex-auto pointer",children:"Only this version:"}),(0,i.jsx)(Be.X,{label:"Pin",id:"last-version",checked:_,onChange:e=>I(e.target.checked)})]}),(0,i.jsxs)("div",{className:"mv2 flex items-center justify-center",children:[(0,i.jsx)("label",{htmlFor:"expiration-date",className:"f7 fw5 dark-gray hover-blue flex-auto pointer",children:"Expiration:"}),(0,i.jsx)($e.P,{"aria-label":"Expiration",id:"expiration-date",value:L,onChange:e=>{q("Never"===e.target.value?void 0:+e.target.value)},children:Qe.map((e=>(0,i.jsx)("option",{value:e||"Never",children:e?"".concat(e," days"):"Never"},"".concat(e," days"))))})]}),(0,i.jsx)("div",{className:"flex justify-end items-center mt3",children:(0,i.jsx)(u.KM,{className:"f7",text:"Create notebook key",onClick:te})})]})]})});return(0,i.jsxs)(l.Vq,{onDismiss:t,"aria-labelledby":"modal-title",className:"flex relative f6 near-black justify-between",style:{width:K,padding:0,maxWidth:K},children:[(0,i.jsxs)("div",{className:"top-0 flex-auto self-start",children:[(0,i.jsx)(a.xB,{title:"Embed",icon:ye.Z,onDismiss:t}),(0,i.jsxs)("div",{className:"mh3 mb2 dark-gray",children:["Select cells to embed in any web page."," ",(0,i.jsx)("a",{className:"inline-flex fw6 no-underline blue hover-lightest-blue items-center",href:"/@observablehq/troubleshooting-embedding",target:"_blank",rel:"noopener noreferrer",children:"Learn more"}),"."]}),X&&(0,i.jsx)("div",{className:"flex justify-center mh3",children:(0,i.jsxs)("div",{className:"flex pa1 mt3 f7 fw5 gold bg-washed-yellow br2 items-center",children:[(0,i.jsx)(C.Z,{className:"w1 h1 ma1",style:{strokeWidth:1,flexShrink:void 0}}),(0,i.jsx)("div",{className:"mr2 lh-copy",children:X})]})}),(0,i.jsx)("div",{className:"ma3",children:(0,i.jsxs)("div",{className:"pa2 mb2 bg-near-white br2 overflow-auto",style:{maxHeight:355},children:[(0,i.jsxs)("label",{htmlFor:"entire-type",className:"flex f6 fw5 dark-gray hover-blue flex-auto pointer",children:[(0,i.jsx)(Be.X,{id:"entire-type",checked:N,onChange:e=>S(e.target.checked),spacing:""}),"Entire notebook"]}),(0,i.jsx)("hr",{className:"bt b--black-10 br-0 bl-0 bb-0"}),E.map(((e,n)=>{let{name:t}=e;const s="cell-".concat(t.replace(/ /g,"")),r=N||$.has(t)||W.has(t)&&!o;return(0,i.jsxs)("label",{htmlFor:s,className:p()("flex f6 fw5 flex-auto",n?"mt2":"",r?"gray":"dark-gray hover-blue pointer"),children:[(0,i.jsx)(Be.X,{id:s,checked:N||y.includes(t),className:r?"disabled":"",disabled:r,onChange:e=>function(e,n){const t=new Set(y);n?t.add(e):t.delete(e),w(b.current.filter((e=>t.has(e.name))).map((e=>e.name)))}(t,e.target.checked),spacing:""}),(0,i.jsx)("span",{className:"truncate",children:t})]},t)})),A>0&&(0,i.jsxs)("label",{htmlFor:"unnamed-checkbox",className:"flex mt2 f6 mid-gray flex-auto tooltipped tooltipped-n","aria-label":"Unnamed cells can only be embedded as part of the entire notebook",children:[(0,i.jsx)(Be.X,{id:"unnamed-checkbox",checked:N,disabled:!0,className:N?"o-1":"o-0",spacing:""}),(0,i.jsxs)("span",{className:"i",children:[A," unnamed cell",A>1?"s":""]})]})]})}),(0,i.jsx)($e.P,{"aria-label":"Embed type",id:"type",value:M.name,onChange:e=>R(Ve.find((n=>n.name===e.target.value))),className:"mh3",children:Ve.map((e=>{let{name:n}=e;return(0,i.jsx)("option",{children:n},n)}))}),("javascript"===M.id||"react"===M.id)&&(0,H.qb)(s.owner)&&(0,i.jsxs)("div",{className:"mh3 pv3",children:["Note that Database connections and secrets only work with"," ",(0,i.jsx)("em",{children:"Iframe"})," embeds."]}),(0,i.jsxs)("div",{className:"flex items-center justify-between mh3 pv2",children:[(0,i.jsx)(Be.X,{label:"Remove attribution banner",id:"attribution-checkbox",checked:Z,onChange:e=>F(e.target.checked),disabled:!Y}),!Y&&(0,i.jsx)(Pe.C,{type:"purple",className:"mr1",label:"Enterprise",isFilled:!0})]}),f&&!o&&T<=0&&(0,i.jsx)("div",{className:"w-100",children:se(null)}),(0,i.jsx)("div",{className:"ma3",children:ee})]}),T>0&&(0,i.jsxs)("div",{className:"pv3 ph4 dark-gray bg-near-white bl b--light-gray br3 br--right",children:[(0,i.jsx)("div",{className:"mb3 pt2 f5 b--light-gray relative",children:"Preview"}),f&&!o?se(T):N||y.length?ne:(0,i.jsx)("div",{style:{width:T},children:(0,i.jsx)("div",{className:"mw6 center mt5 tc",children:"Select cells to see a preview of the embedded notebook."})})]})]})}));var nn=t(60357),tn=t.n(nn),sn=t(24576),rn=t(71043),an=t(93797),on=t(12447),ln=t(89642),cn=t(66421);const{className:dn,styles:mn}={styles:(0,i.jsx)(tn(),{id:"509a44156c2e223d",children:"@media ".concat(on.pp,"{[data-reach-dialog-content].jsx-509a44156c2e223d{width:80vw;max-width:47em}}@media screen and (min-width:47em){[data-reach-dialog-content].jsx-509a44156c2e223d{width:47em}}")}),className:"jsx-509a44156c2e223d"},un=(0,R.$j)((e=>{let{notebook:n}=e;return{notebook:n}}),(e=>({dispatch:e})))((e=>{let{notebook:n,dispatch:t,onDismiss:s}=e;const{model:{license:r,copyright:o},owner:c}=n,{0:d,1:h}=(0,m.useState)(r),{0:b,1:x}=(0,m.useState)(o),v=d&&"other"!==d;(0,m.useEffect)((()=>{v&&!o&&x((0,ln.nm)(c))}),[c,o,v]);const{data:g,error:j}=(0,f.ZP)("".concat("https://static.observablehq.com","/licenses/").concat(d,".txt"),((e,n)=>fetch(e,n).then((e=>e.text()))));if(j)throw j;const y=(0,cn.GL)(n);return(0,i.jsxs)(l.Vq,{onDismiss:s,"aria-labelledby":"modal-title",className:dn,children:[(0,i.jsxs)(se.l,{className:"f6 lh-copy",onSubmit:e=>{const n=d||null;s(),t({type:"relicense",license:n,copyright:v&&b?b:""}),e.preventDefault()},children:[(0,i.jsx)(a.xB,{title:v?(0,ln.ax)(d,"long"):"Notebook license",icon:an.Z,onDismiss:s}),(0,i.jsxs)(a.fe,{children:[y?(0,i.jsxs)("div",{className:"mv3",children:[(0,i.jsxs)($e.P,{id:"license",value:d||"",onChange:e=>h(e.target.value||null),className:p()("w-100",d?"":"gray"),children:[(0,i.jsx)("option",{value:"",children:"None (please choose a license)"}),ln.B5.map((e=>[e,(0,ln.ax)(e)])).sort(((e,n)=>e[1]>n[1]?1:-1)).map((e=>{let[n,t]=e;return(0,i.jsx)("option",{value:n,children:t},n)}))]}),"other"===d?(0,i.jsx)("div",{className:"mt3 f7 fw5 mid-gray",children:"Please create a cell in your notebook with your license text."}):d?(0,i.jsx)(sn.g,{name:"copyright",placeholder:"Copyright [YEAR] [OWNER]",className:"w-100 mt3",value:b||"",maxLength:1024,rows:4,autoResize:!0,onChange:e=>x(e.target.value)}):(0,i.jsx)("div",{className:"mt3 f7 fw5 mid-gray",children:"Licenses let others know how they can use your work."})]}):o?(0,i.jsx)("h4",{className:"mv3 f6 fw5 break-word pre-wrap",children:o}):null,v&&g&&(0,i.jsx)("div",{className:"pa2 mt3 code f7 pre overflow-auto ba b--light-silver br2",style:{maxHeight:400,minHeight:250},children:g})]}),(0,i.jsx)(a.mz,{children:(0,i.jsxs)("div",{className:"flex justify-between",children:[(0,i.jsxs)("a",{className:"flex db f6 fw5 blue hover-lightest-blue items-center lh-solid link",href:v?"https://choosealicense.com/licenses/".concat(d,"/"):"https://observablehq.com/@observablehq/licenses",target:"_blank",rel:"noopener noreferrer",children:[(0,i.jsx)(rn.Z,{className:"mr2",width:16,height:16}),"Learn more about"," ",v?"the ".concat((0,ln.ax)(d)," license"):"licenses"]}),y?(0,i.jsxs)(u.CQ,{children:[(0,i.jsx)(u.kq,{text:"Cancel",onClick:s}),(0,i.jsx)(u.KM,{type:"submit",text:"Confirm",disabled:r===d&&o===b})]}):(0,i.jsx)(u.aX,{onClick:s,text:"Close"})]})})]}),mn]})}));var hn=t(12204);var pn=t(26674),fn=t(37809),bn=t(76305),xn=t(58127),vn=t(2741);const gn=(0,R.$j)(null,(e=>({dispatch:e})))((e=>{let{onDismiss:n,fileToReplace:t,dispatch:o}=e;const{0:c,1:d}=(0,m.useState)(),{0:h,1:f}=(0,m.useState)(),{isDraggingOver:b,dragAndDropEvents:x}=(0,xn.Y)((e=>{let{dataTransfer:{files:n}}=e;v(Array.from(n))}));function v(e){if(e.length){const n=e[0];n.size>Le.D_?(f(!0),d(null)):(d(n),f(!1))}}return(0,i.jsxs)(l.Vq,{onDismiss:n,"aria-labelledby":"modal-title","data-dialog-wide":!0,children:[(0,i.jsx)(a.xB,{title:"Replace file",icon:$.Z,onDismiss:n}),(0,i.jsx)(a.fe,{children:(0,i.jsxs)("div",{children:[h?(0,i.jsx)(fn.b,{type:"error",spacing:"pv2 ph3",className:"flex pv1 mb2 f7 fw6 flex-no-shrink items-center lh-f7",children:(0,i.jsxs)("div",{className:"ml1 fw5 dark-gray",children:["Sorry, that file exceeds the"," ",(0,Q.BU)(Le.D_)," maximum size."]})}):null,(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{className:"pb2 mb2",children:"All references to\u2026"}),(0,i.jsx)("div",{className:"pa3 ba b--silver br2 bg-white",children:(0,i.jsx)(pn.J,{file:t,used:!0})}),(0,i.jsxs)("div",{className:"flex mt3 mb2 justify-between items-baseline",children:[(0,i.jsx)("div",{className:"pv2",children:"will be replaced with\u2026"}),c?(0,i.jsx)(u.sn,{text:"Select another",onClick:()=>{o({type:"notebookFilePickerOpened",source:"replaceFileModal",trigger:"click"}),(0,vn.Z)({multiple:!1}).then(v)}}):null]}),(0,i.jsx)("div",(0,r.Z)((0,s.Z)({className:p()("pa3 ba br2",b?"b--gray b--dashed bg-black-05":"b--silver bg-white"),"data-cy":"drop-target"},x),{children:c?(0,i.jsx)(pn.J,{file:{name:c.name,createTime:new Date,mimeType:c.type,status:"local",blob:c,size:c.size}}):(0,i.jsxs)("div",{className:"flex items-center",children:[(0,i.jsx)(u.KM,{text:"Select a file",icon:bn.Z,onClick:()=>{o({type:"notebookFilePickerOpened",source:"replaceFileModal",trigger:"click"}),(0,vn.Z)({multiple:!1}).then(v)}}),(0,i.jsx)("span",{className:"mid-gray ml2",children:"or drag and drop"})]})}))]})]})}),(0,i.jsx)(a.mz,{children:(0,i.jsxs)(u.CQ,{children:[(0,i.jsx)(u.kq,{text:"Cancel",onClick:n}),(0,i.jsx)(u.KM,{onClick:function(){o({type:"replaceFile",fileToAttach:c,fileToReplace:t}),n()},disabled:!c,text:"Confirm"})]})})]})}));var jn=t(56367),yn=t(3683),wn=t(36815);const kn=(0,R.$j)(null,(e=>({dispatch:e})))((e=>{let{dispatch:n,comment:t,onDismiss:s}=e;const r=(0,m.createRef)(),{0:o,1:c}=(0,m.useState)(""),{0:d,1:h}=(0,m.useState)(!1);function p(){n({type:"reportAbuse",anonymous:d,comment:t,reason:o}),s()}return(0,i.jsxs)(l.Vq,{onDismiss:s,"aria-labelledby":"modal-title",initialFocusRef:r,children:[(0,i.jsx)(a.xB,{title:"Report spam or abuse",icon:C.Z,onDismiss:s}),(0,i.jsxs)(a.fe,{children:[(0,i.jsx)(Nn,{comment:t}),(0,i.jsxs)("div",{className:"mv3",children:["Please describe why this comment violates Observable\u2019s"," ",(0,i.jsx)("a",{className:"no-underline blue",target:"_blank",rel:"noopener noreferrer",href:"/@observablehq/code-of-conduct",children:"Code of Conduct"}),"."]}),(0,i.jsx)(sn.g,{ref:r,maxLength:255,autoResize:!0,placeholder:"Reason (optional)",value:o,onChange:e=>{let{target:{value:n}}=e;return c(n)},onKeyPress:e=>{"Enter"===e.key&&(e.metaKey||e.ctrlKey)&&(e.preventDefault(),p())},className:"w-100"}),(0,i.jsx)(Be.X,{label:"Allow Observable support to follow up with me",checked:!d,onChange:e=>{let{target:{checked:n}}=e;return h(!n)}}),(0,i.jsxs)("p",{className:"mt2 mid-gray",children:[d?(0,i.jsx)(i.Fragment,{children:"Your report will be sent anonymously and we will have no way to follow up with you."}):(0,i.jsx)(i.Fragment,{children:"Your contact information will be included so that we may follow up with you."})," ","If you prefer, you can report via email to"," ",(0,i.jsx)("a",{className:"no-underline blue",href:wn.Eo.conduct,children:wn.GT.conduct}),"."]})]}),(0,i.jsx)(a.mz,{children:(0,i.jsxs)(u.CQ,{children:[(0,i.jsx)(u.kq,{onClick:s,text:"Cancel"}),(0,i.jsx)(u.KM,{text:"Send report",onClick:p})]})})]})})),Nn=e=>{let{comment:n}=e;const{content:t,create_time:s,update_time:r,user:a}=n;return(0,i.jsxs)("div",{className:"mb3 pv2 ph3 dark-gray bg-washed-yellow br2 b--silver ba",children:[(0,i.jsxs)("div",{className:"pb1 flex items-center",children:[(0,i.jsx)(G.Z,{href:(0,ee.GN)(a),children:(0,i.jsxs)("a",{className:"inline-flex truncate no-underline dark-gray hover-blue items-center mr2",children:[(0,i.jsx)(ae.q,{user:a,size:24,className:"mr2 br-100"}),(0,i.jsx)("span",{className:"truncate fw5",children:(0,Q.KY)(a)})]})}),(0,H.tO)(n)?null:(0,i.jsx)(yn.q,{className:"mid-gray nowrap",time:r||s})]}),(0,i.jsx)("div",{className:"overflow-x-hidden break-word",children:(0,i.jsx)(jn.R,{content:t})})]})};var Cn=t(15706);const Sn=(0,R.$j)((e=>{let{notebook:n}=e;return{notebook:n}}),(e=>({dispatch:e})))((e=>{let{notebook:n,dispatch:t,onDismiss:s}=e;const{0:r,1:o}=(0,m.useState)(""),c=n.forkOf.owner;return(0,i.jsx)(l.Vq,{onDismiss:s,"aria-labelledby":"modal-title",children:(0,i.jsxs)(se.l,{onSubmit:e=>{e.preventDefault(),t({type:"sendSuggestion",description:r,trigger:"click",source:"notebookContextMenu"})},children:[(0,i.jsx)(a.xB,{title:"Send suggestion",icon:Cn.v,onDismiss:s}),(0,i.jsxs)(a.fe,{children:["Your changes will be sent to"," ",c.id!==n.owner.id||"team"!==c.type?(0,i.jsx)("b",{children:(0,ee.RX)(c)}):(0,i.jsxs)(i.Fragment,{children:["the authors of ",(0,i.jsxs)("b",{children:["\u201c",(0,Le.$h)(n.forkOf),"\u201d"]})]})," ","for review.",(0,i.jsx)(v.Z,{type:"text",maxLength:255,placeholder:"Brief description of changes\u2026",value:r,onChange:e=>{let{target:{value:n}}=e;return o(n)},className:"w-100 mt3"}),(0,H.ws)(n)&&n.owner.id!==c.id&&(0,i.jsx)("div",{className:"mt2 f7 mid-gray",children:"This notebook will be visible to anyone with the link."})]}),(0,i.jsx)(a.mz,{children:(0,i.jsxs)(u.CQ,{children:[(0,i.jsx)(u.kq,{text:"Cancel",onClick:s}),(0,i.jsx)(u.KM,{type:"submit",loading:n.isSuggesting,text:"Confirm"})]})})]})})}));var Zn=t(61224);const Dn=(0,r.Z)((0,s.Z)({},o.$),{addCloudFile:X,addDatabase:ne,authors:fe,closeSuggestion:be,cloudFile:e=>{let{provider:n,onDismiss:t}=e;return"microsoftData"===n?(0,i.jsx)(O,{onDismiss:t}):"googleData"===n?(0,i.jsx)(B,{onDismiss:t}):null},deleteComment:xe,deleteFile:ve,embed:en,license:un,merge:Zn.r,oauth:e=>{let{onDismiss:n,dismissable:t=!0,provider:s,continuePath:r=""}=e;const a=r||location.pathname,{0:o,1:c}=(0,m.useState)(""),{0:d,1:u}=(0,m.useState)(!1),h=(0,m.useRef)(null),p=(0,m.useCallback)((()=>{u(!0),h.current&&(h.current.token.value=(0,S.FN)(),h.current.submit())}),[]),{name:f,icon:b,scopes:x}=M.c[s];return(0,i.jsx)(l.Vq,{onDismiss:t?n:void 0,"aria-label":"Authorize",className:"narrow",children:(0,i.jsxs)("div",{className:"relative",children:[(0,i.jsx)("div",{className:"mb3 pt2",children:"This notebook requires access to a file stored on Microsoft Drive. Please grant access to Observable to continue."}),(0,i.jsxs)("form",{action:"".concat("https://api.observablehq.com","/user/token/authorize"),method:"post",ref:h,children:[(0,i.jsxs)("label",{htmlFor:"provider_id",children:[(0,i.jsx)("div",{className:"h1 f6 near-black",children:"Your username"}),(0,i.jsx)(v.Z,{required:!0,name:"provider_id",spellCheck:"false",autoComplete:"email",autoCorrect:"off",autoCapitalize:"none",minLength:1,maxLength:255,className:"w-100 mt2",onChange:e=>c(e.target.value),value:o})]}),(0,i.jsx)("input",{type:"hidden",name:"token"}),(0,i.jsx)("input",{type:"hidden",name:"path",value:a}),(0,i.jsx)("input",{type:"hidden",name:"scopes",value:x.join(" ")}),(0,i.jsx)("input",{type:"hidden",name:"provider",value:s}),(0,i.jsxs)("button",{onClick:p,type:"button",className:(0,hn.XK)(),children:[d?(0,i.jsx)(w.Z,{className:"ml1 mr2 dark-gray"}):(0,i.jsx)(b,{className:"w1 h1 ml1 mr2"}),"Continue with ",f]})]})]})})},replaceFile:gn,reportAbuse:kn,suggest:Sn}),Fn=(0,a.zm)(Dn)},61224:function(e,n,t){t.d(n,{r:function(){return l}});var s=t(85893),r=t(71922),a=t(93452),o=t(74895),i=t(36448);const l=(0,t(69257).$j)((e=>{let{notebook:n,baseNotebook:t}=e;return{notebook:n,baseNotebook:t}}),(e=>({dispatch:e})))((e=>{let{notebook:n,baseNotebook:t,onDismiss:l,dispatch:c,trigger:d,source:m}=e;const[u]=(0,o.wd)(t,n),h=t.model.title,p=(0,i.RX)(t.owner);return(0,s.jsx)(a.On,{title:"Merge",icon:r.Z,description:(0,s.jsxs)(s.Fragment,{children:["Are you sure you want to merge these changes into ",(0,s.jsxs)("b",{children:["\u201c",h,"\u201d"]})," ","by ",p," (",u,")?"]}),onCancel:l,onConfirm:()=>{l(),c({type:"mergeCompare",trigger:d,source:m})}})}))},43489:function(e,n,t){t.d(n,{i:function(){return o},y:function(){return i}});var s=t(85893),r=t(94184),a=t.n(r);const o=e=>{let{className:n}=e;return(0,s.jsx)("span",{className:a()("dib ba br2 ph1 fw5 f7",n),style:{lineHeight:"var(--line-height-f7)",height:"var(--line-height-f7)"},children:"Guest"})};function i(e){let{showGuestLozenge:n=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return{owner:(0,s.jsx)(s.Fragment,{children:"Owner"}),member:(0,s.jsx)(s.Fragment,{children:"Editor"}),viewer:(0,s.jsx)(s.Fragment,{children:"Viewer"}),guest_viewer:(0,s.jsxs)("span",{children:["Viewer",n&&(0,s.jsxs)(s.Fragment,{children:["\xa0",(0,s.jsx)(o,{className:"dark-gray"})]})]}),guest_member:(0,s.jsxs)("span",{children:["Editor",n&&(0,s.jsxs)(s.Fragment,{children:["\xa0",(0,s.jsx)(o,{})]})]})}[e]}},64889:function(e,n,t){t.d(n,{C:function(){return i}});var s=t(67294),r=t(19671),a=t(51289),o=t(61107);function i(e,n){(0,s.useEffect)((()=>{const t=new Map;function s(s){const a=s.reason?s.reason.toString():s.message;for(const e of o.z)if(e.test(a))return;const i=Date.now(),l=t.get(a);i-Number(l)<6e4||(t.set(a,i),(0,r.MR)((0,r.a$)({type:"error",data:{error:a},eventVersion:1,currentUser:e})),n({type:"showErrorToast",message:"Oops, an unexpected error occurred",key:"errorHandler"}))}return a.Qg&&(addEventListener("unhandledrejection",s),addEventListener("error",s)),()=>{a.Qg&&(removeEventListener("unhandledrejection",s),removeEventListener("error",s))}}),[n,e])}},74895:function(e,n,t){t.d(n,{AG:function(){return h},EB:function(){return w},H7:function(){return p},Hd:function(){return _},PU:function(){return b},Sr:function(){return C},W7:function(){return F},ZP:function(){return R},_r:function(){return N},aU:function(){return g},dv:function(){return y},h7:function(){return f},oG:function(){return j},oz:function(){return k},tB:function(){return D},uh:function(){return Z},wd:function(){return S}});var s=t(41799),r=t(69396),a=t(95698),o=t(68745),i=t(63999),l=t(64063),c=t.n(l),d=t(72215),m=t(40076),u=t(72760);function h(e,n){return!!e.forkOf&&e.forkOf.id===n.id}function p(e){const{base_changes:n,target_changes:t,mapping:s}=e;if(0===n.length)return[];const r=new Set(t),a=new Map(s),o=[];for(const i of n)r.has(a.get(i))||o.push(i);return o}function f(e){return p(e).length>0}function b(e,n){return e.id===n.id&&e.saveVersion<=n.saveVersion}function x(e){let{type:n,base:t,target:s}=e;return"insert_node"!==n||s?"remove_node"!==n||t?n:"insert_node":"remove_node"}function v(e,n){const t=n.name;function s(e){const n=t.lastIndexOf(e);return n>0?n:void 0}const r=s("@"),a=s("."),o=t.substring(0,r||a||t.length),i=a&&(!r||a>r)?t.substring(a):"";let l=r?parseInt(t.substring(r+1,a||t.length)):0,c=l>0?"@".concat(l):"";const d=e.map((e=>e.name));for(;d.includes(o+c+i);)l+=1,c="@".concat(l);return o+c+i}function g(e,n){const t={target:[],shared:[],base:[]},s=new Map(e),r=new Map(n);for(const[a,o]of s)r.has(a)?(r.delete(a),t.shared.push(o)):t.target.push(o);for(const[,a]of r)t.base.push(a);return t}function j(e,n){const{files:t,nodes:a}=e,{files:o}=n,i=new Map,l=[];for(const c of t.slice().sort(((e,n)=>e.name.localeCompare(n.name)))){let e;const n=o.find((e=>e.name===c.name));(n&&(!(0,d.PT)(n)||n.id!==c.id)||l.find((e=>e.name===c.name)))&&(e=v(l.concat(o),c),i.set(c.name,e)),l.push((0,r.Z)((0,s.Z)({},c),{name:e||c.name}))}return{files:l,nodes:a.map((e=>function(e,n){const t=n.value;if(t){const{fileAttachments:a}=(0,u.Qc)(n),o=[];for(const[n,t]of a)if(e.has(n))for(const{start:e,end:s}of t)o.push({start:e,end:s,name:n});o.sort(((e,n)=>e.start-n.start));let i="",l=0;for(const{start:n,end:s,name:r}of o)i+=t.substring(l,n+1)+String(e.get(r)),l=s-1;i+=t.substring(l),n=(0,r.Z)((0,s.Z)({},n),{value:i})}if((0,m.sO)(n)){const t=n.data,{type:a,name:o}=t.source;"FileAttachment"===a&&e.has(o)&&(n=(0,r.Z)((0,s.Z)({},n),{data:(0,r.Z)((0,s.Z)({},t),{source:{type:a,name:e.get(o)}})}))}return n}(i,e))),fileMap:I(i)}}function y(e,n,t){let{mapping:i,target_changes:l,base_changes:c}=n;const d=I(i),m=new Set(l),u=new Set(c),h={insert_node:0,modify_node:0,remove_node:0,modify_data:0,noop:0,total:0},p=[];let f=t;for(const[,b]of e.entries()){h[x(b)]++,"noop"!==b.type&&h.total++;const e=(0,r.Z)((0,s.Z)({},b),{id:b.target?b.target.id:++f,baseId:b.base?b.base.id:null,targetId:b.target?b.target.id:null});if(p.push(e),null===e.baseId&&null!==e.targetId&&d.has(e.targetId)&&(e.baseId=d.get(e.targetId)),e.base&&e.target){e.modifiedBy=m.has(e.targetId)&&u.has(e.baseId)?"both":u.has(e.baseId)?"base":"target";const n=(0,a.Z)(e.base.value,e.target.value);null===n||void 0===n||n.forEach(((e,t)=>{const s=n[t-1],r=n[t+1];let a;if(e.added&&s&&s.removed&&(a=s),e.removed&&r&&r.added&&(a=r),a){let n=(0,o.Z)(e.added?a.value:e.value,e.added?e.value:a.value,{maxIterations:512});if(!n)return;n=n.filter((n=>e.added?!n.removed:!n.added)),n.forEach(((e,n,t)=>{const s=t[n-1],r=t[n+1];s&&s.added&&r&&r.added&&" "===e.value&&!e.added&&(e.added=!0),s&&s.removed&&r&&r.removed&&" "===e.value&&!e.removed&&(e.removed=!0)})),e.wordDiff=n}})),e.lineDiff=n}else e.base?e.lineDiff=e.base.value.split("\n").map((e=>({added:null,removed:!0,value:e,count:e.length,wordDiff:[{added:null,removed:!0,value:e,count:e.length}]}))):e.target&&(e.lineDiff=e.target.value.split("\n").map((e=>({added:!0,removed:null,value:e,count:e.length,wordDiff:[{added:!0,removed:null,value:e,count:e.length}]}))))}return{diffs:p,counts:h,syntheticVersion:f}}function w(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.display;const{diff:t}=e;return"base"===n?void 0===t.base:void 0===t.target}function k(e,n){var t;return e!==(null===(t=N(n))||void 0===t?void 0:t.value)}function N(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.display;if(w(e,n))return{value:"",data:null,name:null};const{diff:t}=e;switch(n){case"base":return t.base;case"target":return t.target;case"diff":return t.target?t.target:t.base}}function C(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.display;return w(e,n)?e.diff.target?e.diff.target:e.diff.base:N(e,n)}function S(e,n){return b(e,n)?["before","after"]:h(n,e)?["parent","fork"]:h(e,n)?["fork","parent"]:["base","target"]}function Z(e){let{model:n,compare:t}=e;const a=new Map(t.diffs.map((e=>[e.id,e]))),o=[],l=[],c=n.nodes.filter((e=>{const n=t.nodes.get(e.id);return!n||!w(n)})),d=i.Z.of((0,r.Z)((0,s.Z)({},n),{nodes:c}));return c.forEach((e=>{const n=a.get(e.id);n&&(null!==n.baseId&&o.push([n.baseId,e.id]),null!==n.targetId&&l.push([n.targetId,e.id]))})),{patchModel:d,baseToLocal:o,targetToLocal:l}}function D(e,n){for(const t of e)t.version=++n}function F(e,n,t,s){const r=I(s),a=new Map([...n.entries()].filter((e=>{let[,n]=e;return r.has(n)})).map((e=>{let[n,t]=e;return[n,r.get(t)]})));for(const o of e)"insert_node"===o.type&&a.has(o.node_id)&&(o.target_document_id=t,o.target_node_id=a.get(o.node_id))}function _(e,n,t,s,r){const a=R(t,e,r).filter((e=>"noop"!==e.type)),o=g(n,s).target;return a.length+o.length}function I(e){const n=new Map;for(const[t,s]of e)n.set(s,t);return n}function M(e,n){return Array.from({length:Math.min(e.version,n.version)+1},((e,n)=>[n,n]))}function R(e,n){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:M(n,e);const s=new Map(e.nodes.map((e=>[e.id,e]))),r=new Map(n.nodes.map((e=>[e.id,e]))),a=new Map(t),o=I(t),i=n.nodes.map((e=>{const n=o.get(e.id),t=void 0!==n&&s.get(n);return t?{type:t.value!==e.value?"modify_node":c()(t.data,e.data)?"noop":"modify_data",base:t,target:e}:{type:void 0===n?"insert_node":"remove_node",target:e}}));for(let l=0,c=e.nodes.length;l<c;++l){const n=e.nodes[l],t=a.get(n.id);if(void 0!==t&&r.has(t))continue;const s={type:void 0===t?"insert_node":"remove_node",base:n};let o=!1;for(let d=l+1;d<c;++d){const n=r.get(a.get(e.nodes[d].id));if(n){i.splice(i.findIndex((e=>e.target===n)),0,s),o=!0;break}}o||i.push(s)}return i}},69257:function(e,n,t){t.d(n,{$j:function(){return a},zt:function(){return s.zt}});var s=t(14416),r=t(54924);const a=(0,r.S3)();(0,r.gR)()}}]);